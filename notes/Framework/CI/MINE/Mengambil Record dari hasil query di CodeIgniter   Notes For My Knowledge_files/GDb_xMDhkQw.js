/*1319065166,169775814*/

if (window.CavalryLogger) { CavalryLogger.start_js(["ghcdO"]); }

function hasArrayNature(a){return (!!a&&(typeof a=='object'||typeof a=='function')&&('length' in a)&&!('setInterval' in a)&&(Object.prototype.toString.call(a)==="[object Array]"||('callee' in a)||('item' in a)));}function $A(b){if(!hasArrayNature(b))return [b];if(b.item){var a=b.length,c=new Array(a);while(a--)c[a]=b[a];return c;}return Array.prototype.slice.call(b);}
function eval_global(c){if('string'!=typeof(c)){throw new Error('JS sent to eval_global is not a string.  Only strings '+'are permitted.');}else if(''==c)return;var d=document.createElement('script');d.type='text/javascript';try{d.appendChild(document.createTextNode(c));}catch(a){d.text=c;}var b=(document.getElementsByTagName("head")[0]||document.documentElement);b.appendChild(d);b.removeChild(d);}
function copy_properties(b,c){b=b||{};c=c||{};for(var a in c)b[a]=c[a];if(c.hasOwnProperty&&c.hasOwnProperty('toString')&&(typeof c.toString!='undefined')&&(b.toString!==c.toString))b.toString=c.toString;return b;}function add_properties(a,b){return copy_properties(window[a]||(window[a]={}),b);}function is_empty(b){if(b instanceof Array){return b.length==0;}else if(b instanceof Object){for(var a in b)return false;return true;}else return !b;}
window.require||(function(){var y={},v={},m=0,x=this,h=1,k=2,i='special',c='exports',b='dependencies',f='module',l='waiting',d='factory',j=undefined,a='define',e='global',g='require';function z(zh){var zj=y[zh],zc,zg;if(zj[l]&&zj[i]&k)p();if(!zj[c]){var ze=zj[c]={},zf=zj[d];if(Object.prototype.toString.call(zf)==='[object Function]'){var zb=[],zd=zj[b],zi=zd.length;if(zj[i]&k)zi=Math.min(zi,zf.length);for(zg=0;zg<zi;zg++){zc=zd[zg];zb.push(zc===f?zj:(zc===c?ze:z(zc)));}var zk=zf.apply(x,zb);if(zk)zj[c]=zk;}else zj[c]=zf;}return zj[c];}function u(ze,zc,zd,zb){if(zc===j){zc=[];zd=ze;ze=r();}else if(zd===j){zd=zc;zc=ze;ze=r();}if(y[ze])return;var zf={id:ze};zf[d]=zd;zf[b]=zc;zf[i]=zb;y[ze]=zf;n(ze);}function w(zb,zc){u(zb,zc,j,h);}function p(){var zc={},zb;for(zb in v)if(y[zb]&&!zc[zb]&&y[zb][i]&k)q({},zb,zc);}function q(ze,zb,zf){zf[zb]=1;var zd=v[zb],zc;if(!zd)return;ze[zb]=1;for(zc in zd){if(!y[zc][i]&k)continue;if(ze[zc]){delete zd[zc];y[zc][l]--;if(!y[zc][l])s(zc);}else q(ze,zc,zf);}ze[zb]=0;}function r(){return '__mod__'+m++;}function n(zd){var ze=y[zd];var zf=0;for(var zc=0;zc<ze[b].length;zc++){var zb=ze[b][zc];if(!y[zb]||y[zb][l]){v[zb]||(v[zb]={});v[zb][zd]=1;zf++;}}ze[l]=zf;if(!zf)s(zd);}function s(zc){var zd=y[zc];if(zd[i]&h)z(zc);var ze=v[zc];if(ze){delete v[zc];for(var zb in ze)if(!--y[zb][l])s(zb);}}function o(zc,zb){y[zc]={id:zc};y[zc][c]=zb;}o(f,0);o(c,0);o(a,u);o(e,x);o(g,z);u.amd={};x[a]=u;x[g]=z;z.ensure=w;var t=[e,f,g,c];var za=false;x.__d=function(ze,zc,zd,zb){u(ze,t.concat(zc),zd,zb||k);if(y[ze][l]&&!za)za=setTimeout(function(){p();za=false;},9);};})();
__d("arbiter",[],function(c,d,e,b){if(!window.async_callback)window.async_callback=function(f,g){return f;};function a(){copy_properties(this,{_listeners:[],_events:{},_callbacks:{},_last_id:1,_listen:{},_index:{}});copy_properties(this,a);}copy_properties(a,{SUBSCRIBE_NEW:'new',SUBSCRIBE_ALL:'all',BEHAVIOR_EVENT:'event',BEHAVIOR_PERSISTENT:'persistent',BEHAVIOR_STATE:'state',LIVEMESSAGE:'livemessage',BOOTLOAD:'bootload',FUNCTION_EXTENSION:'function_ext',CONTEXT_CHANGE:'ui/context-change',LIST_EDITOR_LISTS_CHANGED:'listeditor/friend_lists_changed',CAROUSEL_ROTATE:'carousel/rotate',subscribe:function(p,g,n){if(!p||p.length==0)return null;p=$A(p);var f=a._getInstance(this);f._listeners.push({callback:g,types:p});var m=f._listeners.length-1;for(var i=0;i<p.length;i++)if(f._index[p[i]]){f._index[p[i]].push(m);}else f._index[p[i]]=[m];n=n||a.SUBSCRIBE_ALL;if(n==a.SUBSCRIBE_ALL){var h,o,l;for(var j=0;j<p.length;j++){o=p[j];if(o in f._events)for(var k=0;k<f._events[o].length;k++){h=f._events[o][k];l=g.apply(null,[o,h]);if(l===false){f._events[o].splice(k,1);k--;}}}}return {subscriberID:m};},unsubscribe:function(j){var f=a._getInstance(this);var h=f._listeners[j.subscriberID];if(!h)return;for(var i=0;i<h.types.length;i++){var k=h.types[i];if(f._index[k])for(var g=0;g<f._index[k].length;g++)if(f._index[k][g]==j.subscriberID){f._index[k].splice(g,1);if(f._index[k].length==0)delete f._index[k];break;}}delete f._listeners[j.subscriberID];},inform:function(o,h,g){var r=hasArrayNature(o);var q=$A(o);var f=a._getInstance(this);var n={};g=g||a.BEHAVIOR_EVENT;for(var j=0;j<q.length;j++){var o=q[j],i=null;if(g==a.BEHAVIOR_PERSISTENT){i=f._events.length;if(!(o in f._events))f._events[o]=[];f._events[o].push(h);f._events[o]._stateful=false;}else if(g==a.BEHAVIOR_STATE){i=0;f._events[o]=[h];f._events[o]._stateful=true;}else if(o in f._events)f._events[o]._stateful=false;window.ArbiterMonitor&&ArbiterMonitor.record('event',o,h,f);var m;if(f._index[o]){var p=$A(f._index[o]);for(var k=0;k<p.length;k++){var l=f._listeners[p[k]];if(l){m=l.callback.apply(null,[o,h]);if(m===false){if(i!==null)f._events[o].splice(i,1);break;}}}}f._updateCallbacks(o,h);window.ArbiterMonitor&&ArbiterMonitor.record('done',o,h,f);n[o]=m;}return r?n:n[q[0]];},query:function(g){var f=a._getInstance(this);if(!(g in f._events))return null;if(f._events[g].length)return f._events[g][0];return null;},_instance:null,_getInstance:function(f){if(f instanceof a)return f;if(!a._instance)a._instance=new a();return a._instance;},registerCallback:function(g,i){var m,h=0,f=a._getInstance(this),l=false;if(typeof g=='function'){m=f._last_id;f._last_id++;l=true;}else{if(!f._callbacks[g])return null;m=g;}if(hasArrayNature(i)){var n={};for(var k=0;k<i.length;k++)n[i[k]]=1;i=n;}for(var o in i){try{if(f.query(o))continue;}catch(j){}h+=i[o];if(f._listen[o]===undefined)f._listen[o]={};f._listen[o][m]=(f._listen[o][m]||0)+i[o];}if(h==0&&l){g();return null;}if(!l){f._callbacks[m].depnum+=h;}else f._callbacks[m]={callback:async_callback(g,'arbiter'),depnum:h};return m;},_updateCallbacks:function(i,h){if(h===null||!this._listen[i])return;for(var g in this._listen[i]){this._listen[i][g]--;if(this._listen[i][g]<=0)delete this._listen[i][g];this._callbacks[g].depnum--;if(this._callbacks[g].depnum<=0){var f=this._callbacks[g].callback;delete this._callbacks[g];f();}}}});c.Arbiter=d.exports=a;},3);
__d("bootloader",["arbiter"],function(d,e,f,c){var a=f('arbiter');var b={configurePage:function(g){var m={};var l=b.resolveResources(g);var h;for(h=0;h<l.length;h++){m[l[h].src]=l[h];b.requested(l[h].name);b._startCSSPoll(l[h].name);}var j=document.getElementsByTagName('link');for(h=0;h<j.length;++h){if(j[h].rel!='stylesheet')continue;for(var i in m)if(j[h].href.indexOf(i)!==-1){var k=m[i].name;b._cssLinkMap[k]={link:j[h]};if(m[i].permanent)b._permanent[k]=true;delete m[i];break;}}},loadComponents:function(i,g){if(!b._bootloadEnabled){b._waitForBootloadEnabled.push([i,g]);return;}i=$A(i);var l=[];for(var j=0;j<i.length;++j){if(!i[j])continue;var h=b._componentMap[i[j]];if(!!h)for(var k=0;k<h.length;++k)l.push(h[k]);}b.loadResources(l,g);},loadResources:function(m,g,l,p){var h;m=b.resolveResources($A(m));if(l){var j={};for(h=0;h<m.length;++h)j[m[h].name]=true;for(var i in b._requested)if(!(i in b._permanent)&&!(i in j)&&!(i in b._earlyResources))b._unloadResource(i);b._earlyResources={};}var q=[];var k=[];for(h=0;h<m.length;++h){var n=m[h];if(n.permanent)b._permanent[n.name]=true;var o=a.BOOTLOAD+'/'+n.name;if(a.query(o)!==null)continue;if(!n.nonblocking)k.push(o);if(!b._requested[n.name]){b.requested(n.name);q.push(n);window.CavalryLogger&&CavalryLogger.getInstance().measureResources(n,p);}}if(g)g=a.registerCallback(g,k);for(h=0;h<q.length;++h)b.requestResource(q[h].type,q[h].src,q[h].name);return g;},requestResource:function(p,m,k){var h=b.getHardpoint();if(p=='js'){var l=document.createElement('script');l.src=m;l.type='text/javascript';l.async=true;var g=function(){b.done([k]);};l.onload=l.onerror=g;l.onreadystatechange=function(){if(this.readyState in {loaded:1,complete:1})g();};h.appendChild(l);}else if(p=='css'){if(document.createStyleSheet){var n=b._styleTags,o=-1;for(var i=0;i<n.length;i++)if(n[i].imports.length<25){o=i;break;}if(o==-1){n.push(document.createStyleSheet());o=n.length-1;}n[o].addImport(m);b._cssLinkMap[k]={tagIdx:o,href:m};}else{var j=document.createElement('link');j.rel="stylesheet";j.type="text/css";j.media="all";j.href=m;b._cssLinkMap[k]={link:j};h.appendChild(j);}b._startCSSPoll(k);}},_activeCSSPolls:{},_expireTime:null,_runCSSPolls:function(){var j;var g=[];var k=new Date().getTime();if(k>=b._expireTime){if(window.send_error_signal)if(Math.random()<.01)send_error_signal('js_timeout_and_exception','00001:error:CSS timeout.');for(j in b._activeCSSPolls)g.push(j);}else for(j in b._activeCSSPolls){var l=b._activeCSSPolls[j];var m=window.getComputedStyle?window.getComputedStyle(l,null):l.currentStyle;if(m&&parseInt(m.height,10)>1)g.push(j);}if(!is_empty(g)){for(var i=0;i<g.length;i++){var h=b._activeCSSPolls[g[i]];h.parentNode.removeChild(h);delete b._activeCSSPolls[g[i]];}b._expireTime=k+b._CSS_POLL_EXPIRATION;b.done(g,true);}return is_empty(b._activeCSSPolls);},_startCSSPoll:function(i){var g='bootloader_'+i.replace(/[^a-z0-9]/ig,'_');var j=document.createElement('meta');j.id=g;b.getHardpoint().appendChild(j);b._expireTime=new Date()+b._CSS_POLL_EXPIRATION;var k=is_empty(b._activeCSSPolls);b._activeCSSPolls[i]=j;if(k)var h=setInterval(function _poll(){if(b._runCSSPolls())h&&clearInterval(h);},20,false);},done:function(k,h){b.requested(k);if(!h){var j={sender:this};a.inform(a.BOOTLOAD,j,a.BEHAVIOR_EVENT);}for(var g=0;g<k.length;++g){var i=k[g];a.inform(a.BOOTLOAD+'/'+i,true,a.BEHAVIOR_STATE);}},requested:function(h){h=$A(h);for(var g=0;g<h.length;++g)b._requested[h[g]]=true;},enableBootload:function(h){for(var i in h)if(!b._componentMap[i])b._componentMap[i]=h[i];if(!b._bootloadEnabled){b._bootloadEnabled=true;var j=b._waitForBootloadEnabled;for(var g=0;g<j.length;g++)b.loadComponents.apply(null,j[g]);b._waitForBootloadEnabled=[];}},_unloadResource:function(j){if(j in b._cssLinkMap){var h=b._cssLinkMap[j],i=h.link;if(i){i.parentNode.removeChild(i);}else{var k=b._styleTags[h.tagIdx];for(var g=0;g<k.imports.length;g++)if(k.imports[g].href==h.href){k.removeImport(g);break;}}delete b._cssLinkMap[j];delete b._requested[j];a.inform(a.BOOTLOAD+'/'+j,null,a.BEHAVIOR_STATE);}},getHardpoint:function(){if(!b._hardpoint){var g=document.getElementsByTagName('head');b._hardpoint=g.length&&g[0]||document.body;}return b._hardpoint;},setResourceMap:function(h){if(!h)return;for(var g in h){if(!h[g].name)h[g].name=g;b._resources[g]=h[g];}},resolveResources:function(j,g){if(!j)return [];var i=new Array(j.length);for(var h=0;h<j.length;++h)if(!j[h].type&&j[h] in b._resources){i[h]=b._resources[j[h]];if(g&&(g in i[h]))i[h]=i[h][g];}else i[h]=j[h];return i;},loadEarlyResources:function(i){var g;b.setResourceMap(i);var h=[];for(g in i)h.push(b._resources[g]);b.loadResources(h);for(g in i){var j=b._resources[g];if(!j.permanent)b._earlyResources[j.name]=j;}},isDisplayJS:function(g){if(typeof g=='string')g=b._resources[g];return g.displayjs;},_requested:{},_permanent:{},_componentMap:{},_cssLinkMap:{},_styleTags:[],_hardpoint:null,_resources:{},_earlyResources:{},_bootloadEnabled:false,_waitForBootloadEnabled:[],_CSS_POLL_EXPIRATION:5000};d.Bootloader=e.exports=b;},3);
(function(){if(window!=window.top)return;var o='_e_',q=(window.name||'').toString();q=(q.length==7&&o==q.substr(0,3))?q.substr(3):(window.name=o+window._EagleEyeSeed).substr(3);var m=(window.location.protocol=='https:'&&document.cookie.match(/\bcsm=1/))?'; secure':'';var k=o+q+'_',g=new Date(+new Date()+604800000).toGMTString(),e=window.location.hostname.replace(/^.*(facebook\..*)$/i,'$1'),f='; expires='+g+';path=/; domain='+e+m,d=0,r=false,l,p=window._EagleEyeSessionStorage&&window.sessionStorage,i=document.cookie.length,j=false,n=+new Date();function h(v){var s=2166136261;for(var t=0,u=v.length;t<u;++t)s=(s^v.charCodeAt(t))*16777619;s+=s<<13;s^=s>>7;s+=s<<3;s^=s>>17;s+=s<<5;return (s|0)+2147483648;}function c(s){return k+(d++)+'='+encodeURIComponent(s)+f;}function a(){var s=[],v=false,u=0,t=0;this.isEmpty=function(){return !s.length;};this.enqueue=function(x,w){if(w){s.unshift(x);}else s.push(x);};this.dequeue=function(){s.shift();};this.peek=function(){return s[0];};this.clear=function(y){i=Math.min(i,document.cookie.length);if(!j&&(new Date()-n>60000))j=true;var w=!y&&(document.cookie.search(o)>=0);var zi=!!(window.Env&&Env.cookie_header_limit);var zd=(window.Env&&Env.cookie_count_limit)||19;var ze=(window.Env&&Env.cookie_header_limit)||3950;var zb=zd-5;var zc=ze-1000;while(!this.isEmpty()){var x=c(this.peek());if(zi&&(x.length>ze||(j&&x.length+i>ze))){this.dequeue();continue;}if((w||zi)&&((document.cookie.length+x.length>ze)||(document.cookie.split(';').length>zd)))break;document.cookie=x;w=true;this.dequeue();}var zf=+new Date();if(y||!v&&w&&((t>0)&&(Math.min(10*Math.pow(2,t-1),60000)+u<zf))&&(r||window.Arbiter&&window.OnloadEvent&&Arbiter.query(OnloadEvent.ONLOAD))&&(!this.isEmpty()||(document.cookie.length>zc)||(document.cookie.split(';').length>zb))){var zh=new Image(),zg=this,z=window._EagleEyeDomain||(window.Env&&Env.tracking_domain)||'';v=true;zh.onload=function _EagleEye_logged(){v=false;t=0;zg.clear();};zh.onerror=zh.onabort=function _EagleEye_error(){v=false;u=+new Date();t++;};var za=(window.Env&&Env.fb_isb)?'&fb_isb='+Env.fb_isb:'';var zj=window.Env?'&__user='+Env.user:'';zh.src=z+'/ajax/nectar.php?asyncSignal='+(Math.floor(Math.random()*10000)+1)+za+zj+'&'+(!y?'':'s=')+zf;}};}l=new a();if(p){var b=function(){var u=0;var w=u;function t(){var y=sessionStorage.getItem('_e_ids');if(y){var x=(y+'').split(';');if(x.length==2){u=parseInt(x[0],10);w=parseInt(x[1],10);}}}function v(){var x=u+';'+w;sessionStorage.setItem('_e_ids',x);}function s(x){return '_e_'+((x!==undefined)?x:u++);}this.isEmpty=function(){return w===u;};this.enqueue=function(z,x){var y=x?s(--w):s();sessionStorage.setItem(y,z);v();};this.dequeue=function(){this.isEmpty();sessionStorage.removeItem(s(w));w++;v();};this.peek=function(){var x=sessionStorage.getItem(s(w));return x?(x+''):x;};this.clear=l.clear;t();};l=new b();}window.EagleEye={log:function(v,s,t){if(window.Env&&Env.no_cookies)return;var w=[q,+new Date(),v].concat(s);w.push(w.length);function u(){var y=JSON.stringify(w);try{l.enqueue(y,!!t);l.clear(!!t);}catch(x){if(p&&(x.code===1000)){l=new a();p=false;u();}}}if(window.JSON){u();}else if(window.Bootloader)Bootloader.loadComponents('json',u);},createLogger:function(u,s){s=(s===undefined)?1:s;var t=function(v,w){if(t.enabled)EagleEye.log(u,v,w);};t.enabled=false;t._key=((window.Env&&Env.user)||Math.random())+u;t.enabled=(h(t._key)%65535/65535)<=s;return t;},getSessionID:function(){return q;},loaded:function(){r=true;}};})();
void(1);window.__DEV__=window.__DEV__||0;if(!window.skipDomainLower&&navigator&&navigator.userAgent&&document.domain.toLowerCase().match(/(^|\.)facebook\..*/)&&!(parseInt((/Gecko\/([0-9]+)/.exec(navigator.userAgent)||[]).pop(),10)<=20060508))document.domain=window.location.hostname.replace(/^.*(facebook\..*)$/i,'$1');window.onloadhooks=window.onloadhooks||[];window.onloadRegister=window.onloadRegister||function(a){onloadhooks.push(a);};window.onafterloadhooks=window.onafterloadhooks||[];window.onafterloadRegister=window.onafterloadRegister||function(a){onafterloadhooks.push(a);};function run_if_loaded(a,b){return window.loaded&&b.call(a);}function run_with(b,a,c){Bootloader.loadComponents(a,bind(b,c));return false;}function wait_for_load(c,b,e){e=bind(c,e,b);if(window.loaded)return e();switch((b||event).type){case 'load':case 'focus':onafterloadRegister(e);return;case 'click':var d=c.style,a=document.body.style;d.cursor=a.cursor='progress';onafterloadRegister(function(){d.cursor=a.cursor='';if(c.tagName.toLowerCase()=='a'){if(false!==e()&&c.href)window.location.href=c.href;}else if(c.click)c.click();});break;}return false;}function bind(d,c){var a=Array.prototype.slice.call(arguments,2);function b(){var f=d||(this==window?false:this),e=a.concat(Array.prototype.slice.call(arguments));if(typeof(c)=="string"){if(f[c])return f[c].apply(f,e);}else return c.apply(f,e);}return b;}var curry=bind(null,bind,null);function env_get(a){return window.Env&&Env[a];}document.documentElement.className=document.documentElement.className.replace('no_js','');
var Mixins={Arbiter:{_getArbiterInstance:function(){return this._arbiter||(this._arbiter=new Arbiter());},inform:function(c,b,a){return this._getArbiterInstance().inform(c,b,a);},subscribe:function(c,a,b){return this._getArbiterInstance().subscribe(c,a,b);},unsubscribe:function(a){this._getArbiterInstance().unsubscribe(a);}}};
Class={extend:function(a,b){if(!Metaprototype._arbiterHandle)Metaprototype._arbiterHandle=Arbiter.subscribe(Arbiter.BOOTLOAD,Metaprototype._onbootload.bind(Metaprototype));Metaprototype._queue(a,b);},mixin:function(c,b){var a=Array.prototype.slice.call(arguments);a[0]=a[0].prototype;Function.mixin.apply(Function,a);}};function Metaprototype(){}copy_properties(Metaprototype,{makeFinal:function(a){},_pending:{},_queue:function(b,c){b.__class_extending=true;var a=Arbiter.registerCallback(bind(Metaprototype,Metaprototype._apply,b,c),[Arbiter.FUNCTION_EXTENSION+'/'+c,Arbiter.BOOTLOAD]);if(a!==null)this._pending[c]=true;},_onbootload:function(b,a){this._update();},_update:function(){for(var a in this._pending)if(!!window[a]){delete this._pending[a];if(!window[a].__class_extending){Arbiter.inform(Arbiter.FUNCTION_EXTENSION+'/'+a,true,Arbiter.BEHAVIOR_STATE);}else window[a].__class_name=a;}},_apply:function(a,c){delete a.__class_extending;var d=__metaprototype(window[c],0);var b=__metaprototype(a,d.prototype.__level+1);b.parent=d;if(!!a.__class_name)Arbiter.inform(Arbiter.FUNCTION_EXTENSION+'/'+a.__class_name,true,Arbiter.BEHAVIOR_STATE);}});function __metaprototype(c,a){if(c.__metaprototype)return c.__metaprototype;var b=new Function();b.construct=__metaprototype_construct;b.prototype.construct=__metaprototype_wrap(c,a,true);b.prototype.__level=a;b.base=c;c.prototype.parent=b;c.__metaprototype=b;return b;}function __metaprototype_construct(a){__metaprototype_init(a.parent);var d=[];var c=a;while(c.parent){var b=new c.parent();d.push(b);b.__instance=a;c=c.parent;}a.parent=d[1];d.reverse();d.pop();a.__parents=d;a.__instance=a;return a.parent.construct.apply(a.parent,arguments);}function __metaprototype_init(d){if(d.initialized)return;var a=d.base.prototype;if(d.parent){__metaprototype_init(d.parent);var e=d.parent.prototype;for(var b in e)if(b!='__level'&&b!='construct'&&a[b]===undefined)a[b]=d.prototype[b]=e[b];}d.initialized=true;var c=d.prototype.__level;for(var b in a)if(b!='parent')a[b]=d.prototype[b]=__metaprototype_wrap(a[b],c);}function __metaprototype_wrap(c,b,d){if(typeof c!='function'||c.__prototyped)return c;var a=function(){var g=this.__instance;if(g){var h=g.parent;g.parent=b?g.__parents[b-1]:null;var e=arguments;if(d){e=[];for(var f=1;f<arguments.length;f++)e.push(arguments[f]);}var i=c.apply(g,e);g.parent=h;return i;}else return c.apply(this,arguments);};a.__prototyped=true;return a;}Function.mixin=function(){for(var b=1,a=arguments.length;b<a;++b)copy_properties(arguments[0],Mixins[arguments[b]]||arguments[b]);};Function.prototype.bind=function(b){var a=[b,this].concat(Array.prototype.slice.call(arguments,1));return bind.apply(null,a);};Function.prototype.curry=Function.prototype.bind.bind(null,null);Function.prototype.shield=function(b){if(typeof this!='function')throw new TypeException();var a=this.bind.apply(this,$A(arguments));return function(){return a();};};Function.prototype.defer=function(b,a){if(typeof this!='function')throw new TypeError();b=b||0;return setTimeout(this,b,a);};function bagofholding(){}function bagof(a){return function(){return a;};}
function set_ue_cookie(a){if(!(window.Env&&Env.no_cookies))document.cookie="act="+encodeURIComponent(a)+"; path=/; domain="+window.location.hostname.replace(/^.*(\.facebook\..*)$/i,'$1');}window.UserNoOp=window.UserNoOp||(function(){var a=function(){};var b=function(){return this;};copy_properties(a.prototype,{add_event:b,add_data:b,set_ua_id:b,set_namespace:b});return a;})();window.UserAction=window.UserAction||(function(){var a=function a(e,d,b){var c=e+'/'+d;copy_properties(this,{ue:c,_ua_id:null,_ts:e,_ns:null,_start_ts:e,_prev_event:'s',_ue_ts:e,_ue_count:d,_context:b,_version:2});};a.enable=function(b){a.enable[b]=true;};a._stack=[];copy_properties(a.prototype,{set_ua_id:function(b){this._ua_id=b;return this;},set_namespace:function(b){this._ns=b;return this;},add_event:function(d){if(!a.enable.events)return this;var f=(+new Date()),b=f-this._ts;var e=f-this._ue_ts;var c=[this._version,this.ue,this._ns,this._ua_id,this._prev_event,d,b,e];window.EagleEye&&EagleEye.log('evt',c);this._ts=f;this._prev_event=d;return this;},add_data:function(b){if(!a.enable.data)return this;return this;}});return a;})();window.user_action=window.user_action||(function(){var d=0,c=0;var b=null,a=null;return function(i,e,event,h,f){var l=(+new Date()),k=l+'/'+d;f=f||{};if(!i&&event)i=event.getTarget();var g=50;if(l-c<g&&i==b&&h!="FORCE")return UserAction._stack[UserAction._stack.length-1];b=i;a=event;var j=new UserAction(l,d,e);UserAction._stack.push(j);while(UserAction._stack.length>10)UserAction._stack.shift();Arbiter.inform("UserAction/new",{ua:j,node:i,mode:h,event:event,extra_data:f});c=l;d++;return j;};})();window.report_data=function(a,b){user_action(null,a,null,'FORCE',b);};
(function(){ClickRef={};ClickRef.get_intern_ref=function(c){if(!!c){var b={profile_minifeed:1,info_tab:1,gb_content_and_toolbar:1,gb_muffin_area:1,ego:1,bookmarks_menu:1,jewelBoxNotif:1,jewelNotif:1,BeeperBox:1,navSearch:1};for(var a=c;a&&a!=document.body;a=a.parentNode){if(!a.id||typeof a.id!=='string')continue;if(a.id.substr(0,8)=='pagelet_')return a.id.substr(8);if(a.id.substr(0,8)=='box_app_')return a.id;if(b[a.id])return a.id;}}return '-';};ClickRef.get_href=function(b){var a=(b.getAttribute&&(b.getAttribute('ajaxify')||b.getAttribute('data-endpoint'))||b.action||b.href||b.name);return a;};ClickRef.mouse_click_info=function(b){if(!ge('content'))return [0,0,0,0];var a=$('content');var c=window.Vector2?Vector2.getEventPosition(b):{x:0,y:0};return [c.x,c.y,a.offsetLeft,a.clientWidth];};ClickRef.should_report=function(b,a){if(a=='FORCE')return true;if(a=='INDIRECT')return false;return (b&&ClickRef.get_href(b));};ClickRef.collect_data=function(l,h,event,d){var j=(!window.ArbiterMonitor)?'r':'a',g=[0,0,0,0],k,e,f;if(!!event){k=event.type;if(k=='click'&&ge('content'))g=ClickRef.mouse_click_info(event);var b=0;event.ctrlKey&&(b+=1);event.shiftKey&&(b+=2);event.altKey&&(b+=4);event.metaKey&&(b+=8);if(b)k+=b;}if(!!h)e=ClickRef.get_href(h);var a=[];if(window.ArbiterMonitor){f=ArbiterMonitor.getInternRef(h);a=ArbiterMonitor.getActFields();}var c={};if(window.collect_data_attribs){c=collect_data_attribs(h,['ft','gt']);copy_properties(c.ft,d.ft||{});copy_properties(c.gt,d.gt||{});if(c.gt.ua_id)l.set_ua_id(c.gt.ua_id);}var i=[l._ue_ts,l._ue_count,e||'-',l._context,k||'-',f||ClickRef.get_intern_ref(h),j,window.URI?URI.getRequestURI(true,true).getUnqualifiedURI().toString():location.pathname+location.search+location.hash,c].concat(g).concat(a);return i;};ClickRef.onNewUserAction=function(b,a){Bootloader.loadComponents('dom-collect',function(){if(ClickRef.should_report(a.node,a.mode)){var c=ClickRef.collect_data(a.ua,a.node,a.event,a.extra_data);ClickRef.report(a.ua,c);}});};ClickRef.report=function(b,a){var c=b.ue;set_ue_cookie(c);window.EagleEye&&EagleEye.log('act',a);};window.Arbiter&&Arbiter.subscribe("UserAction/new",ClickRef.onNewUserAction);})();
__d("dom-core",[],function(d,e,f,b){var a=function(g){return typeof g=='string'?document.getElementById(g):g;};var c=a;d.ge=b.ge=c;d.$=b.$=a;},3);
__d("css-core",["dom-core"],function(d,e,f,c){var a=f('dom-core').$;var b={hasClass:function(h,g){h=a(h);return (' '+h.className+' ').indexOf(' '+g+' ')>-1;},addClass:function(h,g){h=a(h);if(g&&!b.hasClass(h,g))h.className=h.className+' '+g;return h;},removeClass:function(h,g){h=a(h);if(b.hasClass(h,g))h.className=h.className.replace(new RegExp('(^|\\s)'+g+'(?:\\s|$)','g'),'$1');return h;},toggleClass:function(h,g){return b.conditionClass(h,g,!b.hasClass(h,g));},conditionClass:function(i,h,g){return (g?b.addClass:b.removeClass)(i,h);},show:function(g){b.removeClass(g,'hidden_elem');},hide:function(g){b.addClass(g,'hidden_elem');},conditionShow:function(h,g){b.conditionClass(h,'hidden_elem',!g);}};d.CSS=e.exports=b;},3);
__d("parent",["css-core"],function(b,c,d,a){b.Parent=c.exports={byTag:function(e,f){f=f.toUpperCase();while(e&&e.nodeName!=f)e=e.parentNode;return e;},byClass:function(f,e){while(f&&!d('css-core').hasClass(f,e))f=f.parentNode;return f;},byAttribute:function(f,e){while(f&&(!f.getAttribute||!f.getAttribute(e)))f=f.parentNode;return f;}};},3);
function trackReferrer(a,e){a=Parent.byAttribute(a,'data-referrer');if(a){var d=/^(?:(?:[^:\/?#]+):)?(?:\/\/(?:[^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/.exec(e)[1]||'';if(!d)return;var c=d+'|'+a.getAttribute('data-referrer');var b=new Date();b.setTime(new Date().getTime()+1000);document.cookie="x-src="+encodeURIComponent(c)+"; "+"expires="+b.toGMTString()+";path=/; domain="+window.location.hostname.replace(/^.*(\.facebook\..*)$/i,'$1');}return a;}
!function(){if(window.__primer)return;window.__primer=true;var a=null;var b=/async(?:-post)?|dialog(?:-pipe|-post)?|theater|toggle/;document.documentElement.onclick=function(e){e=e||window.event;a=e.target||e.srcElement;var f=Parent.byTag(a,'A');if(!f)return;var c=f.getAttribute('ajaxify');var g=f.href;var l=c||g;if(l){var k=user_action(f,'a',e);if(window.ArbiterMonitor)ArbiterMonitor.initUA(k,[f]);}if(c&&g&&!(/#$/).test(g)){var h=e.which&&e.which!=1;var i=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;if(h||i)return;}trackReferrer(f,l);var d=['dialog'];var j=f.rel&&f.rel.match(b);j=j&&j[0];switch(j){case 'dialog-pipe':d.push('ajaxpipe');case 'dialog':case 'dialog-post':Bootloader.loadComponents(d,function(){Dialog.bootstrap(l,null,j=='dialog',null,null,f);});break;case 'async':case 'async-post':Bootloader.loadComponents('async',function(){AsyncRequest.bootstrap(l,f);});break;case 'theater':Bootloader.loadComponents('PhotoSnowbox',function(){PhotoSnowbox.bootstrap(l,f);});break;case 'toggle':CSS.toggleClass(f.parentNode,'openToggler');Bootloader.loadComponents('Toggler',function(){Toggler.bootstrap(f);});break;default:return;}return false;};document.documentElement.onsubmit=function(c){c=c||window.event;var d=c.target||c.srcElement;if(d&&d.nodeName=='FORM'&&d.getAttribute('rel')=='async'){var f=user_action(d,'f',c);if(window.ArbiterMonitor)ArbiterMonitor.initUA(f,[d]);var e=a;Bootloader.loadComponents('dom-form',function(){Form.bootstrap(d,e);});return false;}};}();
function object(b){var a=new Function();a.prototype=b;return new a();}function is_scalar(a){return (/string|number|boolean/).test(typeof a);}function keys(c){var b=[];for(var a in c)b.push(a);return b;}function values(b){var c=[];for(var a in b)c.push(b[a]);return c;}function count(c){var a=0;for(var b in c)a++;return a;}function are_equal(a,b){return JSON.stringify(a)==JSON.stringify(b);}function merge(){var b={};for(var a=0;a<arguments.length;a++)copy_properties(b,arguments[a]);return b;}Object.from=function(c,e){var d={};var b=hasArrayNature(e);if(typeof e=='undefined')e=true;for(var a=c.length;a--;)d[c[a]]=b?e[a]:e;return d;};function coalesce(){for(var a=0;a<arguments.length;++a)if(arguments[a]!=null)return arguments[a];return null;}
__d("dom-html",[],function(c,d,e,b){function a(f){if(f&&f.__html)f=f.__html;if(!(this instanceof a)){if(f instanceof a)return f;return new a(f);}this._content=f;this._defer=false;this._extra_action='';this._nodes=null;this._inline_js=bagofholding;this._ie_clone_bug=false;return this;}a.isHTML=function(f){return f&&(f instanceof a||f.__html!==undefined);};a.replaceJSONWrapper=function(f){return f&&f.__html!==undefined?new a(f.__html):f;};copy_properties(a.prototype,{toString:function(){var f=this._content||'';if(this._extra_action)f+='<script type="text/javascript">'+this._extra_action+'</scr'+'ipt>';return f;},setAction:function(f){this._extra_action=f;return this;},getAction:function(){this._fillCache();var f=function(){this._inline_js();eval_global(this._extra_action);}.bind(this);if(this.getDeferred()){return f.defer.bind(f);}else return f;},setDeferred:function(f){this._defer=!!f;return this;},getDeferred:function(){return this._defer;},getContent:function(){return this._content;},getNodes:function(){this._fillCache();return this._nodes;},getRootNode:function(){return this.getNodes()[0];},ieCloneBug:function(){this._fillCache();return this._ie_clone_bug;},_fillCache:function(){if(null!==this._nodes)return;var i=this._content;if(!i){this._nodes=[];return;}i=i.replace(/(<(\w+)[^>]*?)\/>/g,function(q,r,s){return s.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i)?q:r+'></'+s+'>';});var m=i.trim().toLowerCase(),p=document.createElement('div'),g=false;var o=(!m.indexOf('<opt')&&[1,'<select multiple="multiple" class="__WRAPPER">','</select>'])||(!m.indexOf('<leg')&&[1,'<fieldset class="__WRAPPER">','</fieldset>'])||(m.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,'<table class="__WRAPPER">','</table>'])||(!m.indexOf('<tr')&&[2,'<table><tbody class="__WRAPPER">','</tbody></table>'])||((!m.indexOf('<td')||!m.indexOf('<th'))&&[3,'<table><tbody><tr class="__WRAPPER">','</tr></tbody></table>'])||(!m.indexOf('<col')&&[2,'<table><tbody></tbody><colgroup class="__WRAPPER">','</colgroup></table>'])||null;if(null===o){p.className='__WRAPPER';if(ua.ie()){o=[0,'<span style="display:none">&nbsp;</span>',''];g=true;}else o=[0,'',''];}p.innerHTML=o[1]+i+o[2];while(o[0]--)p=p.lastChild;if(g)p.removeChild(p.firstChild);p.className!='__WRAPPER';if(0!==p.getElementsByTagName('option').length||0!==p.getElementsByTagName('object').length)this._ie_clone_bug=true;if(ua.ie()){var n;if(!m.indexOf('<table')&&-1==m.indexOf('<tbody')){n=p.firstChild&&p.firstChild.childNodes;}else if(o[1]=='<table>'&&-1==m.indexOf('<tbody')){n=p.childNodes;}else n=[];for(var k=n.length-1;k>=0;--k)if(n[k].nodeName&&n[k].nodeName.toLowerCase()=='tbody'&&n[k].childNodes.length==0)n[k].parentNode.removeChild(n[k]);}var l=p.getElementsByTagName('script');var f=[];for(var j=0;j<l.length;j++)if(l[j].src){f.push(Bootloader.requestResource.bind(Bootloader,'js',l[j].src));}else f.push(eval_global.bind(null,l[j].innerHTML));for(var j=l.length-1;j>=0;j--)l[j].parentNode.removeChild(l[j]);var h=function(){for(var q=0;q<f.length;q++)f[q]();};this._nodes=$A(p.childNodes);this._inline_js=h;}});c.HTML=d.exports=a;},3);
__d("dom",["dom-core","css-core","dom-html"],function(h,i,j,f){var a=j('dom-core').$;var g=j('dom-core').ge;var c=j('css-core');var e=j('dom-html');var d={find:function(k,m){var l=d.scry(k,m);return l[0];},scry:function(t,zf){if(!t)return [];var zg=zf.split(' ');var n=[t];var s=t===document;for(var w=0;w<zg.length;w++){if(n.length==0)break;if(zg[w]=='')continue;var ze=zg[w];var zc=[];var zn=false;if(ze.charAt(0)=='^')if(w==0){zn=true;ze=ze.slice(1);}else return [];ze=ze.replace(/\./g,' .');ze=ze.replace(/\#/g,' #');ze=ze.replace(/\[/g,' [');var zj=ze.split(' ');var zk=zj[0]||'*';var x=zj[1]&&zj[1].charAt(0)=='#';if(x){var r=g(zj[1].slice(1),true);if(r&&('*'==zk||r.tagName.toLowerCase()==zk))for(var za=0;za<n.length;za++)if(zn&&d.contains(r,n[za])){zc=[r];break;}else if(document==n[za]||d.contains(n[za],r)){zc=[r];break;}}else{var zm=[];var m=n.length;for(var y=0;y<m;y++){if(zn){var u=[];var q=n[y].parentNode;var k=zk=='*';while(d.isElementNode(q)){if(k||q.tagName.toLowerCase()==zk)u.push(q);q=q.parentNode;}}else var u=n[y].getElementsByTagName(zk);var v=u.length;for(var zb=0;zb<v;zb++)zm.push(u[zb]);}for(var zh=1;zh<zj.length;zh++){var zi=zj[zh];var z=zi.charAt(0)=='.';var o=zi.substring(1);for(var y=0;y<zm.length;y++){var zl=zm[y];if(!zl)continue;if(z){if(!c.hasClass(zl,o))delete zm[y];continue;}else{var p=zi.slice(1,zi.length-1);if(p.indexOf('=')==-1){if(zl.getAttribute(p)===null){delete zm[y];continue;}}else{var zd=p.split('=');var l=zd[0];var zo=zd[1];zo=zo.slice(1,zo.length-1);if(zl.getAttribute(l)!=zo){delete zm[y];continue;}}}}}for(var y=0;y<zm.length;y++)if(zm[y]){zc.push(zm[y]);if(zn)break;}}n=zc;}return n;},getText:(function(){var k=document.createElement('div'),l=k.textContent!=null?'textContent':'innerText';return function(m){if(!m){return '';}else if(d.isTextNode(m)){return m.data;}else return m[l];};})(),getSelection:function(){var l=window.getSelection,k=document.selection;if(l){return l()+'';}else if(k)return k.createRange().text;return null;},create:function(m,k,l){m=document.createElement(m);if(k){k=copy_properties({},k);if(k.style){copy_properties(m.style,k.style);delete k.style;}for(var n in k)if(n.toLowerCase().indexOf('on')==0){if(!(typeof k[n]!='function'))if(window.Event&&Event.listen){Event.listen(m,n.substr(2),k[n]);}else m[n]=k[n];delete k[n];}copy_properties(m,k);}if(l!=undefined)d.setContent(m,l);return m;},prependContent:function(m,l){if(!d.isNode(m))throw new Error('DOM.prependContent: reference element is not a node');var k=function(n){if(m.firstChild){m.insertBefore(n,m.firstChild);}else m.appendChild(n);};return d._addContent(l,k,m);},insertAfter:function(m,l){if(!d.isNode(m)||!m.parentNode)throw new Error('DOM.insertAfter: reference element is not a node');var k=function(n){if(m.nextSibling){m.parentNode.insertBefore(n,m.nextSibling);}else m.parentNode.appendChild(n);};return d._addContent(l,k,m.parentNode);},insertBefore:function(l,m){if(!d.isNode(m)||!m.parentNode)throw new Error('DOM.insertBefore: reference element is not a node or '+'does not have a parent.');var k=function(n){m.parentNode.insertBefore(n,m);};return d._addContent(l,k,m.parentNode);},setContent:function(l,k){if(!d.isNode(l))throw new Error('DOM.setContent: reference element is not a node');d.empty(l);return d.appendContent(l,k);},appendContent:function(m,l){if(!d.isNode(m))throw new Error('DOM.appendContent: reference element is not a node');var k=function(n){m.appendChild(n);};return d._addContent(l,k,m);},replace:function(m,l){if(!d.isNode(m)||!m.parentNode)throw new Error('DOM.replace: reference element must be a node with a'+' parent');var k=function(n){m.parentNode.replaceChild(n,m);};return d._addContent(l,k,m.parentNode);},remove:function(k){k=a(k);if(k.parentNode)k.parentNode.removeChild(k);},empty:function(k){k=a(k);while(k.firstChild)d.remove(k.firstChild);},contains:function(l,k){l=g(l);k=g(k);if(!l||!k){return false;}else if(l===k){return true;}else if(d.isTextNode(l)){return false;}else if(d.isTextNode(k)){return d.contains(l,k.parentNode);}else if(l.contains){return l.contains(k);}else if(l.compareDocumentPosition){return !!(l.compareDocumentPosition(k)&16);}else return false;},getRootElement:function(){var k=null;if(window.Quickling&&Quickling.isActive())k=g('content');return k||document.body;},isNode:function(k){return !!(k&&(typeof Node=='object'?k instanceof Node:typeof k=="object"&&typeof k.nodeType=='number'&&typeof k.nodeName=='string'));},isNodeOfType:function(l,m){var k=Object.from($A(m).join('|').toUpperCase().split('|'));return d.isNode(l)&&l.nodeName in k;},isElementNode:function(k){return d.isNode(k)&&k.nodeType==1;},isTextNode:function(k){return d.isNode(k)&&k.nodeType==3;},_addContent:function(n,k,w){n=e.replaceJSONWrapper(n);if(n instanceof e&&-1==n.toString().indexOf('<scr'+'ipt')&&''==w.innerHTML){var q=ua.ie();if(!q||(q>7&&!d.isNodeOfType(w,['table','tbody','thead','tfoot','tr','select','fieldset']))){var r=q?"<em style=\"display:none;\">&nbsp;</em>":"";w.innerHTML=r+n;q&&w.removeChild(w.firstChild);return $A(w.childNodes);}}else if(d.isTextNode(w)){w.data=n;return [n];}var t,o=[],l=[];var p=document.createDocumentFragment();if(!(n instanceof Array))n=[n];for(var s=0;s<n.length;s++){t=e.replaceJSONWrapper(n[s]);if(t instanceof e){l.push(t.getAction());var v=t.getNodes(),m;for(var u=0;u<v.length;u++){m=(ua.safari()||(ua.ie()&&t.ieCloneBug()))?v[u]:v[u].cloneNode(true);o.push(m);p.appendChild(m);}}else if(is_scalar(t)){var x=document.createTextNode(t);o.push(x);p.appendChild(x);}else if(d.isNode(t)){o.push(t);p.appendChild(t);}else if(!(t instanceof Array))t!==null;}k(p);for(var s=0;s<l.length;s++)l[s]();return o;}};function b(m,k,l){if(typeof k!='object'||d.isNode(k)||k instanceof Array||e.isHTML(k)){l=k;k=null;}return d.create(m,k,l);}h.$N=d.$N=b;h.DOM=i.exports=d;},3);
__d("css",["dom","css-core"],function(d,e,f,c){var b=f('dom');var a=f('css-core');copy_properties(a,{shown:function(g){return !a.hasClass(g,'hidden_elem');},toggle:function(g){a.conditionShow(g,!a.shown(g));},setClass:function(h,g){$(h).className=g||'';return h;},setStyle:function(g,h,i){switch(h){case 'opacity':g.style.opacity=i;g.style.filter=i!==''?'alpha(opacity='+i*100+')':'';break;case 'float':g.style.cssFloat=g.style.styleFloat=i;break;default:h=h.replace(/-(.)/g,function(j,k){return k.toUpperCase();});g.style[h]=i;}return g;},getStyle:function(h,j){h=$(h);j=j.replace(/-(.)/g,function(k,l){return l.toUpperCase();});function i(k){return k.replace(/([A-Z])/g,'-$1').toLowerCase();}if(window.getComputedStyle){var g=window.getComputedStyle(h,null);if(g)return g.getPropertyValue(i(j));}if(document.defaultView&&document.defaultView.getComputedStyle){var g=document.defaultView.getComputedStyle(h,null);if(g)return g.getPropertyValue(i(j));if(j=="display")return "none";}if(h.currentStyle)return h.currentStyle[j];return h.style[j];},getStyleFloat:function(g,h){return parseFloat(a.getStyle(g,h),10);},getOpacity:function(g){g=$(g);var h=a.getStyle(g,'filter');var i=null;if(h&&(i=/(\d+(?:\.\d+)?)/.exec(h))){return parseFloat(i.pop())/100;}else if(h=a.getStyle(g,'opacity')){return parseFloat(h);}else return 1;},isFixed:function(g){while(g!==document.documentElement){if(a.getStyle(g,'position')==='fixed')return true;g=g.parentNode;}return false;}});e.exports=a;},3);
function show(){for(var b=0;b<arguments.length;b++){var a=ge(arguments[b]);if(a&&a.style)a.style.display='';}return false;}function hide(){for(var b=0;b<arguments.length;b++){var a=ge(arguments[b]);if(a&&a.style)a.style.display='none';}return false;}function shown(a){a=ge(a);return (a.style.display!='none'&&!(a.style.display==''&&a.offsetWidth==0));}function toggle(){for(var b=0;b<arguments.length;b++){var a=$(arguments[b]);a.style.display=CSS.getStyle(a,"display")=='block'?'none':'block';}return false;}function toggleDisplayNone(){for(var b=0;b<arguments.length;b++){var a=$(arguments[b]);if(shown(a)){hide(a);}else show(a);}return false;}
DataStore=window.DataStore||{_storage:{},_elements:{},_tokenCounter:1,_NOT_IN_DOM_CONST:1,_getStorage:function(a){var b;if(typeof a=='string'){b='str_'+a;}else{b='elem_'+(a.__FB_TOKEN||(a.__FB_TOKEN=[DataStore._tokenCounter++]))[0];DataStore._elements[b]=a;}return DataStore._storage[b]||(DataStore._storage[b]={});},_shouldDeleteData:function(a){if(!a.nodeName)return false;try{if(null!=a.offsetParent)return false;}catch(b){}if(document.documentElement.contains){return !document.documentElement.contains(a);}else return (document.documentElement.compareDocumentPosition(a)&DataStore._NOT_IN_DOM_CONST);},set:function(c,b,d){var a=DataStore._getStorage(c);a[b]=d;return c;},get:function(e,d,c){var b=DataStore._getStorage(e),f=b[d];if(typeof f==='undefined'&&e.getAttribute){var a=e.getAttribute('data-'+d);f=(null===a)?undefined:a;}if((c!==undefined)&&(f===undefined))f=b[d]=c;return f;},remove:function(c,b){var a=DataStore._getStorage(c),d=a[b];delete a[b];return d;},cleanup:function(){var b,a;for(b in DataStore._elements){a=DataStore._elements[b];if(DataStore._shouldDeleteData(a)){delete DataStore._storage[b];delete DataStore._elements[b];}}}};
window.Event=window.Event||function(){};Event.__inlineSubmit=function(b,event){var a=Event.__getHandler&&Event.__getHandler(b,'submit');return a?null:Event.__bubbleSubmit(b,event);};Event.__bubbleSubmit=function(a,event){if(document.documentElement.attachEvent){var b;while(b!==false&&(a=a.parentNode))b=a.onsubmit?a.onsubmit(event):Event.__fire&&Event.__fire(a,'submit',event);return b;}};
Event.DATASTORE_KEY='Event.listeners';if(!Event.prototype)Event.prototype={};function $E(a){a=a||window.event||{};if(!a._inherits_from_prototype)for(var c in Event.prototype)try{a[c]=Event.prototype[c];}catch(b){}return a;}(function(){copy_properties(Event.prototype,{_inherits_from_prototype:true,stop:function(){this.cancelBubble=true;this.stopPropagation&&this.stopPropagation();return this;},prevent:function(){this.returnValue=false;this.preventDefault&&this.preventDefault();return this;},kill:function(){this.stop().prevent();return false;},getTarget:function(){var g=this.target||this.srcElement;return g?$(g):null;},getRelatedTarget:function(){var g=this.relatedTarget||(this.fromElement===this.srcElement?this.toElement:this.fromElement);return g?$(g):null;},getModifiers:function(){var g={control:!!this.ctrlKey,shift:!!this.shiftKey,alt:!!this.altKey,meta:!!this.metaKey};g.access=ua.osx()?g.control:g.alt;g.any=g.control||g.shift||g.alt||g.meta;return g;}});copy_properties(Event,{listen:function(h,q,j,n){if(typeof h=='string')h=$(h);if(typeof n=='undefined')n=Event.Priority.NORMAL;if(typeof q=='object'){var i={};for(var p in q)i[p]=Event.listen(h,p,q[p],n);return i;}if(q.match(/^on/i))throw new TypeError("Bad event name `"+event+"': use `click', not `onclick'.");q=q.toLowerCase();if(h.nodeName=='LABEL'&&q=='click'){var m=h.getElementsByTagName('input');h=m.length==1?m[0]:h;}var k=DataStore.get(h,b,{});if(f[q]){var g=f[q];q=g.base;j=g.wrap(j);}a(h,q);var r=k[q];if(!(n in r))r[n]=[];var l=r[n].length,o=new EventHandlerRef(j,r[n],l);r[n].push(o);return o;},stop:function(g){return $E(g).stop();},prevent:function(g){return $E(g).prevent();},kill:function(g){return $E(g).kill();},getKeyCode:function(event){event=$E(event);if(!event)return false;switch(event.keyCode){case 63232:return 38;case 63233:return 40;case 63234:return 37;case 63235:return 39;case 63272:case 63273:case 63275:return null;case 63276:return 33;case 63277:return 34;}if(event.shiftKey)switch(event.keyCode){case 33:case 34:case 37:case 38:case 39:case 40:return null;}return event.keyCode;},getPriorities:function(){if(!e){var g=values(Event.Priority);g.sort(function(h,i){return h-i;});e=g;}return e;},__fire:function(g,i,event){var h=Event.__getHandler(g,i);if(h)return h($E(event));},__getHandler:function(g,h){return DataStore.get(g,Event.DATASTORE_KEY+h);}});var e=null,b=Event.DATASTORE_KEY;var c=function(g){return function(h){if(!DOM.contains(this,h.getRelatedTarget()))return g.call(this,h);};};var f={mouseenter:{base:'mouseover',wrap:c},mouseleave:{base:'mouseout',wrap:c}};var a=function(g,m){var h='on'+m;var k=d.bind(g);var j=DataStore.get(g,b);if(m in j)return;j[m]={};if(g.addEventListener){g.addEventListener(m,k,false);}else if(g.attachEvent)g.attachEvent(h,k);DataStore.set(g,b+m,k);if(g[h]){var l=g===document.documentElement?Event.Priority._BUBBLE:Event.Priority.TRADITIONAL;var i=g[h];g[h]=null;Event.listen(g,m,i,l);}if(g.nodeName==='FORM'&&m==='submit')Event.listen(g,m,Event.__bubbleSubmit.curry(g),Event.Priority._BUBBLE);};var d=function(event){event=$E(event);var n=event.type;if(!DataStore.get(this,b))throw new Error("Bad listenHandler context.");var o=DataStore.get(this,b)[n];if(!o)throw new Error("No registered handlers for `"+n+"'.");if(n=='click'){var i=Parent.byTag(event.getTarget(),'a');var p=user_action(i,'click',event);if(window.ArbiterMonitor)ArbiterMonitor.initUA(p,[i]);}var k=Event.getPriorities();for(var j=0;j<k.length;j++){var l=k[j];if(l in o){var g=o[l];for(var h=0;h<g.length;h++){if(!g[h])continue;var m=g[h].fire(this,event);if(m===false){return event.kill();}else if(event.cancelBubble)event.stop();}}}return event.returnValue;};})();Event.Priority={URGENT:-20,TRADITIONAL:-10,NORMAL:0,_BUBBLE:1000};function EventHandlerRef(b,a,c){this._handler=b;this._container=a;this._index=c;}EventHandlerRef.prototype={remove:function(){delete this._handler;delete this._container[this._index];},fire:function(a,event){return this._handler.call(a,event);}};
function DOMControl(a){this.root=$(a);this.updating=false;DataStore.set(a,'DOMControl',this);}DOMControl.prototype={getRoot:function(){return this.root;},beginUpdate:function(){if(this.updating)return false;this.updating=true;return true;},endUpdate:function(){this.updating=false;},update:function(a){if(!this.beginUpdate())return this;this.onupdate(a);this.endUpdate();},onupdate:function(a){}};DOMControl.getInstance=function(a){return DataStore.get(a,'DOMControl');};
add_properties('Input',{focus:function(a){try{a.focus();}catch(b){}},isEmpty:function(a){return !(/\S/).test(a.value||'')||CSS.hasClass(a,'DOMControl_placeholder');},getValue:function(a){return Input.isEmpty(a)?'':a.value;},setValue:function(b,d){CSS.removeClass(b,'DOMControl_placeholder');b.value=d||'';var c=b.getAttribute('maxlength');if(c>0)Bootloader.loadComponents('maxlength-form-listener',function(){Input.enforceMaxLength(b,c);});var a=DOMControl.getInstance(b);a&&a.resetHeight&&a.resetHeight();},setPlaceholder:function(a,b){a.setAttribute('title',b);a.setAttribute('placeholder',b);if(a==document.activeElement)return;if(Input.isEmpty(a)){CSS.conditionClass(a,'DOMControl_placeholder',b);a.value=b||'';}},reset:function(a){var b=a!==document.activeElement?(a.getAttribute('placeholder')||''):'';a.value=b;CSS.conditionClass(a,'DOMControl_placeholder',b);a.style.height='';},setSubmitOnEnter:function(a,b){CSS.conditionClass(a,'enter_submit',b);},getSubmitOnEnter:function(a){return CSS.hasClass(a,'enter_submit');}});
function URI(a){if(a===window)return;if(this===window)return new URI(a||window.location.href);this.parse(a||'');}copy_properties(URI,{getRequestURI:function(a,b){a=a===undefined||a;if(a&&window.PageTransitions&&PageTransitions.isInitialized()){return PageTransitions.getCurrentURI(!!b).getQualifiedURI();}else return new URI(window.location.href);},getMostRecentURI:function(){if(window.PageTransitions&&PageTransitions.isInitialized()){return PageTransitions.getMostRecentURI().getQualifiedURI();}else return new URI(window.location.href);},getNextURI:function(){if(window.PageTransitions&&PageTransitions.isInitialized()){return PageTransitions.getNextURI().getQualifiedURI();}else return new URI(window.location.href);},expression:/(((\w+):\/\/)([^\/:]*)(:(\d+))?)?([^#?]*)(\?([^#]*))?(#(.*))?/,arrayQueryExpression:/^(\w+)((?:\[\w*\])+)=?(.*)/,explodeQuery:function(g){if(!g)return {};var h={};g=g.replace(/%5B/ig,'[').replace(/%5D/ig,']');g=g.split('&');for(var b=0,d=g.length;b<d;b++){var e=g[b].match(URI.arrayQueryExpression);if(!e){var j=g[b].split('=');h[URI.decodeComponent(j[0])]=j[1]===undefined?null:URI.decodeComponent(j[1]);}else{var c=e[2].split(/\]\[|\[|\]/).slice(0,-1);var f=e[1];var k=URI.decodeComponent(e[3]||'');c[0]=f;var i=h;for(var a=0;a<c.length-1;a++)if(c[a]){if(i[c[a]]===undefined)if(c[a+1]&&!c[a+1].match(/\d+$/)){i[c[a]]={};}else i[c[a]]=[];i=i[c[a]];}else{if(c[a+1]&&!c[a+1].match(/\d+$/)){i.push({});}else i.push([]);i=i[i.length-1];}if(i instanceof Array&&c[c.length-1]==''){i.push(k);}else i[c[c.length-1]]=k;}}return h;},implodeQuery:function(f,e,a){e=e||'';if(a===undefined)a=true;var g=[];if(f===null||f===undefined){g.push(a?URI.encodeComponent(e):e);}else if(f instanceof Array){for(var c=0;c<f.length;++c)try{if(f[c]!==undefined)g.push(URI.implodeQuery(f[c],e?(e+'['+c+']'):c));}catch(b){}}else if(typeof(f)=='object'){if(DOM.isNode(f)){g.push('{node}');}else for(var d in f)try{if(f[d]!==undefined)g.push(URI.implodeQuery(f[d],e?(e+'['+d+']'):d));}catch(b){}}else if(a){g.push(URI.encodeComponent(e)+'='+URI.encodeComponent(f));}else g.push(e+'='+f);return g.join('&');},encodeComponent:function(d){var c=String(d).split(/([\[\]])/);for(var a=0,b=c.length;a<b;a+=2)c[a]=window.encodeURIComponent(c[a]);return c.join('');},decodeComponent:function(a){return window.decodeURIComponent(a.replace(/\+/g,' '));},INVALID_DOMAIN:'invalid.invalid',sanitizeDomain:function(a){var b=new RegExp('[\\x00-\\x2c\\x2f\\x3b-\\x40\\x5c\\x5e\\x60\\x7b-\\x7f'+'\\uFDD0-\\uFDEF\\uFFF0-\\uFFFF'+'\\u2047\\u2048\\uFE56\\uFE5F\\uFF03\\uFF0F\\uFF1F]');if(b.test(a)){return URI.INVALID_DOMAIN;}else return a;}});copy_properties(URI.prototype,{parse:function(b){var a=b.toString().match(URI.expression);copy_properties(this,{protocol:a[3]||'',domain:URI.sanitizeDomain(a[4]||''),port:a[6]||'',path:a[7]||'',query_s:a[9]||'',fragment:a[11]||''});return this;},setProtocol:function(a){this.protocol=a;return this;},getProtocol:function(){return this.protocol;},setQueryData:function(a){this.query_s=URI.implodeQuery(a);return this;},addQueryData:function(a){return this.setQueryData(copy_properties(this.getQueryData(),a));},removeQueryData:function(b){if(!(b instanceof Array))b=[b];var d=this.getQueryData();for(var a=0,c=b.length;a<c;++a)delete d[b[a]];return this.setQueryData(d);},getQueryData:function(){return URI.explodeQuery(this.query_s);},setFragment:function(a){this.fragment=a;return this;},getFragment:function(){return this.fragment;},setDomain:function(a){this.domain=URI.sanitizeDomain(a);return this;},getDomain:function(){return this.domain;},setPort:function(a){this.port=a;return this;},getPort:function(){return this.port;},setPath:function(a){this.path=a;return this;},getPath:function(){return this.path.replace(/^\/+/,'/');},isEmpty:function(){return !(this.path||this.protocol||this.domain||this.port||this.query_s||this.fragment);},toString:function(){var a='';this.protocol&&(a+=this.protocol+'://');this.domain&&(a+=this.domain);this.port&&(a+=':'+this.port);if(this.domain&&!this.path)a+='/';this.path&&(a+=this.path);this.query_s&&(a+='?'+this.query_s);this.fragment&&(a+='#'+this.fragment);return a;},valueOf:function(){return this.toString();},isFacebookURI:function(){if(!URI._facebookURIRegex)URI._facebookURIRegex=new RegExp('(^|\\.)facebook\\.com([^.]*)$','i');return (!this.domain||URI._facebookURIRegex.test(this.domain));},isQuicklingEnabled:function(){return window.Quickling&&Quickling.isActive()&&Quickling.isPageActive(this);},getRegisteredDomain:function(){if(!this.domain)return '';if(!this.isFacebookURI())return null;var b=this.domain.split('.');var a=b.indexOf('facebook');return b.slice(a).join('.');},getUnqualifiedURI:function(){return new URI(this).setProtocol(null).setDomain(null).setPort(null);},getQualifiedURI:function(){var b=new URI(this);if(!b.getDomain()){var a=URI();b.setProtocol(a.getProtocol()).setDomain(a.getDomain()).setPort(a.getPort());}return b;},isSameOrigin:function(a){var b=a||window.location.href;if(!(b instanceof URI))b=new URI(b.toString());if(this.getProtocol()&&this.getProtocol()!=b.getProtocol())return false;if(this.getDomain()&&this.getDomain()!=b.getDomain())return false;return true;},go:function(a){goURI(this,a);},setSubdomain:function(b){var c=new URI(this).getQualifiedURI();var a=c.getDomain().split('.');if(a.length<=2){a.unshift(b);}else a[0]=b;return c.setDomain(a.join('.'));},getSubdomain:function(){if(!this.getDomain())return '';var a=this.getDomain().split('.');if(a.length<=2){return '';}else return a[0];},setSecure:function(a){return this.setProtocol(a?'https':'http');},isSecure:function(){return this.getProtocol()=='https';}});
__d("vector",[],function(e,f,g,d){function a(i,j,h){copy_properties(this,{x:parseFloat(i),y:parseFloat(j),domain:h||'pure'});}copy_properties(a.prototype,{toString:function(){return '('+this.x+', '+this.y+')';},add:function(j,k){if(arguments.length==1){if(j.domain!='pure')j=j.convertTo(this.domain);return this.add(j.x,j.y);}var h=parseFloat(j);var i=parseFloat(k);return new a(this.x+h,this.y+i,this.domain);},mul:function(h,i){if(typeof(i)=="undefined")i=h;return new a(this.x*h,this.y*i,this.domain);},sub:function(h,i){if(arguments.length==1){return this.add(h.mul(-1));}else return this.add(-h,-i);},distanceTo:function(h){return this.sub(h).magnitude();},magnitude:function(){return Math.sqrt((this.x*this.x)+(this.y*this.y));},convertTo:function(h){if(h!='pure'&&h!='viewport'&&h!='document')return new a(0,0);if(h==this.domain)return new a(this.x,this.y,this.domain);if(h=='pure')return new a(this.x,this.y);if(this.domain=='pure')return new a(0,0);var i=a.getScrollPosition('document');var j=this.x,k=this.y;if(this.domain=='document'){j-=i.x;k-=i.y;}else{j+=i.x;k+=i.y;}return new a(j,k,h);},setElementPosition:function(h){var i=this.convertTo('document');h.style.left=parseInt(i.x)+'px';h.style.top=parseInt(i.y)+'px';return this;},setElementDimensions:function(h){return this.setElementWidth(h).setElementHeight(h);},setElementWidth:function(h){h.style.width=parseInt(this.x,10)+'px';return this;},setElementHeight:function(h){h.style.height=parseInt(this.y,10)+'px';return this;},scrollElementBy:function(h){if(h==document.body){window.scrollBy(this.x,this.y);}else{h.scrollLeft+=this.x;h.scrollTop+=this.y;}return this;}});copy_properties(a,{getEventPosition:function(i,h){h=h||'document';i=$E(i);var k=i.pageX||(i.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft));var l=i.pageY||(i.clientY+(document.documentElement.scrollTop||document.body.scrollTop));var j=new a(k,l,'document');return j.convertTo(h);},getScrollPosition:function(h){h=h||'document';var i=document.body.scrollLeft||document.documentElement.scrollLeft;var j=document.body.scrollTop||document.documentElement.scrollTop;return new a(i,j,'document').convertTo(h);},getElementPosition:function(j,i){i=i||'document';if(!j)return;if(!('getBoundingClientRect' in j))return new a(0,0,'document');var l=j.getBoundingClientRect(),h=document.documentElement,k=Math.round(l.left)-h.clientLeft,m=Math.round(l.top)-h.clientTop;return new a(k,m,'viewport').convertTo(i);},getElementDimensions:function(h){return new a(h.offsetWidth||0,h.offsetHeight||0);},getViewportDimensions:function(){var h=(window&&window.innerWidth)||(document&&document.documentElement&&document.documentElement.clientWidth)||(document&&document.body&&document.body.clientWidth)||0;var i=(window&&window.innerHeight)||(document&&document.documentElement&&document.documentElement.clientHeight)||(document&&document.body&&document.body.clientHeight)||0;return new a(h,i,'viewport');},getDocumentDimensions:function(){var h=(document&&document.documentElement&&document.documentElement.scrollWidth)||(document&&document.body&&document.body.scrollWidth)||0;var i=(document&&document.documentElement&&document.documentElement.scrollHeight)||(document&&document.body&&document.body.scrollHeight)||0;return new a(h,i,'document');},deserialize:function(i){var h=i.split(',');return new a(h[0],h[1]);}});function b(h){return a.getElementPosition(h,'document').x;}function c(h){return a.getElementPosition(h,'document').y;}e.elementY=c;e.elementX=b;e.Vector2=f.exports=a;},3);
function animation(a){if(a==undefined)return;if(this==window){return new animation(a);}else{this.obj=a;this._reset_state();this.queue=[];this.last_attr=null;}}animation.resolution=20;animation.offset=0;animation.prototype._reset_state=function(){this.state={attrs:{},duration:500};};animation.prototype.stop=function(){this._reset_state();this.queue=[];return this;};animation.prototype._build_container=function(){if(this.container_div){this._refresh_container();return;}if(this.obj.firstChild&&this.obj.firstChild.__animation_refs){this.container_div=this.obj.firstChild;this.container_div.__animation_refs++;this._refresh_container();return;}var b=document.createElement('div');b.style.padding='0px';b.style.margin='0px';b.style.border='0px';b.__animation_refs=1;var a=this.obj.childNodes;while(a.length)b.appendChild(a[0]);this.obj.appendChild(b);this._orig_overflow=this.obj.style.overflow;this.obj.style.overflow='hidden';this.container_div=b;this._refresh_container();};animation.prototype._refresh_container=function(){this.container_div.style.height='auto';this.container_div.style.width='auto';this.container_div.style.height=this.container_div.offsetHeight+'px';this.container_div.style.width=this.container_div.offsetWidth+'px';};animation.prototype._destroy_container=function(){if(!this.container_div)return;if(!--this.container_div.__animation_refs){var a=this.container_div.childNodes;while(a.length)this.obj.appendChild(a[0]);this.obj.removeChild(this.container_div);}this.container_div=null;this.obj.style.overflow=this._orig_overflow;};animation.ATTR_TO=1;animation.ATTR_BY=2;animation.ATTR_FROM=3;animation.prototype._attr=function(a,d,c){a=a.replace(/-[a-z]/gi,function(e){return e.substring(1).toUpperCase();});var b=false;switch(a){case 'background':this._attr('backgroundColor',d,c);return this;case 'margin':d=animation.parse_group(d);this._attr('marginBottom',d[0],c);this._attr('marginLeft',d[1],c);this._attr('marginRight',d[2],c);this._attr('marginTop',d[3],c);return this;case 'padding':d=animation.parse_group(d);this._attr('paddingBottom',d[0],c);this._attr('paddingLeft',d[1],c);this._attr('paddingRight',d[2],c);this._attr('paddingTop',d[3],c);return this;case 'backgroundColor':case 'borderColor':case 'color':d=animation.parse_color(d);break;case 'opacity':d=parseFloat(d,10);break;case 'height':case 'width':if(d=='auto'){b=true;}else d=parseInt(d,10);break;case 'borderWidth':case 'lineHeight':case 'fontSize':case 'marginBottom':case 'marginLeft':case 'marginRight':case 'marginTop':case 'paddingBottom':case 'paddingLeft':case 'paddingRight':case 'paddingTop':case 'bottom':case 'left':case 'right':case 'top':case 'scrollTop':case 'scrollLeft':d=parseInt(d,10);break;default:throw new Error(a+' is not a supported attribute!');}if(this.state.attrs[a]===undefined)this.state.attrs[a]={};if(b)this.state.attrs[a].auto=true;switch(c){case animation.ATTR_FROM:this.state.attrs[a].start=d;break;case animation.ATTR_BY:this.state.attrs[a].by=true;case animation.ATTR_TO:this.state.attrs[a].value=d;break;}};animation._get_box_width=function(c){var d=parseInt(CSS.getStyle(c,'paddingLeft'),10),e=parseInt(CSS.getStyle(c,'paddingRight'),10),a=parseInt(CSS.getStyle(c,'borderLeftWidth'),10),b=parseInt(CSS.getStyle(c,'borderRightWidth'),10);return c.offsetWidth-(d?d:0)-(e?e:0)-(a?a:0)-(b?b:0);};animation._get_box_height=function(c){var e=parseInt(CSS.getStyle(c,'paddingTop'),10),d=parseInt(CSS.getStyle(c,'paddingBottom'),10),a=parseInt(CSS.getStyle(c,'borderTopWidth'),10),b=parseInt(CSS.getStyle(c,'borderBottomWidth'),10);return c.offsetHeight-(e?e:0)-(d?d:0)-(a?a:0)-(b?b:0);};animation.prototype.to=function(a,b){if(b===undefined){this._attr(this.last_attr,a,animation.ATTR_TO);}else{this._attr(a,b,animation.ATTR_TO);this.last_attr=a;}return this;};animation.prototype.by=function(a,b){if(b===undefined){this._attr(this.last_attr,a,animation.ATTR_BY);}else{this._attr(a,b,animation.ATTR_BY);this.last_attr=a;}return this;};animation.prototype.from=function(a,b){if(b===undefined){this._attr(this.last_attr,a,animation.ATTR_FROM);}else{this._attr(a,b,animation.ATTR_FROM);this.last_attr=a;}return this;};animation.prototype.duration=function(a){this.state.duration=a?a:0;return this;};animation.prototype.checkpoint=function(b,a){if(b===undefined)b=1;this.state.checkpoint=b;this.queue.push(this.state);this._reset_state();this.state.checkpointcb=a;return this;};animation.prototype.blind=function(){this.state.blind=true;return this;};animation.prototype.hide=function(){this.state.hide=true;return this;};animation.prototype.show=function(){this.state.show=true;return this;};animation.prototype.ease=function(a){this.state.ease=a;return this;};animation.prototype.go=function(){var b=(new Date()).getTime();this.queue.push(this.state);for(var a=0;a<this.queue.length;a++){this.queue[a].start=b-animation.offset;if(this.queue[a].checkpoint)b+=this.queue[a].checkpoint*this.queue[a].duration;}animation.push(this);return this;};animation.prototype._show=function(){CSS.show(this.obj);};animation.prototype._hide=function(){CSS.hide(this.obj);};animation.prototype._frame=function(m){var c=true;var l=false;var o=false;var n;function d(p){return document.documentElement[p]||document.body[p];}for(var e=0;e<this.queue.length;e++){var b=this.queue[e];if(b.start>m){c=false;continue;}if(b.checkpointcb){this._callback(b.checkpointcb,m-b.start);b.checkpointcb=null;}if(b.started===undefined){if(b.show)this._show();for(var a in b.attrs){if(b.attrs[a].start!==undefined)continue;switch(a){case 'backgroundColor':case 'borderColor':case 'color':n=animation.parse_color(CSS.getStyle(this.obj,a=='borderColor'?'borderLeftColor':a));if(b.attrs[a].by){b.attrs[a].value[0]=Math.min(255,Math.max(0,b.attrs[a].value[0]+n[0]));b.attrs[a].value[1]=Math.min(255,Math.max(0,b.attrs[a].value[1]+n[1]));b.attrs[a].value[2]=Math.min(255,Math.max(0,b.attrs[a].value[2]+n[2]));}break;case 'opacity':n=CSS.getOpacity(this.obj);if(b.attrs[a].by)b.attrs[a].value=Math.min(1,Math.max(0,b.attrs[a].value+n));break;case 'height':n=animation._get_box_height(this.obj);if(b.attrs[a].by)b.attrs[a].value+=n;break;case 'width':n=animation._get_box_width(this.obj);if(b.attrs[a].by)b.attrs[a].value+=n;break;case 'scrollLeft':case 'scrollTop':n=(this.obj===document.body)?d(a):this.obj[a];if(b.attrs[a].by)b.attrs[a].value+=n;b['last'+a]=n;break;default:n=parseInt(CSS.getStyle(this.obj,a),10)||0;if(b.attrs[a].by)b.attrs[a].value+=n;break;}b.attrs[a].start=n;}if((b.attrs.height&&b.attrs.height.auto)||(b.attrs.width&&b.attrs.width.auto)){if(ua.firefox()<3)o=true;this._destroy_container();for(var a in {height:1,width:1,fontSize:1,borderLeftWidth:1,borderRightWidth:1,borderTopWidth:1,borderBottomWidth:1,paddingLeft:1,paddingRight:1,paddingTop:1,paddingBottom:1})if(b.attrs[a])this.obj.style[a]=b.attrs[a].value+(typeof b.attrs[a].value=='number'?'px':'');if(b.attrs.height&&b.attrs.height.auto)b.attrs.height.value=animation._get_box_height(this.obj);if(b.attrs.width&&b.attrs.width.auto)b.attrs.width.value=animation._get_box_width(this.obj);}b.started=true;if(b.blind)this._build_container();}var i=(m-b.start)/b.duration;if(i>=1){i=1;if(b.hide)this._hide();}else c=false;var k=b.ease?b.ease(i):i;if(!l&&i!=1&&b.blind)l=true;if(o&&this.obj.parentNode){var j=this.obj.parentNode;var h=this.obj.nextSibling;j.removeChild(this.obj);}for(var a in b.attrs)switch(a){case 'backgroundColor':case 'borderColor':case 'color':this.obj.style[a]='rgb('+animation.calc_tween(k,b.attrs[a].start[0],b.attrs[a].value[0],true)+','+animation.calc_tween(k,b.attrs[a].start[1],b.attrs[a].value[1],true)+','+animation.calc_tween(k,b.attrs[a].start[2],b.attrs[a].value[2],true)+')';break;case 'opacity':CSS.setStyle(this.obj,'opacity',animation.calc_tween(k,b.attrs[a].start,b.attrs[a].value));break;case 'height':case 'width':this.obj.style[a]=k==1&&b.attrs[a].auto?'auto':animation.calc_tween(k,b.attrs[a].start,b.attrs[a].value,true)+'px';break;case 'scrollLeft':case 'scrollTop':var f=this.obj===document.body;n=f?d(a):this.obj[a];if(b['last'+a]!==n){delete b.attrs[a];}else{var g=animation.calc_tween(k,b.attrs[a].start,b.attrs[a].value,true);if(!f){g=this.obj[a]=g;}else{if(a=='scrollLeft'){window.scrollTo(g,d('scrollTop'));}else window.scrollTo(d('scrollLeft'),g);g=d(a);}b['last'+a]=g;}break;default:this.obj.style[a]=animation.calc_tween(k,b.attrs[a].start,b.attrs[a].value,true)+'px';break;}if(i==1){this.queue.splice(e--,1);this._callback(b.ondone,m-b.start-b.duration);}}if(o)j[h?'insertBefore':'appendChild'](this.obj,h);if(!l&&this.container_div)this._destroy_container();return !c;};animation.prototype.ondone=function(a){this.state.ondone=a;return this;};animation.prototype._callback=function(a,b){if(a){animation.offset=b;a.call(this);animation.offset=0;}};animation.calc_tween=function(a,b,c,d){return (d?parseInt:parseFloat)((c-b)*a+b,10);};animation.parse_color=function(a){var b=/^#([a-f0-9]{1,2})([a-f0-9]{1,2})([a-f0-9]{1,2})$/i.exec(a);if(b){return [parseInt(b[1].length==1?b[1]+b[1]:b[1],16),parseInt(b[2].length==1?b[2]+b[2]:b[2],16),parseInt(b[3].length==1?b[3]+b[3]:b[3],16)];}else{var c=/^rgba? *\(([0-9]+), *([0-9]+), *([0-9]+)(?:, *([0-9]+))?\)$/.exec(a);if(c){if(c[4]==='0'){return [255,255,255];}else return [parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)];}else if(a=='transparent'){return [255,255,255];}else throw 'Named color attributes are not supported.';}};animation.parse_group=function(a){a=trim(a).split(/ +/);if(a.length==4){return a;}else if(a.length==3){return [a[0],a[1],a[2],a[1]];}else if(a.length==2){return [a[0],a[1],a[0],a[1]];}else return [a[0],a[0],a[0],a[0]];};animation.push=function(a){if(!animation.active)animation.active=[];animation.active.push(a);if(animation.active.length===1){if(!animation.requestAnimationFrame){var b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;if(b)animation.requestAnimationFrame=b.bind(window);}if(animation.requestAnimationFrame){animation.requestAnimationFrame(animation._animate);}else animation.timeout=setInterval(animation._animate,animation.resolution,false);}if(animation.requestAnimationFrame)animation._updateEndingTimer();animation._animate(new Date().getTime(),true);};animation._updateEndingTimer=function(){if(!animation.requestAnimationFrame)throw new Error('Ending timer only valid with requestAnimationFrame');var d=0;for(var a=0;a<animation.active.length;a++){var f=animation.active[a];for(var e=0;e<f.queue.length;e++){var b=f.queue[e].start+f.queue[e].duration;if(b>d)d=b;}}if(animation.timeout){clearTimeout(animation.timeout);delete animation.timeout;}var c=new Date().getTime();if(d>c)animation.timeout=setTimeout(animation._animate.shield(),d-c,false);};animation._animate=function(d,c){d=d||new Date().getTime();for(var b=(c===true)?animation.active.length-1:0;b<animation.active.length;b++)try{if(!animation.active[b]._frame(d))animation.active.splice(b--,1);}catch(a){animation.active.splice(b--,1);}if(animation.active.length===0){if(animation.timeout){if(animation.requestAnimationFrame){clearTimeout(animation.timeout);}else clearInterval(animation.timeout);delete animation.timeout;}}else if(animation.requestAnimationFrame)animation.requestAnimationFrame(animation._animate);};animation.ease={};animation.ease.begin=function(a){return Math.sin(Math.PI/2*(a-1))+1;};animation.ease.end=function(a){return Math.sin(.5*Math.PI*a);};animation.ease.both=function(a){return .5*Math.sin(Math.PI*(a-.5))+.5;};animation.prependInsert=function(b,a){animation.insert(b,a,DOM.prependContent);};animation.appendInsert=function(b,a){animation.insert(b,a,DOM.appendContent);};animation.insert=function(c,a,b){CSS.setStyle(a,'opacity',0);b(c,a);animation(a).from('opacity',0).to('opacity',1).duration(400).go();};
!function(){function a(b){return function(){if(this===window)throw new TypeError();return b.apply(this,arguments);};}copy_properties(Array.prototype,{map:function(c,b){if(this===window||typeof c!='function')throw new TypeError();var d;var e=this.length;var f=new Array(e);for(d=0;d<e;++d)if(d in this)f[d]=c.call(b,this[d],d,this);return f;},forEach:function(c,b){this.map(c,b);return this;},filter:function(c,b){c=c||function(h){return h;};if(this===window||typeof c!='function')throw new TypeError();var d,g,e=this.length,f=[];for(d=0;d<e;++d)if(d in this){g=this[d];if(c.call(b,g,d,this))f.push(g);}return f;},every:function(d,c){var b=this.filter(function(){return 1;});return (this.filter(d,c).length==b.length);},some:function(c,b){return (this.filter(c,b).length>0);},reduce:null,reduceRight:null,sort:a(Array.prototype.sort),reverse:a(Array.prototype.reverse),concat:a(Array.prototype.concat),slice:a(Array.prototype.slice),indexOf:a(Array.prototype.indexOf||function(d,b){var c=this.length;b|=0;if(b<0)b+=c;for(;b<c;b++)if(b in this&&this[b]===d)return b;return -1;}),contains:function(b){return this.indexOf(b)!=-1;},remove:function(c){var b=this.indexOf(c);if(b!=-1)this.splice(b,1);}});Array.prototype.each=Array.prototype.forEach;Array.prototype.clone=Array.prototype.slice;}();
var Button=(function(){var b='uiButtonDisabled';var a='uiButtonDepressed';var d='button:blocker';var c='href';function e(j,i){var h=DataStore.get(j,d);if(i){if(h){h.remove();DataStore.remove(j,d);}}else if(!h)DataStore.set(j,d,Event.listen(j,'click',bagof(false),Event.Priority.URGENT));}function f(h){var i=Parent.byClass(h,'uiButton');if(!i)throw new Error('invalid use case');return i;}function g(h){return DOM.isNodeOfType(h,'a');}return {getInputElement:function(h){h=f(h);if(g(h))throw new Error('invalid use case');return DOM.find(h,'input');},isEnabled:function(h){return !CSS.hasClass(f(h),b);},setEnabled:function(k,h){k=f(k);CSS.conditionClass(k,b,!h);if(g(k)){var i=k.href;var l=DataStore.get(k,c,'#');if(h){if(!i)k.href=l;}else{if(i&&i!==l)DataStore.set(k,c,i);k.removeAttribute('href');}e(k,h);}else{var j=Button.getInputElement(k);j.disabled=!h;e(j,h);}},setDepressed:function(i,h){CSS.conditionClass(f(i),a,h);},isDepressed:function(h){return CSS.hasClass(f(h),a);},setLabel:function(i,h){i=f(i);if(g(i)){var j=DOM.find(i,'span.uiButtonText');DOM.setContent(j,h);}else Button.getInputElement(i).value=h;CSS.conditionClass(i,'uiButtonNoText',!h);},setIcon:function(i,h){if(!DOM.isNode(h))return;CSS.addClass(h,'customimg');i=f(i);var j=DOM.scry(i,'.img')[0];if(j!=h)if(j){DOM.replace(j,h);}else DOM.prependContent(i,h);}};})();
__d("css-support",["css-core"],function(c,d,e,b){var a=e('css-core');copy_properties(a,{supportsBorderRadius:function(){var h=['KhtmlBorderRadius','OBorderRadius','MozBorderRadius','WebkitBorderRadius','msBorderRadius','borderRadius'];var i=false,f=document.createElement('div');for(var g=h.length;g>=0;g--)if(i=f.style[h[g]]!==undefined)break;a.supportsBorderRadius=bagof(i);return i;}});d.exports=a;},3);
function tx(b,a){if(typeof _string_table=='undefined')return;b=_string_table[b];return _tx(b,a);}function intl_ends_in_punct(a){if(typeof a!='string')return false;return a.match(new RegExp(intl_ends_in_punct.punct_char_class+'['+')"'+"'"+'\u00BB'+'\u0F3B'+'\u0F3D'+'\u2019'+'\u201D'+'\u203A'+'\u3009'+'\u300B'+'\u300D'+'\u300F'+'\u3011'+'\u3015'+'\u3017'+'\u3019'+'\u301B'+'\u301E'+'\u301F'+'\uFD3F'+'\uFF07'+'\uFF09'+'\uFF3D'+'\s'+']*$'));}intl_ends_in_punct.punct_char_class='['+'.!?'+'\u3002'+'\uFF01'+'\uFF1F'+'\u0964'+'\u2026'+'\u0EAF'+'\u1801'+'\u0E2F'+'\uFF0E'+']';function intl_render_list_separator(){return _tx("{previous-items}, {next-items}",{'previous-items':'','next-items':''});}function intl_phonological_rules(g){var e,d=g,f=window.intl_locale_rewrites,b,c;try{if(f){var pats=[],reps=[];for(var p in f.patterns){var pat=p,rep=f.patterns[p];for(b in f.meta){e=new RegExp(b.slice(1,-1),'g');pat=pat.replace(e,f.meta[b]);rep=rep.replace(e,f.meta[b]);}pats[pats.length]=pat;reps[reps.length]=rep;}for(var ii=0;ii<pats.length;ii++){e=new RegExp(pats[ii].slice(1,-1),'g');if(reps[ii]=='javascript'){c=g.match(e);b=c&&c[0];if(b)g=g.replace(e,b.slice(1).toLowerCase());}else g=g.replace(e,reps[ii]);}}}catch(a){g=d;}e=new RegExp('\x01','g');g=g.replace(e,'');return g;}function _tx(e,a){if(!a)return e;var d;for(var c in a){if(intl_ends_in_punct(a[c])){d=new RegExp('\\{'+c+'\\}'+intl_ends_in_punct.punct_char_class+'*','g');}else d=new RegExp('\\{'+c+'\\}','g');var b='';if(a[c][0]!='~')b='\x01';e=e.replace(d,b+a[c]+b);}e=intl_phonological_rules(e);return e;}
function intl_locale_is_rtl(){return ('rtl'==CSS.getStyle(document.body,'direction'));}
var KEYS={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,COMMA:188};
__d("ua",[],function(b,c,d,a){var e={ie:function(){return e._populate()||this._ie;},ie64:function(){return e.ie()&&this._win64;},firefox:function(){return e._populate()||this._firefox;},opera:function(){return e._populate()||this._opera;},safari:function(){return e._populate()||this._safari;},chrome:function(){return e._populate()||this._chrome;},windows:function(){return e._populate()||this._windows;},osx:function(){return e._populate()||this._osx;},linux:function(){return e._populate()||this._linux;},iphone:function(){return e._populate()||this._iphone;},_populated:false,_populate:function(){if(e._populated)return;e._populated=true;var i=navigator.userAgent;var f=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))/.exec(i);var h=/(Mac OS X)|(Windows)|(Linux)/.exec(i);var g=/\b(iPhone|iP[ao]d)/.exec(i);e._win64=!!(/Win64/.exec(i));if(f){e._ie=f[1]?parseFloat(f[1]):NaN;if(e._ie&&document.documentMode)e._ie=document.documentMode;e._firefox=f[2]?parseFloat(f[2]):NaN;e._opera=f[3]?parseFloat(f[3]):NaN;e._safari=f[4]?parseFloat(f[4]):NaN;if(e._safari){f=/(?:Chrome\/(\d+\.\d+))/.exec(i);e._chrome=f&&f[1]?parseFloat(f[1]):NaN;}else e._chrome=NaN;}else e._ie=e._firefox=e._opera=e._chrome=e._safari=NaN;if(h){if(h[1]){var j=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(i);e._osx=j?parseFloat(j[1].replace('_','.')):true;}else e._osx=false;e._windows=!!h[2];e._linux=!!h[3];}else e._osx=e._windows=e._linux=false;e._iphone=g;}};b.ua=c.exports=e;},3);
OnloadEvent={ONLOAD:'onload/onload',ONLOAD_CALLBACK:'onload/onload_callback',ONLOAD_DOMCONTENT:'onload/dom_content_ready',ONLOAD_DOMCONTENT_CALLBACK:'onload/domcontent_callback',ONBEFOREUNLOAD:'onload/beforeunload',ONUNLOAD:'onload/unload'};function _include_quickling_events_default(){return !window.loading_page_chrome;}function onbeforeunloadRegister(a,b){if(b===undefined)b=_include_quickling_events_default();b?_addHook('onbeforeleavehooks',a):_addHook('onbeforeunloadhooks',a);}function onunloadRegister(a){if(!window.onunload)window.onunload=function(){Arbiter.inform(OnloadEvent.ONUNLOAD,true,Arbiter.BEHAVIOR_STATE);};_addHook('onunloadhooks',a);}function onleaveRegister(a){_addHook('onleavehooks',a);}function _addHook(b,a){window[b]=(window[b]||[]).concat(a);}function removeHook(a){window[a]=[];}function _domcontentready(){Arbiter.inform(OnloadEvent.ONLOAD_DOMCONTENT,true,Arbiter.BEHAVIOR_STATE);}function _bootstrapEventHandlers(){var a=document,e=window;if(a.addEventListener){if(ua.safari()<525){var d=setInterval(function(){if(/loaded|complete/.test(a.readyState)){_domcontentready();clearInterval(d);}},10);}else a.addEventListener("DOMContentLoaded",_domcontentready,true);}else{var c='javascript:void(0)';if(e.location.protocol=='https:')c='//:';a.write('<script onreadystatechange="if (this.readyState==\'complete\') {'+'this.parentNode.removeChild(this);_domcontentready();}" '+'defer="defer" src="'+c+'"><\/script\>');}var b=e.onload;e.onload=function(){e.CavalryLogger&&CavalryLogger.getInstance().setTimeStamp('t_layout');b&&b();Arbiter.inform(OnloadEvent.ONLOAD,true,Arbiter.BEHAVIOR_STATE);};e.onbeforeunload=function(){var f={};Arbiter.inform(OnloadEvent.ONBEFOREUNLOAD,f,Arbiter.BEHAVIOR_STATE);if(!f.warn)Arbiter.inform('onload/exit',true);return f.warn;};}onload_callback=Arbiter.registerCallback(function(){window.CavalryLogger&&CavalryLogger.getInstance().setTimeStamp('t_onload');Arbiter.inform(OnloadEvent.ONLOAD_CALLBACK,true,Arbiter.BEHAVIOR_STATE);},[OnloadEvent.ONLOAD]);domcontent_callback=Arbiter.registerCallback(function(){window.CavalryLogger&&CavalryLogger.getInstance().setTimeStamp('t_domcontent');Arbiter.inform(OnloadEvent.ONLOAD_DOMCONTENT_CALLBACK,true,Arbiter.BEHAVIOR_STATE);},[OnloadEvent.ONLOAD_DOMCONTENT]);if(!window._eventHandlersBootstrapped){_eventHandlersBootstrapped=true;_bootstrapEventHandlers();}
__d("async-signal",[],function(c,d,e,b){function a(g,f){this.data=f||{};if(window.Env&&Env.tracking_domain&&g.charAt(0)=='/')g=Env.tracking_domain+g;this.uri=g;this.handler=null;}a.prototype.setHandler=function(f){this.handler=f;return this;};a.prototype.send=function(){var h=this.handler,g=this.data,l=this.uri,k=[],i=new Image(),f=document.getElementById('post_form_id');g.asyncSignal=Math.floor(Math.random()*10000)+1;if(f)g.post_form_id=f.value;if(window.Env){g.__user=Env.user;if(Env.fb_isb)g.fb_isb=Env.fb_isb;}for(var j in g)k.push(encodeURIComponent(j)+'='+encodeURIComponent(g[j]));if(l.indexOf('?')==-1)l+='?';l+=k.join('&');if(h)i.onload=i.onerror=(function(n,m){return function(){m((n.height==1));};})(i,h);i.src=l;return this;};c.AsyncSignal=d.exports=a;},3);
function setCookie(a,b,d,e){if(env_get('no_cookies')&&a!='tpa')return;if(d){var f=new Date();var c=new Date();c.setTime(f.getTime()+d);}document.cookie=a+"="+encodeURIComponent(b)+"; "+(d?"expires="+c.toGMTString()+"; ":"")+"path="+(e||'/')+"; domain="+window.location.hostname.replace(/^.*(\.facebook\..*)$/i,'$1');}function clearCookie(a){document.cookie=a+"=; expires=Sat, 01 Jan 2000 00:00:00 GMT; "+"path=/; domain="+window.location.hostname.replace(/^.*(\.facebook\..*)$/i,'$1');}function getCookie(d){var e=d+"=";var b=document.cookie.split(';');for(var c=0;c<b.length;c++){var a=b[c];while(a.charAt(0)==' ')a=a.substring(1,a.length);if(a.indexOf(e)==0)return decodeURIComponent(a.substring(e.length,a.length));}return null;}
function goURI(b,a){b=b.toString();if(!a&&window.PageTransitions&&PageTransitions.isInitialized()){PageTransitions.go(b);}else if(window.location.href==b){window.location.reload();}else window.location.href=b;}function loadExternalJavascript(f,b,a){if(f instanceof Array){var e=f.shift(0);if(e){loadExternalJavascript(e,function(){if(f.length){loadExternalJavascript(f,b,a);}else b&&b();},a);}else if(b)b();}else{var c=a?document.body:document.getElementsByTagName('head')[0];var d=document.createElement('script');d.type='text/javascript';d.src=f;if(b){d.onerror=d.onload=b;d.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded")b();};}c.appendChild(d);return d;}}function invoke_callbacks(b,d){if(b)for(var c=0;c<b.length;c++)try{(new Function(b[c])).apply(d);}catch(a){}}
function muffinize(d){var c='a';var b='d';var a=[c,b].join('');return d.replace(/muffin/g,a);}if(typeof console=='undefined')console={log:bagofholding,info:bagofholding,warn:bagofholding,debug:bagofholding,dir:bagofholding,error:bagofholding};window.Util=console;
if(!this.JSON)this.JSON=function(){function f(n){return n<10?'0'+n:n;}Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z';};var m={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function stringify(value,whitelist){var a,i,k,l,v;switch(typeof value){case 'string':return (new RegExp('[\x00-\x1f\\\\"]')).test(value)?'"'+value.replace(/[\x00-\x1f\\"]/g,function(a){var c=m[a];if(c)return c;c=a.charCodeAt();return '\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"':'"'+value+'"';case 'number':return isFinite(value)?String(value):'null';case 'boolean':return String(value);case 'null':return 'null';case 'object':if(!value)return 'null';if('nodeName' in value)return null;if(typeof value.toJSON==='function')return stringify(value.toJSON());a=[];if(typeof value.length==='number'&&!(propertyIsEnumerable(value,'length'))){l=value.length;for(i=0;i<l;i+=1)a.push(stringify(value[i],whitelist)||'null');return '['+a.join(',')+']';}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==='string'){v=stringify(value[k],whitelist);if(v)a.push(stringify(k)+':'+v);}}}else for(k in value)if(typeof k==='string'){v=stringify(value[k],whitelist);if(v)a.push(stringify(k)+':'+v);}return '{'+a.join(',')+'}';}}return {stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==='object')for(i in v)if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined)v[i]=n;}return filter(k,v);}if(text&&/^[\],:{}\s]*$/.test(text.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(:?[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof filter==='function'?walk('',j):j;}throw new SyntaxError('decodeJSON');}};}();function propertyIsEnumerable(a,b){if(a.propertyIsEnumerable)return a.propertyIsEnumerable(b);for(var c in a)if(c==b)return true;return false;}
var ErrorDialog={showAsyncError:function(b){try{return ErrorDialog.show(b.getErrorSummary(),b.getErrorDescription());}catch(a){alert(b);}},show:function(d,c,b,a){return (new Dialog()).setTitle(d).setBody(c).setButtons([Dialog.OK]).setStackable(true).setModal(true).setHandler(b||bagofholding).setButtonsMessage(a||'').show();}};
add_properties('Form',{getInputs:function(a){a=a||document;return [].concat($A(DOM.scry(a,'input')),$A(DOM.scry(a,'select')),$A(DOM.scry(a,'textarea')),$A(DOM.scry(a,'button')));},getSelectValue:function(a){return a.options[a.selectedIndex].value;},setSelectValue:function(b,c){for(var a=0;a<b.options.length;++a)if(b.options[a].value==c){b.selectedIndex=a;break;}},getRadioValue:function(b){for(var a=0;a<b.length;a++)if(b[a].checked)return b[a].value;return null;},getElements:function(a){return $A(a.tagName=='FORM'?a.elements:Form.getInputs(a));},getAttribute:function(b,a){return (b.getAttributeNode(a)||{}).value||null;},setDisabled:function(b,a){Form.getElements(b).forEach(function(c){if(c.disabled!=undefined){var d=DataStore.get(c,'origDisabledState');if(a){if(d===undefined)DataStore.set(c,'origDisabledState',c.disabled);c.disabled=a;}else{if(d!==true)c.disabled=false;DataStore.remove(c,'origDisabledState');}}});},bootstrap:function(d,e){var f=(Form.getAttribute(d,'method')||'GET').toUpperCase();e=Parent.byTag(e,'button')||e;var h=Parent.byClass(e,'stat_elem')||d;if(CSS.hasClass(h,'async_saving'))return;if(e&&(e.form!==d||(e.nodeName!='INPUT'&&e.nodeName!='BUTTON')||e.type!='submit')){var i=DOM.scry(d,'.enter_submit_target')[0];var b=e;i&&(e=i);}var c=Form.serialize(d,e);Form.setDisabled(d,true);var a=Form.getAttribute(d,'ajaxify')||Form.getAttribute(d,'action');trackReferrer(d,a);var g=new AsyncRequest(a);g.setData(c).setNectarModuleDataSafe(d).setReadOnly(f=='GET').setMethod(f).setRelativeTo(d).setStatusElement(h).setInitialHandler(Form.setDisabled.curry(d,false)).send();},serialize:function(b,c){var a={};Form.getElements(b).forEach(function(d){if(d.name&&!d.disabled&&d.type!='submit')if(!d.type||((d.type=='radio'||d.type=='checkbox')&&d.checked)||d.type=='text'||d.type=='password'||d.type=='hidden'||d.tagName=='TEXTAREA'){var h;if(d.name=='post_form_id')h=Env.post_form_id;Form._serializeHelper(a,d.name,h||Input.getValue(d));}else if(d.tagName=='SELECT')for(var e=0,f=d.options.length;e<f;++e){var g=d.options[e];if(g.selected)Form._serializeHelper(a,d.name,g.value);}});if(c&&c.name&&'submit'==c.type&&DOM.contains(b,c)&&DOM.isNodeOfType(c,['input','button']))Form._serializeHelper(a,c.name,c.value);return Form._serializeFix(a);},_serializeHelper:function(a,d,e){var c=/([^\]]+)\[([^\]]*)\](.*)/.exec(d);if(c){a[c[1]]=a[c[1]]||{};if(c[2]==''){var b=0;while(a[c[1]][b]!=undefined)b++;}else b=c[2];if(c[3]==''){a[c[1]][b]=e;}else Form._serializeHelper(a[c[1]],b.concat(c[3]),e);}else a[d]=e;},_serializeFix:function(a){var e=[];for(var b in a){if(a[b] instanceof Object)a[b]=Form._serializeFix(a[b]);e.push(b);}if(e.length>0){var d=0,c=true;e.sort().each(function(g){if(g!=d++)c=false;});if(c){var f=[];e.each(function(g){f[g]=a[g];});return f;}}return a;},post:function(d,b,c){var a=document.createElement('form');a.action=d.toString();a.method='POST';a.style.display='none';if(c)a.target=c;if(ge('post_form_id'))b.post_form_id=$('post_form_id').value;b.fb_dtsg=Env.fb_dtsg;b.post_form_id_source='dynamic_post';Form.createHiddenInputs(b,a);DOM.getRootElement().appendChild(a);a.submit();return false;},createHiddenInputs:function(g,a,d,f){d=d||{};var c;var h=URI.implodeQuery(g,'',false);var i=h.split('&');for(var b=0;b<i.length;b++)if(i[b]){var j=i[b].split('=');var e=j[0];var k=j[1];if(e===undefined||k===undefined)continue;k=URI.decodeComponent(k);if(d[e]&&f){d[e].value=k;}else{c=$N('input',{type:'hidden',name:e,value:k});d[e]=c;a.appendChild(c);}}return d;},getFirstElement:function(b,g){g=g||['input[type="text"]','textarea','input[type="password"]','input[type="button"]','input[type="submit"]'];var f=[];for(var d=0;d<g.length;d++){f=DOM.scry(b,g[d]);for(var c=0;c<f.length;c++){var e=f[c];try{if(elementY(e)>0&&elementX(e)>0)return e;}catch(a){}}}return null;},focusFirst:function(b){var a=Form.getFirstElement(b);if(a){a.focus();return true;}return false;}});
function Dialog(a){this._show_loading=true;this._auto_focus=true;this._submit_on_enter=false;this._fade_enabled=true;this._onload_handlers=[];this._top=125;this._uniqueID='dialog_'+Dialog._globalCount++;this._content=null;this._obj=null;this._popup=null;this._overlay=null;this._shim=null;this._hidden_objects=[];this._causal_elem=null;this._previous_focus=null;this._buttons=[];this._buildDialog();if(a)this._setFromModel(a);Dialog._init();}Metaprototype.makeFinal(Dialog);copy_properties(Dialog,{OK:{name:'ok',label:_tx("OK")},CANCEL:{name:'cancel',label:_tx("Cancel"),className:'inputaux'},CLOSE:{name:'close',label:_tx("Close")},NEXT:{name:'next',label:_tx("Next")},SAVE:{name:'save',label:_tx("Save")},SUBMIT:{name:'submit',label:_tx("Submit")},CONFIRM:{name:'confirm',label:_tx("Confirm")},DELETE:{name:'delete',label:_tx("Delete")},_globalCount:0,_bottoms:[0],max_bottom:0,_updateMaxBottom:function(){Dialog.max_bottom=Math.max.apply(Math,Dialog._bottoms);}});copy_properties(Dialog,{OK_AND_CANCEL:[Dialog.OK,Dialog.CANCEL],_STANDARD_BUTTONS:[Dialog.OK,Dialog.CANCEL,Dialog.CLOSE,Dialog.SAVE,Dialog.SUBMIT,Dialog.CONFIRM,Dialog.DELETE],SHOULD_HIDE_OBJECTS:!ua.windows(),_useCSSBorders:CSS.supportsBorderRadius()||ua.ie()<=6,SIZE:{WIDE:555,STANDARD:445},_HALO_WIDTH:10,_BORDER_WIDTH:1,_PADDING_WIDTH:10,_PAGE_MARGIN:40,_stack:[],newButton:function(e,d,b,c){var a={name:e,label:d};if(b)a.className=b;if(c)a.handler=c;return a;},getCurrent:function(){var a=Dialog._stack;return a.length?a[a.length-1]:null;},bootstrap:function(i,a,f,d,e,c){a=a||{};var j=c&&c.rel=='dialog-pipe';copy_properties(a,new URI(i).getQueryData());d=d||(f?'GET':'POST');var h=Parent.byClass(c,'stat_elem')||c;if(h&&CSS.hasClass(h,'async_saving'))return false;var g;if(j){g=new AjaxPipeRequest();}else g=new AsyncRequest().setReadOnly(!!f).setMethod(d).setRelativeTo(c).setStatusElement(h);g.setURI(i).setNectarModuleDataSafe(c).setData(a);var b=new Dialog(e).setCausalElement(c).setAsync(g,j);b.show();return false;},_init:function(){this._init=bagofholding;onleaveRegister(Dialog._tearDown.shield(null,false));Arbiter.subscribe('page_transition',Dialog._tearDown.shield(null,true));Event.listen(document.documentElement,'keydown',function(event){if(Event.getKeyCode(event)==KEYS.ESC&&!event.getModifiers().any){if(Dialog._escape())event.kill();}else if(Event.getKeyCode(event)==KEYS.RETURN&&!event.getModifiers().any)if(Dialog._enter())event.kill();});Event.listen(window,'resize',function(event){var a=Dialog.getCurrent();a&&a._resetDialogObj();});},_findButton:function(a,c){if(a)for(var b=0;b<a.length;++b)if(a[b].name==c)return a[b];return null;},_tearDown:function(b){var c=Dialog._stack.clone();for(var a=c.length-1;a>=0;a--)if(!(b&&c[a]._cross_transition))c[a].hide();},_escape:function(){var d=Dialog.getCurrent();if(!d)return false;var e=d._semi_modal;var b=d._buttons;if(!b&&!e)return false;if(e&&!b){d.hide();return true;}var a;var c=Dialog._findButton(b,'cancel');if(d._cancelHandler){d.cancel();return true;}else if(c){a=c;}else if(b.length==1){a=b[0];}else return false;d._handleButton(a);return true;},_enter:function(){var b=Dialog.getCurrent();if(!b||!b._submit_on_enter)return false;if(document.activeElement!=b._frame)return false;var a=b._buttons;if(!a)return false;b._handleButton(a[0]);return true;},call_or_eval:function(obj,func,args){if(!func)return undefined;args=args||{};if(typeof(func)=='string'){var params=keys(args).join(', ');func=eval('({f: function('+params+') { '+func+'}})').f;}return func.apply(obj,values(args));}});copy_properties(Dialog.prototype,{_cross_transition:false,_fixed:false,_loading:false,_showing:false,show:function(){if(this._async_request&&this._show_loading){this.showLoading();}else{this._showing=true;this._update();}return this;},showLoading:function(){this._loading=true;CSS.addClass(this._frame,'dialog_loading_shown');this._renderDialog();return this;},hide:function(){if(!this._showing&&!this._loading)return this;this._showing=false;if(this._autohide_timeout){clearTimeout(this._autohide_timeout);this._autohide_timeout=null;}if(this._fade_enabled&&Dialog._stack.length<=1){this._fadeOut();}else this._hide();return this;},cancel:function(){if(!this._cancelHandler||this._cancelHandler()!==false)this.hide();},getRoot:function(){return this._obj;},getBody:function(){return DOM.scry(this._obj,'div.dialog_body')[0];},getButtonElement:function(a){if(typeof a=='string')a=Dialog._findButton(this._buttons,a);if(!a||!a.name)return null;var b=DOM.scry(this._popup,'input');var c=function(d){return d.name==a.name;};return b.filter(c)[0]||null;},getContentNode:function(){return DOM.find(this._content,'div.dialog_content');},getFormData:function(){return Form.serialize(this.getContentNode());},setAllowCrossPageTransition:function(a){this._cross_transition=a;return this;},setShowing:function(){this.show();return this;},setHiding:function(){this.hide();return this;},setTitle:function(d){var c=this._nodes.title;var b=this._nodes.title_inner;var a=this._nodes.content;DOM.setContent(b,this._format(d||''));CSS.conditionShow(c,!!d);CSS.conditionClass(a,'dialog_content_titleless',!d);return this;},setBody:function(a){DOM.setContent(this._nodes.body,this._format(a));return this;},setExtraData:function(a){this._extra_data=a;return this;},setReturnData:function(a){this._return_data=a;return this;},setShowLoading:function(a){this._show_loading=a;return this;},setFullBleed:function(a){this._full_bleed=a;this._updateWidth();CSS.conditionClass(this._obj,'full_bleed',a);return this;},setCausalElement:function(a){this._causal_elem=a;return this;},setUserData:function(a){this._user_data=a;return this;},getUserData:function(){return this._user_data;},setAutohide:function(a){if(a){if(this._showing){this._autohide_timeout=setTimeout(this.hide.shield(this),a);}else this._autohide=a;}else{this._autohide=null;if(this._autohide_timeout){clearTimeout(this._autohide_timeout);this._autohide_timeout=null;}}return this;},setSummary:function(b){var a=this._nodes.summary;DOM.setContent(a,this._format(b||''));CSS.conditionShow(a,!!b);return this;},setButtons:function(b){var g,c;if(!(b instanceof Array)){g=$A(arguments);}else g=b;for(var h=0;h<g.length;++h)if(typeof g[h]=='string'){c=Dialog._findButton(Dialog._STANDARD_BUTTONS,g[h]);g[h]=c;}this._buttons=g;var d=[];if(g&&g.length>0)for(var i=0;i<g.length;i++){c=g[i];var e=$N('input',{type:'button',name:c.name||'',value:c.label});var f=$N('label',{className:'uiButton uiButtonLarge uiButtonConfirm'},e);if(c.className){c.className.split(/\s+/).each(function(j){CSS.addClass(f,j);});if(CSS.hasClass(f,'inputaux')){CSS.removeClass(f,'inputaux');CSS.removeClass(f,'uiButtonConfirm');}if(CSS.hasClass(f,'uiButtonSpecial'))CSS.removeClass(f,'uiButtonConfirm');}if(c.icon)DOM.prependContent(f,$N('img',{src:c.icon,className:'img mrs'}));if(c.disabled)Button.setEnabled(f,false);Event.listen(e,'click',this._handleButton.bind(this,c.name));for(var a in c)if(a.indexOf('data-')===0&&a.length>5)e.setAttribute(a,c[a]);d.push(f);}DOM.setContent(this._nodes.buttons,d);this._updateButtonVisibility();return this;},setButtonsMessage:function(a){DOM.setContent(this._nodes.button_message,this._format(a||''));this._has_button_message=!!a;this._updateButtonVisibility();return this;},_updateButtonVisibility:function(){var a=this._buttons.length>0||this._has_button_message;CSS.conditionShow(this._nodes.button_wrapper,a);CSS.conditionClass(this._obj,'omitDialogFooter',!a);},setClickButtonOnEnter:function(c,a){var b=ge(c);if(b)this._clickOnEnterListener=Event.listen(b,'keypress',function(event){if(Event.getKeyCode(event)==KEYS.RETURN){this._handleButton(a);event.kill();}return true;}.bind(this));return this;},setStackable:function(b,a){this._is_stackable=b;this._shown_while_stacked=b&&a;return this;},setHandler:function(a){this._handler=a;return this;},setCancelHandler:function(a){this._cancelHandler=Dialog.call_or_eval.bind(null,this,a);return this;},setCloseHandler:function(a){this._close_handler=Dialog.call_or_eval.bind(null,this,a);return this;},clearHandler:function(){return this.setHandler(null);},setPostURI:function(b,a){if(a===undefined)a=true;if(a){this.setHandler(this._submitForm.bind(this,'POST',b));}else this.setHandler(function(){Form.post(b,this.getFormData());this.hide();}.bind(this));return this;},setGetURI:function(a){this.setHandler(this._submitForm.bind(this,'GET',a));return this;},setModal:function(a){this._modal=a;return this;},setSemiModal:function(a){if(a)this.setModal(true);this._semi_modal=a;return this;},setWideDialog:function(a){this._wide_dialog=a;this._updateWidth();return this;},setContentWidth:function(a){this._content_width=a;this._updateWidth();return this;},setTitleLoading:function(b){if(b===undefined)b=true;var a=DOM.find(this._popup,'h2.dialog_title');if(a)CSS.conditionClass(a,'loading',b);return this;},setSecure:function(a){CSS.conditionClass(this._nodes.title,'secure',a);return this;},setClassName:function(a){CSS.addClass(this._obj,a);return this;},setFadeEnabled:function(a){this._fade_enabled=a;return this;},setFooter:function(a){var b=this._nodes.footer;DOM.setContent(b,this._format(a||''));CSS.conditionShow(b,!!a);return this;},setAutoFocus:function(a){this._auto_focus=a;return this;},setTop:function(a){this._top=a;this._resetDialogObj();return this;},setFixed:function(a){this._fixed=a;this._resetDialogObj();return this;},onloadRegister:function(a){$A(a).forEach(function(b){if(typeof b=='string')b=new Function(b);this._onload_handlers.push(b.bind(this));}.bind(this));return this;},setAsyncURL:function(a){return this.setAsync(new AsyncRequest(a));},setAsync:function(a,i){var d=function(m){if(this._async_request!=a)return;this._async_request=null;var l=m.getPayload();var j=l;var k=function(){if(this._loading)this._showing=true;if(typeof j=='string'){this.setBody(j);}else this._setFromModel(j);this._update();}.bind(this);if(i){j=l.dialog;Bootloader.setResourceMap(l.resource_map);Bootloader.loadResources(l.css,k);}else k();}.bind(this);var b=a.getData();b.__d=1;a.setData(b);var h;if(i){a.setFirstResponseHandler(d);h=a.getAsyncRequest();}else{var f=a.getHandler()||bagofholding;a.setHandler(function(j){f(j);d(j);});h=a;}var e=h.getErrorHandler()||bagofholding;var g=h.getTransportErrorHandler()||bagofholding;var c=function(){this._async_request=null;if(this._showing){this._update();}else this._hide();}.bind(this);h.setAllowCrossPageTransition(this._cross_transition).setErrorHandler(function(j){c();e(j);}).setTransportErrorHandler(function(j){c();g(j);});a.send();this._async_request=a;this._update();return this;},_format:function(a){if(typeof a=='string'){a=HTML(a);}else a=HTML.replaceJSONWrapper(a);if(a instanceof HTML)a.setDeferred(true);return a;},_update:function(){if(!this._showing)return;if(this._autohide&&!this._async_request&&!this._autohide_timeout)this._autohide_timeout=setTimeout(bind(this,'hide'),this._autohide);if(this._async_request&&this._show_loading){this.showLoading();}else{CSS.removeClass(this._frame,'dialog_loading_shown');this._loading=false;this._renderDialog();this._runOnloads();this._previous_focus=document.activeElement;Input.focus(this._frame);}},_runOnloads:function(){for(var b=0;b<this._onload_handlers.length;++b)try{this._onload_handlers[b]();}catch(a){}this._onload_handlers=[];},_updateWidth:function(){var a=2*Dialog._BORDER_WIDTH;if(Dialog._useCSSBorders)a+=2*Dialog._HALO_WIDTH;if(this._content_width){a+=this._content_width;if(!this._full_bleed)a+=2*Dialog._PADDING_WIDTH;}else if(this._wide_dialog){a+=Dialog.SIZE.WIDE;}else a+=Dialog.SIZE.STANDARD;this._popup.style.width=a+'px';},_renderDialog:function(){this._showDialog();this._submit_on_enter=false;if(this._auto_focus){var b=Form.getFirstElement(this._content,['input[type="text"]','textarea','input[type="password"]']);if(b){Form.focusFirst.bind(this,this._content).defer();}else this._submit_on_enter=true;}var a=Vector2.getElementDimensions(this._content).y+Vector2.getElementPosition(this._content).y;Dialog._bottoms.push(a);this._bottom=a;Dialog._updateMaxBottom();return this;},_buildDialog:function(){this._obj=$N('div',{className:'generic_dialog',id:this._uniqueID});this._obj.style.display='none';document.body.appendChild(this._obj);if(!this._popup)this._popup=$N('div',{className:'generic_dialog_popup'});this._popup.style.left=this._popup.style.top='';this._obj.appendChild(this._popup);if(ua.ie()<7&&!this._shim)Bootloader.loadComponents('iframe-shim',function(){this._shim=new IframeShim(this._popup);});this._buildDialogContainer();this._buildDialogContent();},_showDialog:function(){if(this._modal){this._buildOverlay();}else if(this._overlay){DOM.remove(this._overlay);this._overlay=null;}if(this._obj&&this._obj.style.display){this._obj.style.visibility='hidden';this._obj.style.display='';this.resetDialogPosition();this._obj.style.visibility='';this._obj.dialog=this;}else this.resetDialogPosition();clearInterval(this.active_hiding);this.active_hiding=setInterval(this._activeResize.bind(this),500);var c=Dialog._stack;if(!c.length)Arbiter.inform('layer_shown',{type:'Dialog'});c.remove(this);c.push(this);for(var a=c.length-2;a>=0;a--){var b=c[a];if(!b._is_stackable&&!b._async_request){b._hide();}else if(!b._shown_while_stacked)b._hide(true);}return this;},_updateShim:function(){return this._shim&&this._shim.show();},_activeResize:function(){if(this.last_offset_height!=this._content.offsetHeight){this.last_offset_height=this._content.offsetHeight;this._updateShim();}},_buildDialogContainer:function(){CSS.addClass(this._obj,'pop_dialog');if(intl_locale_is_rtl())CSS.addClass(this._obj,'pop_dialog_rtl');var b;if(Dialog._useCSSBorders){b='<div class="pop_container_advanced">'+'<div class="pop_content" id="pop_content"></div>'+'</div>';}else b='<div class="pop_container">'+'<div class="pop_verticalslab"></div>'+'<div class="pop_horizontalslab"></div>'+'<div class="pop_topleft"></div>'+'<div class="pop_topright"></div>'+'<div class="pop_bottomright"></div>'+'<div class="pop_bottomleft"></div>'+'<div class="pop_content pop_content_old" id="pop_content"></div>'+'</div>';DOM.setContent(this._popup,HTML(b));var a=DOM.find(this._popup,'div.pop_content');a.setAttribute('tabIndex','0');a.setAttribute('role','alertdialog');this._frame=this._content=a;},_buildDialogContent:function(){var g=$N('div',{className:'dialog_loading'},_tx("Loading..."));var j=$N('span');var i=$N('h2',{className:'dialog_title hidden_elem',id:'title_'+this._uniqueID},j);var h=$N('div',{className:'dialog_summary hidden_elem'});var a=$N('div',{className:'dialog_body'});var d=$N('div');var b=$N('div',{className:'dialog_buttons_msg'});var c=$N('div',{className:'dialog_buttons clearfix hidden_elem'},[b,d]);var f=$N('div',{className:'dialog_footer hidden_elem'});var e=$N('div',{className:'dialog_content'},[h,a,c,f]);this._nodes={summary:h,body:a,buttons:d,button_message:b,button_wrapper:c,footer:f,content:e,title:i,title_inner:j};DOM.setContent(this._frame,[i,e,g]);},_buildOverlay:function(){if(this._overlay)return;this._overlay=$N('div',{className:'overlay'});if(this._semi_modal)Event.listen(this._obj,'click',function(a){if(!DOM.contains(this._popup,a.getTarget()))this.hide();}.bind(this));if(ua.ie()<7)this._overlay.style.height=Vector2.getDocumentDimensions().y+'px';this._obj.insertBefore(this._overlay,this._obj.firstChild);},resetDialogPosition:function(){if(!this._popup)return;this._resetDialogObj();this._updateShim();},_resetDialogObj:function(){var a=DOM.find(this._popup,'div.pop_content');var b=Vector2.getElementDimensions(a).y+(2*Dialog._HALO_WIDTH);var g=Vector2.getViewportDimensions().y-(2*Dialog._PAGE_MARGIN);var f=this._top;var e=Vector2.getScrollPosition().y;var c=g-b;if(c<0){f=Dialog._PAGE_MARGIN;}else if(f>c)f=Dialog._PAGE_MARGIN+(Math.max(c,0)/2);if(!this._fixed)f+=e;CSS.conditionClass(this._obj,'generic_dialog_fixed',this._fixed);var d=this._fixed&&c<0;CSS.conditionClass(this._obj,'generic_dialog_fixed_overflow',d);CSS.conditionClass(document.body,'generic_dialog_overflow_mode',d);CSS.setStyle(this._popup,'top',f+'px');if(this._fixed&&f-Vector2.getElementPosition(this._popup,'viewport').y>1){f+=e;CSS.setStyle(this._popup,'top',f+'px');}},_fadeOut:function(b){if(!this._popup)return;try{animation(this._obj).duration(0).checkpoint().to('opacity',0).hide().duration(250).ondone(this._hide.bind(this,b)).go();}catch(a){this._hide(b);}},_hide:function(d){if(this._obj)this._obj.style.display='none';this._updateShim();if(this.timeout){clearTimeout(this.timeout);this.timeout=null;}if(this._hidden_objects.length){for(var b=0,c=this._hidden_objects.length;b<c;b++)this._hidden_objects[b].style.visibility='';this._hidden_objects=[];}clearInterval(this.active_hiding);if(this._bottom){var a=Dialog._bottoms;a.splice(a.indexOf(this._bottom),1);Dialog._updateMaxBottom();}if(this._previous_focus&&document.activeElement&&DOM.contains(this._obj,document.activeElement))Input.focus(this._previous_focus);if(d)return;this.destroy();},destroy:function(){var a=Dialog._stack;var b=(a[a.length-1]===this);a.remove(this);if(a.length){if(b)a[a.length-1]._showDialog();}else Arbiter.inform('layer_hidden',{type:'Dialog'});if(this._obj){DOM.remove(this._obj);this._obj=null;this._shim&&this._shim.hide();this._shim=null;}this._clickOnEnterListener&&this._clickOnEnterListener.remove();if(this._close_handler)this._close_handler({return_data:this._return_data});},_handleButton:function(a){if(typeof a=='string')a=Dialog._findButton(this._buttons,a);var b=Dialog.call_or_eval(a,a.handler);if(b===false)return;if(a.name=='cancel'){this.cancel();}else if(Dialog.call_or_eval(this,this._handler,{button:a})!==false)this.hide();},_submitForm:function(d,e,b){var c=this.getFormData();if(b)c[b.name]=b.label;if(this._extra_data)copy_properties(c,this._extra_data);var a=new AsyncRequest().setURI(e).setData(c).setMethod(d).setNectarModuleDataSafe(this._causal_elem).setReadOnly(d=='GET');this.setAsync(a);return false;},_setFromModel:function(c){var a={};copy_properties(a,c);for(var d in a){if(d=='onloadRegister'){this.onloadRegister(a[d]);continue;}var b=this['set'+d.substr(0,1).toUpperCase()+d.substr(1)];b.apply(this,$A(a[d]));}},_updateBottom:function(){var a=Vector2.getElementDimensions(this._content).y+Vector2.getElementPosition(this._content).y;Dialog._bottoms[Dialog._bottoms.length-1]=a;Dialog._updateMaxBottom();}});
__d("async",[],function(global,module,require,exports){function AsyncRequest(uri){var dispatchResponse=bind(this,function(asyncResponse){try{this.clearStatusIndicator();if(!this.isRelevant()){invokeErrorHandler(1010);return;}if(this.initialHandler(asyncResponse)!==false){clearTimeout(this.timer);asyncResponse.jscc&&invoke_callbacks([asyncResponse.jscc]);if(this.handler)try{var suppress_onload=this.handler(asyncResponse);}catch(exception){asyncResponse.is_last&&this.finallyHandler(asyncResponse);throw exception;}if(suppress_onload!==AsyncRequest.suppressOnloadToken){var onload=asyncResponse.onload;if(onload)for(var ii=0;ii<onload.length;ii++)try{(new Function(onload[ii])).apply(this);}catch(exception){}if(this.lid)Arbiter.inform('tti_ajax',{s:this.lid,d:[this._sendTimeStamp||0,(this._sendTimeStamp&&this._responseTime)?(this._responseTime-this._sendTimeStamp):0]},Arbiter.BEHAVIOR_EVENT);var onafterload=asyncResponse.onafterload;if(onafterload)for(var ii=0;ii<onafterload.length;ii++)try{(new Function(onafterload[ii])).apply(this);}catch(exception){}}asyncResponse.is_last&&this.finallyHandler(asyncResponse);}}catch(exception){}});var dispatchErrorResponse=bind(this,function(asyncResponse,isTransport){try{this.clearStatusIndicator();var async_error=asyncResponse.getError();if(this._sendTimeStamp){var _duration=(+new Date())-this._sendTimeStamp;var xfb_ip=this._xFbServer||'-';asyncResponse.logError('async_error',{duration:_duration,xfb_ip:xfb_ip});}else asyncResponse.logError('async_error');if((!this.isRelevant())||async_error===1010)return;if(async_error==1357008||async_error==1357007||async_error==1442002||async_error==1357001){var is_confirmation=false;if(async_error==1357008||async_error==1357007)is_confirmation=true;var payload=asyncResponse.getPayload();this._displayServerDialog(payload.__dialog,is_confirmation);}else if(this.initialHandler(asyncResponse)!==false){clearTimeout(this.timer);try{if(isTransport){this.transportErrorHandler(asyncResponse);}else this.errorHandler(asyncResponse);}catch(exception){this.finallyHandler(asyncResponse);throw exception;}this.finallyHandler(asyncResponse);}}catch(exception){}});var _interpretTransportResponse=bind(this,function(){if(this.getOption('suppressEvaluation')){var r=new AsyncResponse(this,this.transport);return {asyncResponse:r};}var _sendError=function(p,error_code,str){if(!window.send_error_signal)return;if(this._xFbServer){error_code='1008_'+error_code;}else error_code='1012_'+error_code;send_error_signal('async_xport_resp',error_code+':'+(this._xFbServer||'-')+':'+p.getURI()+':'+str.length+':'+str.substr(0,1600));};var shield="for (;;);";var shieldlen=shield.length;var text=this.transport.responseText;if(text.length<=shieldlen){_sendError(this,'empty',text);return {transportError:'Response too short on async to '+this.getURI()};}var offset=0;while(text.charAt(offset)==" "||text.charAt(offset)=="\n")offset++;offset&&text.substring(offset,offset+shieldlen)==shield;var safeResponse=text.substring(offset+shieldlen);try{var response=eval('('+safeResponse+')');}catch(exception){_sendError(this,'excep',text);return {transportError:'eval() failed on async to '+this.getURI()};}return interpretResponse(response);});var interpretResponse=bind(this,function(response){if(response.redirect)return {redirect:response.redirect};var r=new AsyncResponse(this);if(response.__ar!=1){r.payload=response;}else{copy_properties(r,response);if(response.tplts)if(window.DynaTemplate)DynaTemplate.registerTemplates(response.tplts);}return {asyncResponse:r};});var invokeResponseHandler=bind(this,function(interp){if(typeof(interp.redirect)!='undefined'){(function(){this.setURI(interp.redirect).send();}).bind(this).defer();return;}if(this.handler||this.errorHandler||this.transportErrorHandler)if(typeof(interp.asyncResponse)!='undefined'){var r=interp.asyncResponse;if(!this.isRelevant()){invokeErrorHandler(1010);return;}if(r.inlinejs)eval_global(r.inlinejs);if(r.lid){this._responseTime=(+new Date());if(window.CavalryLogger)this.cavalry=CavalryLogger.getInstance(r.lid);this.lid=r.lid;}if(r.getError()&&!r.getErrorIsWarning()){var fn=dispatchErrorResponse;}else var fn=dispatchResponse;Bootloader.setResourceMap(r.resource_map);if(r.bootloadable)Bootloader.enableBootload(r.bootloadable);fn=fn.shield(null,r);fn=fn.defer.bind(fn);var is_transitional=false;if(this.preBootloadHandler)is_transitional=this.preBootloadHandler(r);r.css=r.css||[];r.js=r.js||[];Bootloader.loadResources(r.css.concat(r.js),fn,is_transitional,this.getURI());}else if(typeof(interp.transportError)!='undefined'){if(this._xFbServer){invokeErrorHandler(1008);}else invokeErrorHandler(1012);}else invokeErrorHandler(1007);});var invokeErrorHandler=bind(this,function(explicitError){try{if(!window.loaded&&!this.getOption('handleErrorAfterUnload'))return;}catch(ex){return;}var r=new AsyncResponse(this);var err;try{err=explicitError||this.transport.status||1004;}catch(ex){err=1005;}if(this._requestAborted)err=1011;try{if(this.responseText=='')err=1002;}catch(ignore){}if(this.transportErrorHandler){var desc,summary;var silent=true;if(false===navigator.onLine){summary=_tx("No network connection");desc=_tx("Your browser appears to be offline. Please check your Internet connection and try again.");err=1006;}else if(err>=300&&err<=399){summary=_tx("Redirection");desc=_tx("Your access to Facebook was redirected or blocked by a third party at this time, please contact your ISP or reload. ");redir_url=this.transport.getResponseHeader("Location");if(redir_url)goURI(redir_url,true);silent=true;}else{summary=_tx("Oops!");desc=_tx("Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.");}!this.getOption('suppressErrorAlerts');copy_properties(r,{error:err,errorSummary:summary,errorDescription:desc,silentError:silent});dispatchErrorResponse(r,true);}});var handleResponse=function(response){var asyncResponse=this.interpretResponse(response);this.invokeResponseHandler(asyncResponse);};var onStateChange=function(){try{if(this.transport.readyState==4){AsyncRequest._inflightPurge();try{if(typeof(this.transport.getResponseHeader)!='undefined'&&this.transport.getResponseHeader('X-FB-Server'))this._xFbServer=this.transport.getResponseHeader('X-FB-Server');}catch(ex){}if(this.transport.status>=200&&this.transport.status<300){invokeResponseHandler(_interpretTransportResponse());}else if(ua.safari()&&(typeof(this.transport.status)=='undefined')){invokeErrorHandler(1002);}else if(window.Env&&window.Env.retry_ajax_on_network_error&&this.transport.status in {0:1,12029:1,12030:1,12031:1,12152:1}&&this.remainingRetries>0){--this.remainingRetries;delete this.transport;this.send(true);return;}else invokeErrorHandler();if(this.getOption('asynchronous')!==false)delete this.transport;}}catch(exception){try{if(!window.loaded)return;}catch(ex){return;}delete this.transport;if(this.remainingRetries>0){--this.remainingRetries;this.send(true);}else{!this.getOption('suppressErrorAlerts');if(window.send_error_signal)send_error_signal('async_xport_resp','1007:'+(this._xFbServer||'-')+':'+this.getURI()+':'+exception.message);invokeErrorHandler(1007);}}};var onJSONPResponse=function(data,more_chunked_response){var is_first=(this.is_first===undefined);this.is_first=is_first;if(this.transportIframe&&!more_chunked_response){if(this.cavalry)this.cavalry.collectBrowserTiming(this.transportIframe.contentWindow);(function(x){document.body.removeChild(x);}).bind(null,this.transportIframe).defer();}if(ua.ie()>=9&&window.JSON)data=window.JSON.parse(window.JSON.stringify(data));var r=this.interpretResponse(data);r.asyncResponse.is_first=is_first;r.asyncResponse.is_last=!more_chunked_response;this.invokeResponseHandler(r);return more_chunked_response;};copy_properties(this,{onstatechange:onStateChange,onjsonpresponse:onJSONPResponse,invokeResponseHandler:invokeResponseHandler,interpretResponse:interpretResponse,handleResponse:handleResponse,transport:null,method:'POST',uri:'',timeout:null,timer:null,initialHandler:bagofholding,handler:null,errorHandler:null,transportErrorHandler:null,timeoutHandler:null,finallyHandler:bagofholding,serverDialogCancelHandler:bagofholding,relativeTo:null,statusElement:null,statusClass:'',data:{},context:{},readOnly:false,writeRequiredParams:['post_form_id'],remainingRetries:0,option:{asynchronous:true,suppressErrorHandlerWarning:false,suppressEvaluation:false,suppressErrorAlerts:false,retries:0,jsonp:false,bundle:false,useIframeTransport:false,tfbEndpoint:true,handleErrorAfterUnload:false},userActionID:'-'});this.errorHandler=AsyncResponse.defaultErrorHandler;this.transportErrorHandler=bind(this,'errorHandler');if(uri!=undefined)this.setURI(uri);return this;}Arbiter.subscribe("page_transition",function(type,message){AsyncRequest._id_threshold=message.id;});copy_properties(AsyncRequest,{receiveJSONPResponse:function(id,data,more_chunked_response){if(this._JSONPReceivers[id]){if(!this._JSONPReceivers[id](data,more_chunked_response))delete this._JSONPReceivers[id];}else if(window.send_error_signal&&!more_chunked_response){var uri=(data.payload&&data.payload.uri)||'';send_error_signal('js_timeout_and_exception','00002:WrongSessionID:error:'+id+':'+uri);}},_bundleRequest:function(request){if(request.getOption('jsonp')||request.getOption('useIframeTransport')){request.setOption('bundle',false);return false;}else if(!request.uri.isFacebookURI()){request.setOption('bundle',false);return false;}else if(!request.getOption('asynchronous')){request.setOption('bundle',false);return false;}var path=request.uri.getPath();if(!AsyncRequest._bundleTimer)AsyncRequest._bundleTimer=setTimeout(function(){AsyncRequest._sendBundledRequests();},0);AsyncRequest._allBundledRequests.push([path,request]);return true;},_sendBundledRequests:function(){clearTimeout(AsyncRequest._bundleTimer);AsyncRequest._bundleTimer=null;var bundled_requests=AsyncRequest._allBundledRequests;AsyncRequest._allBundledRequests=[];if(bundled_requests.length==1){var request=bundled_requests[0][1];request.setOption('bundle',false).send();return request;}if(bundled_requests.length===0)return null;var data=[];for(var ii=0;ii<bundled_requests.length;ii++)data.push([bundled_requests[ii][0],URI.implodeQuery(bundled_requests[ii][1].data)]);var query_data={data:data};var request=new AsyncRequest();request.setURI('/ajax/proxy.php').setData(query_data).setMethod('POST').setInitialHandler(bagof(true)).setAllowCrossPageTransition(true).setHandler(function(r){var payload=r.getPayload();var responses=payload.responses;if(responses.length!=bundled_requests.length){return;}else for(var ii=0;ii<bundled_requests.length;ii++){var path=bundled_requests[ii][0];var request=bundled_requests[ii][1];request.id=this.id;if(responses[ii][0]!=path){request.invokeResponseHandler({transportError:'Wrong response order in bundled request to '+path});continue;}var asyncResponse=request.interpretResponse(responses[ii][1]);request.invokeResponseHandler(asyncResponse);}}).setTransportErrorHandler(function(response){var paths=[];var interp={transportError:response.errorDescription};for(var ii=0;ii<bundled_requests.length;ii++){var path=bundled_requests[ii][0];var request=bundled_requests[ii][1];paths.push(path);request.id=this.id;request.invokeResponseHandler(interp);}}).send();return request;},bootstrap:function(href,elem,is_post){var method='GET';var readonly=true;var data={};if(is_post||elem&&(elem.rel=='async-post'||elem.getAttribute&&elem.getAttribute('forcemethod')=='post')){method='POST';readonly=false;if(href){href=URI(href);data=href.getQueryData();href.setQueryData({});}}var status_elem=Parent.byClass(elem,'stat_elem')||elem;if(status_elem&&CSS.hasClass(status_elem,'async_saving'))return false;var async=new AsyncRequest(href).setReadOnly(readonly).setMethod(method).setData(data).setNectarModuleDataSafe(elem).setRelativeTo(elem);if(status_elem){async.setStatusElement(status_elem);var status_class=status_elem.getAttribute('data-status-class');status_class&&async.setStatusClass(status_class);}async.send();return false;},post:function(href,data){new AsyncRequest(href).setReadOnly(false).setMethod('POST').setData(data).send();return false;},getLastId:function(){return AsyncRequest._last_id;},_JSONPReceivers:{},_allBundledRequests:[],_bundleTimer:null,suppressOnloadToken:{},_last_id:2,_id_threshold:2,_inflight:[],_inflightAdd:bagofholding,_inflightPurge:bagofholding,_inflightEnable:function(){if(ua.ie()){copy_properties(AsyncRequest,{_inflightAdd:function(ar){this._inflight.push(ar);},_inflightPurge:function(){AsyncRequest._inflight=AsyncRequest._inflight.filter(function(ar){return ar.transport&&ar.transport.readyState<4;});}});onunloadRegister(function(){AsyncRequest._inflight.each(function(ar){if(ar.transport&&ar.transport.readyState<4){ar.transport.abort();delete ar.transport;}});});}}});copy_properties(AsyncRequest.prototype,{setMethod:function(m){this.method=m.toString().toUpperCase();return this;},getMethod:function(){return this.method;},setData:function(obj){this.data=obj;return this;},getData:function(){return this.data;},setContextData:function(key,value,enabled){enabled=enabled===undefined?true:enabled;if(enabled)this.context['_log_'+key]=value;return this;},_setUserActionID:function(){var ue=window.ArbiterMonitor&&ArbiterMonitor.getUE()||'-';this.userActionID=(window.EagleEye&&EagleEye.getSessionID()||'-')+'/'+ue;},setURI:function(uri){var uri_obj=URI(uri);if(this.getOption('useIframeTransport')&&!uri_obj.isFacebookURI())return this;if(!this.getOption('jsonp')&&!this.getOption('useIframeTransport')&&!uri_obj.isSameOrigin())return this;this._setUserActionID();if(!uri||uri_obj.isEmpty()){if(window.send_error_signal&&window.get_error_stack){var data={err_code:1013,vip:'-',duration:0,xfb_ip:'-',path:window.location.href,aid:this.userActionID};send_error_signal('async_error',JSON.stringify(data));send_error_signal('async_xport_stack','1013:'+window.location.href+'::'+get_error_stack());}return this;}this.uri=uri_obj;return this;},getURI:function(){return this.uri.toString();},setInitialHandler:function(fn){this.initialHandler=fn;return this;},setHandler:function(fn){if(!(typeof(fn)!='function'))this.handler=fn;return this;},getHandler:function(){return this.handler;},setErrorHandler:function(fn){if(!(typeof(fn)!='function'))this.errorHandler=fn;return this;},setTransportErrorHandler:function(fn){this.transportErrorHandler=fn;return this;},getErrorHandler:function(){return this.errorHandler;},getTransportErrorHandler:function(){return this.transportErrorHandler;},setTimeoutHandler:function(timeout,fn){if(!(typeof(fn)!='function')){this.timeout=timeout;this.timeoutHandler=fn;}return this;},resetTimeout:function(timeout){if(!(this.timeoutHandler===null))if(timeout===null){this.timeout=null;clearTimeout(this.timer);this.timer=null;}else{var clear_on_quickling_event=!this._allowCrossPageTransition;this.timeout=timeout;clearTimeout(this.timer);this.timer=this._handleTimeout.bind(this).defer(this.timeout,clear_on_quickling_event);}return this;},_handleTimeout:function(){this.abandon();this.timeoutHandler(this);},setNewSerial:function(){this.id=++AsyncRequest._last_id;return this;},setFinallyHandler:function(fn){this.finallyHandler=fn;return this;},setServerDialogCancelHandler:function(fn){this.serverDialogCancelHandler=fn;return this;},setPreBootloadHandler:function(fn){this.preBootloadHandler=fn;return this;},setReadOnly:function(readOnly){if(!(typeof(readOnly)!='boolean'))this.readOnly=readOnly;return this;},setFBMLForm:function(){this.writeRequiredParams=["fb_sig"];return this;},getReadOnly:function(){return this.readOnly;},setRelativeTo:function(element){this.relativeTo=element;return this;},getRelativeTo:function(){return this.relativeTo;},setStatusClass:function(c){this.statusClass=c;return this;},setStatusElement:function(element){this.statusElement=element;return this;},getStatusElement:function(){return ge(this.statusElement);},isRelevant:function(){if(this._allowCrossPageTransition)return true;if(!this.id)return true;return this.id>AsyncRequest._id_threshold;},clearStatusIndicator:function(){var statusElem=this.getStatusElement();if(statusElem){CSS.removeClass(statusElem,'async_saving');CSS.removeClass(statusElem,this.statusClass);}},addStatusIndicator:function(){var statusElem=this.getStatusElement();if(statusElem){CSS.addClass(statusElem,'async_saving');CSS.addClass(statusElem,this.statusClass);}},specifiesWriteRequiredParams:function(){return this.writeRequiredParams.every(function(param){this.data[param]=this.data[param]||Env[param]||(ge(param)||{}).value;if(this.data[param]!==undefined)return true;return false;},this);},setOption:function(opt,v){if(typeof(this.option[opt])!='undefined')this.option[opt]=v;return this;},getOption:function(opt){typeof(this.option[opt])=='undefined';return this.option[opt];},abort:function(){if(this.transport){var old_handler=this.getTransportErrorHandler();this.setOption('suppressErrorAlerts',true);this.setTransportErrorHandler(bagofholding);this._requestAborted=1;this.transport.abort();this.setTransportErrorHandler(old_handler);}},abandon:function(){clearTimeout(this.timer);this.setOption('suppressErrorAlerts',true).setHandler(bagofholding).setErrorHandler(bagofholding).setTransportErrorHandler(bagofholding);if(this.transport){this._requestAborted=1;this.transport.abort();}},setNectarData:function(nctrParams){if(nctrParams){if(this.data.nctr===undefined)this.data.nctr={};copy_properties(this.data.nctr,nctrParams);}return this;},setNectarModuleDataSafe:function(elem){if(this.setNectarModuleData)this.setNectarModuleData(elem);return this;},setNectarImpressionIdSafe:function(){if(this.setNectarImpressionId)this.setNectarImpressionId();return this;},setAllowCrossPageTransition:function(allow){this._allowCrossPageTransition=!!allow;if(this.timer)this.resetTimeout(this.timeout);return this;},send:function(isRetry){isRetry=isRetry||false;if(!this.uri)return false;!this.errorHandler&&!this.getOption('suppressErrorHandlerWarning');if(this.getOption('jsonp')&&this.method!='GET')this.setMethod('GET');if(this.getOption('useIframeTransport')&&this.method!='GET')this.setMethod('GET');this.timeoutHandler!==null&&(this.getOption('jsonp')||this.getOption('useIframeTransport'));if(!this.getReadOnly()){this.specifiesWriteRequiredParams();if(this.method!='POST')return false;}if(this.method=='POST'&&this.getOption('tfbEndpoint')){this.data.fb_dtsg=Env.fb_dtsg;this.data.lsd=getCookie('lsd');}if(!is_empty(this.context)&&this.getOption('tfbEndpoint')){copy_properties(this.data,this.context);this.data.ajax_log=1;}if(window.Env&&Env.force_param)copy_properties(this.data,Env.force_param);if(!this.getReadOnly()&&this.getOption('tfbEndpoint')&&this.method=='POST'&&this.data.post_form_id_source===undefined)this.data.post_form_id_source='AsyncRequest';if(window.Env)this.data.__user=Env.user;this._setUserActionID();if(this.getOption('bundle')&&AsyncRequest._bundleRequest(this))return true;this.setNewSerial();if(this.getOption('tfbEndpoint')){this.uri.addQueryData({__a:1});if(Env.fb_isb)this.uri.addQueryData({fb_isb:Env.fb_isb});}this.finallyHandler=async_callback(this.finallyHandler,'final');var uri_str,query;if(this.method=='GET'){uri_str=this.uri.addQueryData(this.data).toString();query='';}else{uri_str=this.uri.toString();query=URI.implodeQuery(this.data);}if(this.getOption('jsonp')||this.getOption('useIframeTransport')){uri_str=this.uri.addQueryData({__a:this.id}).toString();AsyncRequest._JSONPReceivers[this.id]=async_callback(bind(this,'onjsonpresponse'),'json');if(this.getOption('jsonp')){(function(){document.body.appendChild($N('script',{src:uri_str,type:"text/javascript"}));}).bind(this).defer();}else{var style={position:'absolute',top:'-9999999px',width:'80px',height:'80px'};this.transportIframe=$N('iframe',{src:"javascript:''",style:style});document.body.appendChild(this.transportIframe);this.transportIframe.src=uri_str;}return true;}if(this.transport)return false;var transport=null;try{transport=new XMLHttpRequest();}catch(ignored){}if(!transport)try{transport=new ActiveXObject("Msxml2.XMLHTTP");}catch(ignored){}if(!transport)try{transport=new ActiveXObject("Microsoft.XMLHTTP");}catch(ignored){}if(!transport)return false;transport.onreadystatechange=async_callback(bind(this,'onstatechange'),'xhr');if(!isRetry)this.remainingRetries=this.getOption('retries');if(window.send_error_signal||window.ArbiterMonitor)this._sendTimeStamp=this._sendTimeStamp||(+new Date());this.transport=transport;try{this.transport.open(this.method,uri_str,this.getOption('asynchronous'));}catch(ex){return false;}var svn_rev=env_get('svn_rev');if(svn_rev)this.transport.setRequestHeader('X-SVN-Rev',String(svn_rev));if(this.method=='POST')this.transport.setRequestHeader('Content-Type','application/x-www-form-urlencoded');this.addStatusIndicator();this.transport.send(query);if(this.timeout!==null)this.resetTimeout(this.timeout);AsyncRequest._inflightAdd(this);return true;},_displayServerDialog:function(model,is_confirmation){var dialog=new Dialog(model);if(is_confirmation)dialog.setHandler(this._displayConfirmationHandler.bind(this,dialog));dialog.setCancelHandler(function(){this.serverDialogCancelHandler.apply(this,arguments);this.finallyHandler.apply(this,arguments);}.bind(this)).setCloseHandler(this.finallyHandler.bind(this)).show();},_displayConfirmationHandler:function(dialog){this.data.confirmed=1;copy_properties(this.data,dialog.getFormData());this.send();}});function AsyncResponse(request,payload){copy_properties(this,{error:0,errorSummary:null,errorDescription:null,onload:null,replay:false,payload:payload||null,request:request||null,silentError:false,is_last:true});return this;}copy_properties(AsyncResponse,{defaultErrorHandler:function(response){try{if(!response.silentError){AsyncResponse.verboseErrorHandler(response);}else response.logErrorByGroup('silent',10);}catch(ex){alert(response);}},verboseErrorHandler:function(response){try{var summary=response.getErrorSummary();var desc=response.getErrorDescription();response.logErrorByGroup('popup',10);if(response.silentError&&desc=='')desc=_tx("Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.");ErrorDialog.show(summary,desc);}catch(ex){alert(response);}}});copy_properties(AsyncResponse.prototype,{getRequest:function(){return this.request;},getPayload:function(){return this.payload;},getError:function(){return this.error;},getErrorSummary:function(){return this.errorSummary;},setErrorSummary:function(summary){summary=(summary===undefined?null:summary);this.errorSummary=summary;return this;},getErrorDescription:function(){return this.errorDescription;},getErrorIsWarning:function(){return this.errorIsWarning;},logError:function(category,extra){if(window.send_error_signal){var data={err_code:this.error,vip:(env_get('vip')||'-')};if(extra!==undefined){data.duration=extra.duration;data.xfb_ip=extra.xfb_ip;}var path=this.request.getURI();data.path=path||'-';data.aid=this.request.userActionID;if(path&&path.indexOf('scribe_endpoint.php')!=-1)category='async_error_double';send_error_signal(category,JSON.stringify(data));}},logErrorByGroup:function(suffix,log_rate){if(Math.floor(Math.random()*log_rate)==0)if(this.error==1357010||this.error<15000){this.logError('async_error_oops_'+suffix);}else this.logError('async_error_logic_'+suffix);}});global.AsyncRequest=module.exports=AsyncRequest;global.AsyncResponse=AsyncResponse;},3);
add_properties('Input',{getSelection:function(b){if(!document.selection)return {start:b.selectionStart,end:b.selectionEnd};var d=document.selection.createRange();if(d.parentElement()!==b)return {start:0,end:0};var c=b.value.length;if(b.tagName=='INPUT'){return {start:-d.moveStart('character',-c),end:-d.moveEnd('character',-c)};}else{var e=d.duplicate();e.moveToElementText(b);e.setEndPoint('StartToEnd',d);var a=c-e.text.length;e.setEndPoint('StartToStart',d);return {start:c-e.text.length,end:a};}},setSelection:function(d,f,c){if(typeof c=='undefined')c=f;if(document.selection){if(d.tagName=='TEXTAREA'){var a=(d.value.slice(0,f).match(/\r/g)||[]).length;var b=(d.value.slice(f,c).match(/\r/g)||[]).length;f-=a;c-=a+b;}var e=d.createTextRange();e.collapse(true);e.moveStart('character',f);e.moveEnd('character',c-f);e.select();}else{d.selectionStart=f;d.selectionEnd=Math.min(c,d.value.length);Input.focus(d);}}});
function IntlTranslationBase(e,j,k,i,c,h,f,g){this.isRightToLeft=e;this.textarea=j;this.native_string=f;this.native_type=g;this.previewDiv=i;this.previewParagraph=null;this.segmentPrev=ge('intl_segment_prev:'+h);if(this.segmentPrev){this.segmentNext=ge('intl_segment_next:'+h);Event.listen(this.segmentPrev,'click',this.prevSegment.bind(this));Event.listen(this.segmentNext,'click',this.nextSegment.bind(this));this.segmentInsert=ge('intl_segment_insert:'+h);Event.listen(this.segmentInsert,'click',this.insertSegment.bind(this));}this.segmentNumber=0;this.segmentCount=0;this.segmentsInserted=[];this.child_markup=[];if(i){this.child_markup=DOM.scry(i,'p');this.previewParagraph=this.child_markup[0];}this.anchors=[];this.glossaryAnchors=[];this.anchor_states=[];this.tokens=[];this.glossary=[];if(k){var a=k.getElementsByTagName('a');for(var d=0;d<a.length;d++){this.anchors.push(a[d]);Event.listen(a[d],'click',this.insertToken.bind(a[d],this));this.anchor_states.push(false);}}if(c){var a=c.getElementsByTagName('a');for(var d=0;d<a.length;d++){this.glossaryAnchors.push(a[d]);Event.listen(a[d],'click',this.insertGlossaryTerm.bind(a[d],this));}}if(j){Event.listen(j,'keyup',this.refreshTokens.bind(this));if(i){var b=Event.listen(j,'keyup',this.refreshPreview.bind(this));DataStore.set(j,'keyupEventRef',b);}if(e)Event.listen(j,'keydown',this.checkRtlBackspace.bind(this));}}copy_properties(IntlTranslationBase.prototype,{setTranslationText:function(a){this.textarea.value=a;this.refreshTokens();this.refreshPreview();if(!this.textarea._hascontrol){this.textarea._hascontrol=true;new TextAreaControl(this.textarea).setAutogrow(true);}},insertToken:function(e){if(e.textarea){var a=e._getAnchorIndex(this),c=e.textarea,b=Input.getSelection(e.textarea).end,d=e.tokens[a];if(e.isRightToLeft)d='\u200e'+d.replace(/ /g,'\u00a0').replace(/-/g,'\u2011')+'\u200e\u200f';c.value=c.value.substring(0,b)+d+c.value.substring(b);c.focus();b+=d.length;Input.setSelection(c,b,b);e.anchor_states[a]=true;hide(this);e.refreshPreview();}return false;},insertGlossaryTerm:function(e){if(e.textarea){var a=e._getGlossaryAnchorIndex(this),d=e.textarea,b=Input.getSelection(e.textarea).end,c=e.glossary[a];if(e.isRightToLeft)c='\u200e'+c.replace(/ /g,'\u00a0').replace(/-/g,'\u2011')+'\u200e\u200f';d.value=d.value.substring(0,b)+c+d.value.substring(b);d.focus();b+=c.length;Input.setSelection(d,b,b);e.refreshPreview();}return false;},loadSegment:function(a){if(this.segmentCount==0){var b=true;for(this.segmentCount=1;b;this.segmentCount+=1){b=ge('intl_segment_text:'+this.segmentCount);this.segmentsInserted.push(false);if(b){hide(b);}else break;}}else{if(a>=this.segmentCount||a<0)return false;hide($('intl_segment_text:'+this.segmentNumber));}this.segmentNumber=a;show($('intl_segment_text:'+this.segmentNumber));if(this.segmentNumber>0){CSS.removeClass(this.segmentPrev,'intl-disabled');}else CSS.addClass(this.segmentPrev,'intl-disabled');if(this.segmentNumber<this.segmentCount-1){CSS.removeClass(this.segmentNext,'intl-disabled');}else CSS.addClass(this.segmentNext,'intl-disabled');if(this.canInsert()){CSS.removeClass(this.segmentInsert,'intl-disabled');}else CSS.addClass(this.segmentInsert,'intl-disabled');return false;},prevSegment:function(){return this.loadSegment(this.segmentNumber-1);},nextSegment:function(){return this.loadSegment(this.segmentNumber+1);},canInsert:function(){var a=ge('intl_segment_text:'+this.segmentNumber);return (a&&this.segmentsInserted[this.segmentNumber]==false&&!CSS.hasClass(a.childNodes[0],'intl-translatable')&&!CSS.hasClass(a.childNodes[0],'intl-approvable'));},insertSegment:function(){if(this.canInsert()&&(this.textarea)){var a=ge('intl_segment_text:'+this.segmentNumber);var b=$('intl_segment_text:'+this.segmentNumber).innerHTML;var c=a.replace(/(<([^>]+)>)/gi,'');var d=this.textarea.value;if(intl_ends_in_punct(d))d+=' ';d+=c;this.setTranslationText(d);this.segmentsInserted[this.segmentNumber]=true;CSS.addClass(this.segmentInsert,'intl-disabled');}},refreshSegment:function(){if(this.segmentPrev)if(!this.canInsert()){CSS.addClass(this.segmentInsert,'intl-disabled');}else CSS.removeClass(this.segmentInsert,'intl-disabled');},_getAnchorIndex:function(a){for(var b=0;b<this.anchors.length;b++)if(this.anchors[b]==a)return b;return -1;},_getGlossaryAnchorIndex:function(a){for(var b=0;b<this.glossaryAnchors.length;b++)if(this.glossaryAnchors[b]==a)return b;return -1;},checkRtlBackspace:function(a){var b=Event.getKeyCode(a);var e=true;if(this.isRightToLeft&&b==8){var d=Input.getSelection(this.textarea);if(d.start==d.end&&d.end>1){var c={'\u200e':true,'\u200f':true};var f=d.end-1;var g=this.textarea.value;while(f>0&&(g.charAt(f) in c))f--;this.textarea.value=g.substr(0,f)+g.substr(d.end);Input.setSelection(this.textarea,f,f);$E(a).prevent();}}return true;},cleanseToken:function(a){return a.replace(/\u00a0/g,' ').replace(/\u2011/g,'-').replace(/\u200e/g,'').replace(/\u200f/g,'');},uncleanseToken:function(a){if(this.isRightToLeft)return '\u200e'+a.replace(/ /g,'\u00a0').replace(/-/g,'\u2011')+'\u200e\u200f';return a;},refreshPreview:function(){if(this.previewDiv){(this.textarea.value.length==0?hide:show)(this.previewDiv);var d=this.textarea.value;for(var a=0;a<this.anchors.length;a++)if(this.anchor_states[a]){var c=/\{=([^}]+)\}/.exec(this.tokens[a]);if(c&&c.length>1){var b=this.child_markup[a+1].innerHTML;d=d.replace(this.uncleanseToken(this.tokens[a]),b);}}this.previewParagraph.innerHTML=d;}},activeTokensRegex:function(){return (/\{[^{}]+\}/g);},refreshTokens:function(){if(this.textarea){var a=this.activeTokensRegex(),j=null,m={};for(var d=0;d<this.tokens.length;d++)m[this.tokens[d]]=false;while(j=a.exec(this.textarea.value)){var l=this.cleanseToken(j[0]);var k=l.split(' # ',2);if(k.length>1)k[0]+="}";m[k[0]]=true;}for(var d=0;d<this.anchors.length;d++)if(m[this.tokens[d]]!=this.anchor_states[d]){this.anchor_states[d]=!this.anchor_states[d];(this.anchor_states[d]?hide:show)(this.anchors[d]);}if(this.isRightToLeft&&this.textarea.value.length>0){var f='';var h=Input.getSelection(this.textarea).end;var c=this.textarea.value.substr(0,h);var b=this.textarea.value.substr(h);var i=function(n){return n.replace(/\}(?!\u200e\u200f)/g,'}\u200e\u200f').replace(/(?!\u200e)\{/g,'\u200e{');};c=i(c);var f=c+i(b);var e=c.length;if(f.match(/\{[^}]*[- ]/))do{var g=f;f=f.replace(/(\{[^}]*) /g,'$1\u00a0').replace(/(\{[^}]*)-/g,'$1\u2011');}while(g!=f);if(f!=this.textarea.value){this.textarea.value=f;Input.setSelection(this.textarea,e,e);}}}return true;}});function intlXdAsync(d,a,c,b){var e=new AsyncRequest().setURI(d).setData(a).setHandler(b).setMethod(c);if(c=='GET')e.setReadOnly(true);e.send();}function intl_is_facebook_app_id(a){if(a==1)return true;return false;}
function ContextualDialog(b){var a=new Dialog();copy_properties(a,ContextualDialog.prototype);a._buildDialog();a._setFromModel(b);return a;}ContextualDialog.prototype={setContext:function(a){this._context=a;this.resetDialogPosition();return this;},_buildDialogContainer:function(){CSS.addClass(this._obj,'contextual_dialog');this._content=this._frame=$N('div',{className:'contextual_dialog_content'});this._arrow=$N('div',{className:'arrow'});DOM.setContent(this._popup,[this._content,this._arrow]);},_resetDialogObj:function(){if(!this._context||!this._showing)return;var g=Vector2.getElementPosition(this._context);var k=this._context.offsetWidth,h=this._context.offsetHeight;var l=g.x,m=g.y+h;var i=Vector2.getViewportDimensions().x;var j=Vector2.getScrollPosition().x;var e=Vector2.getDocumentDimensions().x;var d=Vector2.getElementDimensions(this._popup).x;var f=0;var c;if(k<64){c=l+k/2;}else c=l+32;if(e>0&&e<d){f=-l;}else{if(i>0&&l+d>j+i){f=(j+i-d)-l;if(l+f<j)f=j-l;}if(e>0&&l+d>e)f=(e-d)-l;}l+=f;if(c-l<32){l=c-32;if(l<0)l=0;}var b=Vector2.getElementDimensions(this._arrow).x;var a=c-l-b/2;if(a<0)a=0;if(a>d-32)a=d-32;CSS.setStyle(this._arrow,'marginLeft',a+'px');new Vector2(l,m,'document').setElementPosition(this._popup);},_renderDialog:function(a){if(window!=top)this._auto_focus=false;Dialog.prototype._renderDialog.call(this,a);}};
function BorderlessDialog(a){this._dialog=new Dialog(a);this._dialog._auto_focus=false;this._dialog._buildDialogContent=BorderlessDialog._buildDialogContent;this._dialog._resetDialogObj=BorderlessDialog._resetDialogObj;}BorderlessDialog.prototype={setContext:function(a){this._context=a;this._dialog._dirty();return this;},getDialog:function(){return this._dialog;}};copy_properties(BorderlessDialog,{_buildDialogContent:function(){CSS.addClass(this._obj,'borderless_dialog');DOM.setContent(this._popup,HTML('<div class="borderless_dialog_content"></div>'));this._content=this._frame=DOM.find(this._popup,'div.borderless_dialog_content');},_resetDialogObj:function(){if(!this._context)return;var c=Vector2.getElementPosition(this._context);var b=document.body.offsetWidth;var a=(b-this._popup.offsetWidth)/2;var d;if(c.x<b/2){d=Math.min(a,c.x+this._context.offsetWidth);}else d=Math.max(a,c.x-this._popup.offsetWidth);d=d||0;new Vector2(d,c.y+this._context.offsetHeight,'document').setElementPosition(this._popup);}});
function RegisterShortLongClick(b,a,d,c){this.multi_approve_start_time=0;this.multi_approve_timer=false;this.multi_approve_click_hold_duration=a;this.submit_short_click=d;this.submit_long_click=c;Event.listen(b,'click',bind(this,this.perform_onclick));Event.listen(b,'mousedown',bind(this,this.multi_approve_start_timer));}RegisterShortLongClick.prototype.perform_onclick=function(){if(this.multi_approve_timer){cur_time=new Date().getTime();duration=cur_time-this.multi_approve_start_time;if(duration<this.multi_approve_click_hold_duration){window.clearTimeout(this.multi_approve_timer);this.multi_approve_timer=false;this.submit_short_click();}}else this.submit_short_click();};RegisterShortLongClick.prototype.multi_approve_start_timer=function(){this.multi_approve_start_time=new Date().getTime();this.multi_approve_timer=window.setTimeout(this.submit_long_click,this.multi_approve_click_hold_duration);};function do_multi_locale_approve(c,a,b,f,d,g){var e=function(){if(g!=null)g();_multi_locale_approve(c,a,b,f,d);};_show_multi_locale_approve(c,a,b,f,e);}function _show_multi_locale_approve(d,a,c,h,f){var g=350;if(c.length==1){if(trim(h[0])=='')return;g=700;}var e=function(i){var l=_tx("Do you want to approve this translation to the following related locale(s) too?");var k=i.getPayload();if(!k.html)return;var j=new Dialog({contentWidth:g});j.setTitle(l).setBody(k.html).setButtons([Dialog.SAVE,Dialog.CANCEL]).setHandler(f).show();};var b=new AsyncRequest();b.setURI('/ajax/intl/show_multi_locale_approve.php').setData({oid:a,aloc:d,hashes:c,trs:h}).setPreBootloadHandler(bind(this,e)).setMethod('GET').setReadOnly(true).send();}function _multi_locale_approve(h,a,f,l,i){var e=$('multi_locale_approve_form');var c=DOM.scry(e,'.family_locale');var d=[];for(var g=0;g<c.length;g++)if(!c[g].disabled&&c[g].checked)d.push(c[g].value);var j=true;var k=ge('overwrite');if(k)j=k.checked;var b=new AsyncRequest();b.setURI('/ajax/intl/do_translate_approve.php').setData({trs:l,hashes:f,aloc:h,app_id:a,family_locales:d,overwrite:j}).setHandler(bind(this,i)).send();}
function intl_translation_init(){Event.listen(document.body,'mousedown',intl_translation_onmousedown);}function intl_get_translatable_parent(a){while(a.parentNode){if(CSS.hasClass(a,'intl-translatable')||CSS.hasClass(a,'intl-contributed')||CSS.hasClass(a,'intl-translated')||CSS.hasClass(a,'intl-approved')||CSS.hasClass(a,'intl-approvable')||CSS.hasClass(a,'intl-autoapproved')||CSS.hasClass(a,'intl-iapproved')||CSS.hasClass(a,'intl-complained')||CSS.hasClass(a,'intl-complainable')||CSS.hasClass(a,'intl-unvotable')||CSS.hasClass(a,'intl-votable')||CSS.hasClass(a,'intl-prototype-translatable')||CSS.hasClass(a,'intl-prototype-contributed')||CSS.hasClass(a,'intl-prototype-translated')||CSS.hasClass(a,'intl-prototype-approved')||CSS.hasClass(a,'intl-prototype-approvable')||CSS.hasClass(a,'intl-prototype-autoapproved')||CSS.hasClass(a,'intl-prototype-iapproved')||CSS.hasClass(a,'intl-prototype-complained')||CSS.hasClass(a,'intl-prototype-complainable')||CSS.hasClass(a,'intl-prototype-unvotable')||CSS.hasClass(a,'intl-prototype-votable'))return a;a=a.parentNode;}return null;}function intl_get_walkthrough_parent(a){while(a.parentNode){if(CSS.hasClass(a,'translations_walkthrough'))return a;a=a.parentNode;}return null;}function intl_translation_onmousedown_real(f){if(!f)return;var b=null,d=null,c=null;var a=f.getAttribute('id').replace(/__/g,':').split(':');d=f.className;b=a[1];c=a[2];hashcount=a[3];app=a[4];tr_id=a[5];var e={text:f.getAttribute('native_text'),suffix:f.getAttribute('native_suffix')};var h=intl_get_walkthrough_parent(f);var g=null;if(h)if(CSS.hasClass(h,'voting_walkthrough'))g='voting_walkthrough';intl_show_dialog(f,d,b,c,app,tr_id,true,null,e,g);return;}function intl_translation_onmousedown(a){var b=$E(a).getTarget();b=intl_get_translatable_parent(b);if(!intl_is_left_click(a)&&b){b.oncontextmenu=function(){return false;};intl_translation_onmousedown_real(b);}}function intl_is_left_click(a){if(a.which==null){if(a.button<2&&!a.ctrlKey)return true;}else if(a.which<2&&!a.ctrlKey)return true;return false;}function intl_show_dialog(e,b,h,j,a,m,i,c,k,n){var g='';var d=false;var f;if(c){f=new BorderlessDialog().setContext(e).getDialog();}else f=new ContextualDialog().setContext(e);if(b=='intl-votable'){f.setClassName('intl_vmode_dialog').setStackable(true);}else f.setClassName('intl_translation_dialog');var l=function(o){var p=o.getPayload();f.setBody(p.html).show();if(b!='intl-votable'&&ge('intl_ajax:'+p.native_id)){window.translation_dialog=new intl_translation_dialog(p['native'],p.tr_id,p.tokens,p.glossary_words,p.warning_rules,p.is_rtl,p.native_id,p.native_type);if(i)window.intl_inline_translation_dialog=f;}if(c){var r=ge('translation_background');var q=function(s){this.style.height=s.scrollHeight+'px';this.style.minHeight=s.scrollHeight+'px';};window.setInterval(bind(r,q,ge('intl-dialog-content-box')),100);}};if(b.indexOf('intl-prototype')!=-1){new AsyncRequest('/translations/inline/dialog.php').setData({code:b,hash:h,locale:j,appid:a,trid:m,walkthrough_info:n}).setRelativeTo(e).send();}else intlXdAsync('/ajax/intl/translation_dialog.php',{c:b,h:h,l:j,a:a,t:m,cancel_url:c,native_text:k?k.text:null,native_suffix:k?k.suffix:null,walkthrough_info:n},'GET',l);}function intl_show_variation_help(d,c,a){if(ge(d+':'+c).style.display=='none'){show(ge(d+':'+c));}else hide(ge(d+':'+c));for(var b=0;b<a.length;b++)if(d!=a[b])hide(ge(a[b]+':'+c));}function intl_show_highlight_schemes(){show(ge('highlight_schemes'));}function intl_hide_highlight_schemes(){hide(ge('highlight_schemes'));}function intl_set_sortby(b){var d=b.options[b.selectedIndex].value;var a=new String(document.location);a=a.replace(/&recent/g,"");a=a.replace(/&disputed/g,"");a=a.replace(/&popular/g,"");var c=a.split('&p=');if(c.length==2){goURI(c[0]+'&'+d+'&p='+c[1]);}else goURI(a+'&'+d);}function intl_set_app(c){var b=c.options[c.selectedIndex].value;URI.getRequestURI().addQueryData({app:b}).go();var a=document.getElementById('app_id_hidden_field');if(a)a.value=b;}function intl_quick_vote(b,c,d,e,a){intl_do_vote(b,c,d,e,a,'');intl_update_translations(b,c,a,d);return false;}function intl_vote_in_vote_mode(c,d,e,f,a){var b=Dialog.getCurrent();if(b)b.hide();intl_quick_vote(c,d,e,f,a);return false;}function intl_vote_mode_see_all(f,c,d,a,g){var b=Dialog.getCurrent();if(b){var e=b._context;intl_show_dialog(e,'intl-translatable',c,d,app,g,true);b.hide();}}function intl_do_vote(native_hash,locale,translation_id,vote,app_id,tr_ids){hide(ge('total_'+native_hash+'_'+translation_id));show(ge('voting_'+native_hash+'_'+translation_id));intl_update_vote_controls(native_hash,translation_id,vote);var do_vote=function(asyncResponse){var result=asyncResponse.getPayload();var native_hash=result.native_hash;var translation_id=result.translation_id;hide(ge('voting_'+native_hash+'_'+translation_id));if(result.vote==1&&tr_ids){var ids=eval(tr_ids);if(ids.length>1)for(var i=0;i<ids.length;i++)if(ge('voteup:'+native_hash+':'+ids[i]+':app_bulk')){var c_name=$('voteup:'+native_hash+':'+ids[i]+':app_bulk').className;if(c_name=='upselect'&&ids[i]!=translation_id)CSS.setClass($('voteup:'+native_hash+':'+ids[i]+':app_bulk'),'upover');}}};intlXdAsync('/ajax/intl/do_vote.php',{hash:native_hash,vote:vote,aloc:locale,translation_id:translation_id,app_id:app_id},'POST',do_vote);}function intl_delete_translation(e,d,b,a){var c=new AsyncRequest();c.setURI('/ajax/intl/delete_translations.php').setData({tr_ids:[d],aloc:a,app_id:b,translation:e,non_admin_mode:1}).setMethod('POST').send();}function intl_translation_dialog(e,i,h,a,g,c,d,f){this.parent.construct(this,c,ge('intl_translation:'+d),ge('intl_dialog_tokens:'+d),ge('intl_preview:'+d),ge('glossary'),d,e,f);this.form=ge('intl_ajax:'+d);if(this.textarea)Event.listen(this.textarea,'keyup',this.check_special_input.bind(this));this.shown_tr_id=i;this.tokens=h;this.glossary=a;this.rules=g;this.approved_trs=document.getElementsByName('approved_trs');for(var b=0;b<this.approved_trs.length;b++)Event.listen(this.approved_trs[b],'click',this.handle_approver_checkbox.bind(this,this.approved_trs[b]));if(this.form.intl_submit&&this.form.approved_tr_id){this.multi_approve=new RegisterShortLongClick(this.form.intl_submit,500,this.submit_click.bind(this),this.approve_submit_long_click.bind(this));}else if(this.form.intl_submit)this.form.intl_submit.onclick=this.submit_click.bind(this);if(this.form.copy_text)this.form.copy_text.onclick=this.setTranslationText.bind(this,e);if(this.form.intl_unfinalize)this.form.intl_unfinalize.onclick=this.submit_unfinalize.bind(this);if(this.form.intl_delete)this.form.intl_delete.onclick=this.submit_delete.bind(this);this.refreshTokens();this.refreshPreview();if(this.segmentPrev)this.loadSegment(0);}Class.extend(intl_translation_dialog,'IntlTranslationBase');intl_translation_dialog.prototype.check_special_input=function(a){var b=Event.getKeyCode(a);if(b==27)Dialog.getCurrent()&&Dialog.getCurrent().hide();};intl_translation_dialog.prototype.check_tokens=function(){for(var a=0;a<this.anchor_states.length;a++)if(!this.anchor_states[a])return false;return true;};intl_translation_dialog.prototype.check_additional_tokens=function(b,e){var d=/{.*?}/g;var f=e.match(d);if(!f)f=[];var c=b.match(d);if(!c)c=[];for(var a=0;a<f.length;a++)if(!this.in_array(this.cleanseToken(f[a]),c))return false;return true;};intl_translation_dialog.prototype.in_array=function(c,a){for(var b=0;b<a.length;b++)if(a[b]==c)return true;return false;};intl_translation_dialog.prototype.rule_markup=function(a,f){var e=/<\/?[a-zA-Z][^>]*>/g;var i=f.toLowerCase().match(e);var g=i?i.sort():[];var d=a.toLowerCase().match(e);var b=d?d.sort():[];var h=g.join(';');var c=b.join(';');if(h!=c)return _tx("HTML markup mismatch. The HTML markup you entered does not match the original markup.");};function intl_explode_inflection(e){var c=window.intl_locale_inflections;var b=[];if(c)for(var d in c){var a=c[d];if(a[a.length-1]==='+'){b[b.length]=intl_phonological_rules(a+e);}else if(a[0]==='+')b[b.length]=intl_phonological_rules(e+a);}return b;}intl_translation_dialog.prototype.rule_canon=function(d,e){var f=e.toLowerCase();if(this.glossary)for(var b=0;b<this.glossary.length;b++)if(f.indexOf(this.glossary[b].toLowerCase())==-1){var a=false;for(var c in intl_explode_inflection(this.glossary[b].toLowerCase()))if(f.indexOf(c)!=-1)a=true;if(!a)return _tx("Recommended glossary translations not used.");}};intl_translation_dialog.prototype.rule_punctuation=function(b,d){var c=[',','.','?','!',';',':'];for(var a=0;a<c.length;a++)if(substr_count(b,c[a])!=substr_count(d,c[a]))return _tx("Punctuation mismatch. Did you forget a period or other punctuation?");};intl_translation_dialog.prototype.rule_punctuation_asian=function(c,e){var d={'?':"\uFF1F",'.':"\u3002",'!':"\uFF01",':':"\uFF1A"};var a=c.substr(c.length-1);var b=d[a];if(b&&e.substr(e.length-1)!=a&&e.substr(e.length-1)!=b)return _tx("Punctuation mismatch. Did you forget a period or other punctuation?");};intl_translation_dialog.prototype.rule_punctuation_tr=function(c,d){var a=['?','!',';',':'];for(var b=0;b<a.length;b++)if(substr_count(c,a[b])!=substr_count(d,a[b]))return _tx("Punctuation mismatch. Did you forget a period or other punctuation?");if(substr_count(c,'.')+substr_count(c,',')!=substr_count(d,'.')+substr_count(d,','))return _tx("Punctuation mismatch. Did you forget a period or comma?");};intl_translation_dialog.prototype.rule_punctuation_ar=function(d,e){var b=[',','.','!',';',':'];for(var c=0;c<b.length;c++)if(substr_count(d,b[c])!=substr_count(e,b[c]))return _tx("Punctuation mismatch. Did you forget a period or other punctuation?");var a="\u061F";if(substr_count(d,'?')!=substr_count(e,'?')+substr_count(e,a))return _tx("Punctuation mismatch. Did you forget a question mark?");};intl_translation_dialog.prototype.rule_capitalization=function(a,b){if(((a.substring(0,1).toLowerCase()!=a.substring(0,1))!=(b.substring(0,1).toLowerCase()!=b.substring(0,1)))&&(a.substring(0,1)+b.substring(0,1)).indexOf('{')==-1)return _tx("Punctuation mismatch. Did you forget a period or comma?");};intl_translation_dialog.prototype.rule_token_spacing=function(a,d){var c=/(?: |\b|^)\{[^}]+\}(?: |\b|$)/g,b;d=this.cleanseToken(d);while(b=c.exec(a)){b[0]=this.cleanseToken(b[0]);if(d.indexOf(b[0])==-1)return _tx("Spacing mismatch. Please make sure the spacing around tokens in {}'s matches.");}};intl_translation_dialog.prototype.check_warnings=function(b,c){var e=[];for(var a=0;a<this.rules.length;a++){var d=this['rule_'+this.rules[a]](b,c);if(d)e.push(d);}var d=this.rule_markup(b,c);if(d)e.push(d);return e.length?e:null;};intl_translation_dialog.prototype.translation_submit=function(){var c=this.form;var l=this.textarea.id;var k=this.cleanseToken(this.textarea.value);var d=c.hash.value;var i=c.reportable.value;var j;var g;var m;var f;var a=null;var n=true;var b=null;var h=function(o){var z=o.getPayload();j=z.status;m=z.tr_ids;g=z.new_tr_id;d=z.hash;f=z.locale;k=z.new_tr;cancel_url=z.cancel_url;if(cancel_url){var w=cancel_url.replace("xxRESULTTOKENxx",k);goURI(w);}if(j=='exists'||j=='exists-self'){var p=(j=='exists-self')?_tx("Sorry! You already submitted the same translation."):_tx("Sorry! Someone else has already submitted the same translation.");var t=new Dialog().setTitle(_tx("Duplicate Translation")).setBody(p).setButtons([Dialog.newButton('edit-translation',_tx("Edit Translation"),'',function(){t.hide();})]);t.show();}else if(j=='not-utf8'){new Dialog().setTitle(_tx("Unsupported Encoding")).setBody(_tx("Your web browser appears to be set to send data to Facebook in a format our servers don't understand. Please set your browser to use UTF-8 (Unicode). In most browsers this is in a menu item called \"Encoding\" or \"Character Encoding\" or \"Text Encoding\", most often under the \"View\" menu.")).setButtons([Dialog.OK]).show();}else if(j=='empty'){new Dialog().setTitle(_tx("No Translation Provided")).setBody(_tx("Oops! Looks like you didn't type in a translation.")).setButtons([Dialog.OK]).show();}else if(j!='ok'){setTimeout(function(){document.location.reload();},250);}else{intl_update_translations(d,c.loc.value,c.app.value,c.tr_id.value,k,g);Dialog.getCurrent()&&Dialog.getCurrent().hide();if(window.intl_inline_translation_dialog){intl_inline_translation_dialog.hide();if(c.cmode_flag)new Dialog().setTitle(_tx("Thank you.")).setBody(_tx("Your feedback will be reviewed shortly.")).setButtons([Dialog.OK]).show();}else{var s=z.deleted_tr_ids;for(var u=0;u<s.length;u++)hide(ge('tr_'+s[u]));if(ge('mine_'+d))hide($('mine_'+d));show($('inline_'+d));if(ge('tlink_'+d))$('tlink_'+d).innerHTML='&nbsp;';$('entered_'+d).innerHTML=k;}var r=l.substr(l.indexOf(':')+1);var q=ge('intl_preview_child:'+r);if(q!=null){var y=q.parentNode.id;if(q.hasChildNodes()){q=q.firstChild;q.className='intl-contributed';}q.innerHTML=k;var x=y.substr(y.indexOf(':')+1);var za=ge('intl_translation:'+x);var v=DataStore.get(za,'keyupEventRef');if(v)v.fire(za,'keyup');}}};var e=new String(document.location);if(getCookie('appmode')==1)a='1';if(c.approved_tr_id&&c.approved_tr_id.value!='')b=c.approved_tr_id.value;intlXdAsync('/ajax/intl/do_translation.php',{hash:d,translation:k,aloc:c.loc.value,charset_test:c.charset_test.value,post_form_id:'1',approved_tr_id:b,reportable:i,app_id:c.app.value,shown_tr_id:this.shown_tr_id,cancel_url:c.cancel_url.value,cmode_desc:c.cmode_desc?c.cmode_desc.value:null,cmode_flag:c.cmode_flag?c.cmode_flag.value:null},'POST',h);return j;};intl_translation_dialog.prototype.submit_unfinalize=function(){var a=null;var b=new String(document.location);if(getCookie('appmode')==1)a='1';intlXdAsync('/ajax/intl/do_unapprove.php',{hash:this.form.hash.value,app_id:this.form.app.value,post_form_id:'1',approve_mode:a,aloc:this.form.loc.value},'POST',function(){document.location.reload();});};intl_translation_dialog.prototype.submit_delete=function(){intlXdAsync('/ajax/intl/delete_translations.php',{hashes:[this.form.hash.value],aloc:this.form.loc.value,app_id:this.form.app.value,translation:this.cleanseToken(this.textarea.value),non_admin_mode:1},'POST',function(){document.location.reload();});};intl_translation_dialog.prototype.submit_click=function(){var j,m;var k;var i=this.form;var d=false;var l=true;if(i.approved_tr_id)d=true;var g=i.cancel_url;var a=64;var c=4096;var b=8192;if((i.cmode_flag&&(i.cmode_flag.value&(a+c+b)))||g!=null)l=false;if(i.cmode_flag&&i.cmode_flag.value==0){if(i.reportable&&i.reportable.value==1){new Dialog().setTitle(_tx("No reason given")).setBody(_tx("Oops! You need to provide a reason for reporting a phrase.")).setButtons([Dialog.OK]).show();}else new Dialog().setTitle(_tx("No reason given")).setBody(_tx("Oops! You need to provide a reason for reporting a translation.")).setButtons([Dialog.OK]).show();}else if(l&&!this.check_tokens()){if(i.reportable&&i.reportable.value==0)new Dialog().setTitle(_tx("Unused Tokens")).setBody(_tx("You did not use all the tokens while translating this string. Please make sure you maintain all text in curly braces (e.g. {{example}}) in the translation.")).setButtons([Dialog.OK]).show();}else if(l&&!this.check_additional_tokens(this.native_string,this.textarea.value)){if(i.reportable&&i.reportable.value==0)new Dialog().setTitle(_tx("Extra Tokens")).setBody(_tx("The translation you provided has additional tokens not present in the original text. Please make sure you do not type in anything in curly braces that is not part of the original text.")).setButtons([Dialog.OK]).show();}else if(i.reportable&&i.reportable.value==0&&l&&(m=this.check_warnings(this.native_string,this.textarea.value))&&(d==false)){var e=(m.length==1)?_tx("There may be a problem with your translation! The translation you provided failed the following style check:"):_tx("There may be a problem with your translation! The translation you provided failed the following style checks:");var f=(m.length==1)?_tx("It's ok to ignore this warning if it makes sense given the context of the phrase, but please make sure that this is the case."):_tx("It's ok to ignore these warnings if they make sense given the context of the phrase, but please make sure that this is the case.");var h=new Dialog().setTitle(_tx("Translation Warning")).setBody(e+'<br/><ul><li>'+m.join('</li><li>')+'</li></ul><br />'+f).setButtons([Dialog.newButton('submit-translation',_tx("Submit Translation"),'',function(){h.hide();this.translation_submit();}.bind(this)),Dialog.newButton('review-translation',_tx("Review Translation"))]).show();}else this.translation_submit();};intl_translation_dialog.prototype.handle_approver_checkbox=function(a){var b=DOM.getText(ge('tr_id_'+a.value));if(a.checked==false){this.textarea.value='';}else this.textarea.value=b;if(this.form.approved_tr_id)this.form.approved_tr_id.value=a.value;this.refreshTokens();this.refreshPreview();};function substr_count(b,c){var a=0,d=b.indexOf(c);while(d!=-1){a++;d=b.indexOf(c,d+1);}return a;}function intl_amode_reset_tr_checkbox(d){var a=document.getElementsByName('approved_trs');if(a.length)for(var c=0;c<a.length;c++)a[c].checked=false;var b='intl_ajax:'+d;if(ge(b).approved_tr_id)ge(b).approved_tr_id.value='';}function intl_show_extras(a){var b=ge('intl_extra_phrases');if(b)if(a==false){b.style.display='block';animation(document.body).to('scrollTop',elementY(b)).ease(animation.ease.end).go();}else b.style.display='none';}function intl_use_translation(c,d){if(c){var b='intl_translation';if(d!=0)b+=':'+d;var a=ge(b);if(a){a.value=c;window.translation_dialog.refreshTokens();window.translation_dialog.refreshPreview();window.translation_dialog.refreshSegment();}}return false;}function intl_toggle_vote_dialog(c,e){var b=ge(c);var d=ge(e);if(!b||!d)return;var a='link_vote_more_active';if(CSS.hasClass(b,a)){hide(d);CSS.removeClass(b,a);}else{d.style.display='block';CSS.addClass(b,a);}}function intl_toggle_variation_table(){if(ge('intl_no_variation').style.display=='none'){show(ge('intl_no_variation'));hide(ge('intl_with_variation'));}else{hide(ge('intl_no_variation'));show(ge('intl_with_variation'));}}function intl_admin_browse_onclick(a){if(a.value=='secret'){show(ge('secret_select'));}else hide(ge('secret_select'));}function intl_admin_browse_secret_onclick(a){goURI('/translations/admin/browse.php?vtype=secret&stype='+a.value);}function show_all_approve_table(){var a=$('approve_table').getElementsByTagName("tr");if(a.length>1)for(var b=0;b<a.length;b++)if(!shown(a[b]))show(a[b]);}function approve_swap(c){var a=$('approve_table').getElementsByTagName("tr");if(a.length>1)for(var b=0;b<a.length;b++)if(CSS.hasClass(a[b],'approved_row'))CSS.removeClass(a[b],'approved_row');CSS.addClass($('row_id_'+c),'approved_row');}function check_impossible(a){if(a.value=='64'||a.value=='4096'||a.value=='8192'){show($('impossible_form'));hide($('intl_render_dialog_text_area'));hide($('complain_desc'));if(ge('native_string_tokens'))hide($('native_string_tokens'));if(ge('native_string_token_deps'))hide($('native_string_token_deps'));if(ge('intl_with_variation'))hide($('intl_with_variation'));if(ge('glossary'))hide($('glossary'));}else{hide($('impossible_form'));show($('intl_render_dialog_text_area'));show($('complain_desc'));if(ge('native_string_tokens'))show($('native_string_tokens'));if(ge('native_string_token_deps'))show($('native_string_token_deps'));if(ge('intl_no_variation'))show($('intl_no_variation'));if(ge('glossary'))show($('glossary'));if(ge('intl_with_variation'))hide($('intl_with_variation'));}}function intl_submit_variations(c){var b=$('record_variations_form:'+c);var g={hash:c,aloc:b.locale.value,app_id:b.app_id.value,inline:false};var a=b.getElementsByTagName('INPUT');for(var d=0;d<a.length;d++)if(a[d].type=='checkbox'&&a[d].checked){var e=a[d].id.substring(0,a[d].id.length-2).replace(/\-/g,'_');if(!g[e])g[e]=0;g[e]+=Number(a[d].value);}var f=function(h){var i=h.getPayload();goURI(i.redirect_url);};intlXdAsync('/ajax/intl/record_variations.php',g,'POST',bind(this,f));}function intl_need_review_onchange(){var a=ge('review_form');a.submit();}function intl_decode_attr_value(a){return decodeURIComponent(a.replace(/_/g,'%'));}function intl_update_translations(c,g,a,m,h,i){if(h){attribute_tokens_regex=/({[^}]*) #[^}]*}/g;h=h.replace(attribute_tokens_regex,'$1}');}m=(m===0)?'':m;for(var e=1;e<1000;e++){var f=c+'__'+g+'__'+e+'__'+a+'__'+m;var b=ge('trans__'+f);if(!b)if(e<5){continue;}else break;if(h){var l={};if(b.getAttribute('tokens'))l=JSON.parse(intl_decode_attr_value(b.getAttribute('tokens')));if(window.intl_replaced_trans){for(var n in window.intl_replaced_trans){var d=new RegExp('(<em[^>]+id=trans__'+n+' [^>]*>).*(</em>)');var j=window.intl_replaced_trans[n];for(var k in l){var o=l[k];if(typeof(o)=='string')l[k]=o.replace(d,'$1'+j+'$2');}}}else window.intl_replaced_trans={};b.innerHTML=_tx(h,l);window.intl_replaced_trans[c+'__'+g+'__\\d+__'+a+'__'+m]=h;if(i)b.id='trans__'+c+'__'+g+'__'+e+'__'+a+'__'+i;}if(CSS.hasClass(b,'intl-translatable')){CSS.addClass(b,'intl-contributed');CSS.removeClass(b,'intl-translatable');}else if(CSS.hasClass(b,'intl-approvable')){CSS.removeClass(b,'intl-approvable');CSS.addClass(b,'intl-iapproved');}else if(CSS.hasClass(b,'intl-votable')||CSS.hasClass(b,'intl-unvotable')){CSS.removeClass(b,'intl-votable');CSS.removeClass(b,'intl-unvotable');CSS.addClass(b,'intl-voted');}else if(CSS.hasClass(b,'intl-complainable')){CSS.removeClass(b,'intl-complainable');CSS.addClass(b,"intl-complained");}}}function intl_update_vote_controls(d,f,k){var g=['vmode_dialog','vmode_bulk','app_bulk'];for(var e=0;e<g.length;e++){var i='voteup:'+d+':'+f+':'+g[e];var h=ge(i);var b='votedown:'+d+':'+f+':'+g[e];var a=ge(b);if(!h||!a)continue;var j=h.className;var c=a.className;if((j=='upselect'&&k==-1)||(c=='downselect'&&k==1)){CSS.setClass(h,'upover');CSS.setClass(a,'downover');}else if(k==1){CSS.setClass(h,'upselect');CSS.setClass(a,'downover');}else{CSS.setClass(h,'upover');CSS.setClass(a,'downselect');}}}function intl_set_user_blacklist(a,d,f,e,b){if(b){new Dialog().setTitle(_tx("Ban user from Translation Application")).setBody(_tx("Are you sure you want to ban this user from using the Translation Application? Doing so will disallow the user from submitting new translations and votes for your application.")).setButtons([{name:'yes',label:_tx("Yes"),handler:bind(this,c,a,d,f,true)},{name:'no',label:_tx("No")}]).show();}else new Dialog().setTitle(_tx("Remove user from Translation Application blacklist")).setBody(_tx("Are you sure you want to remove this user from Translation Application blacklist? Doing so will re-enable the user to submit translations and votes for your application.")).setButtons([{name:'yes',label:_tx("Yes"),handler:bind(this,c,a,d,f,false)},{name:'no',label:_tx("No")}]).show();function c(g,h,j,k){var i=function(l){var m=l.getPayload();if(m.status=='ok')if(m.blacklist){show($('unblacklist:'+e));hide($('blacklist:'+e));}else{show($('blacklist:'+e));hide($('unblacklist:'+e));}};intlXdAsync('/ajax/intl/set_user_blacklist.php',{app_id:g,aloc:h,user_id:j,blacklist:k},'POST',i);}}function intl_native_diff(f,b,c,a,d){var e=function(g){var h=g.getPayload();new ContextualDialog().setContext(ge(f)).setTitle(_tx("Differences in source string")).setBody(h.body).setButtons(Dialog.OK).show();};intlXdAsync('/ajax/intl/native_diff.php',{app_id:a,aloc:d,hash_a:b,hash_b:c},'POST',e);}intl_translation_dialog.prototype.approve_submit_long_click=function(){var b=this.form;var c=b.hash.value;var d=b.loc.value;var a=b.app.value;var f=b.tr_id.value;var e=this.cleanseToken(this.textarea.value);if(trim(e)=='')return;do_multi_locale_approve(d,a,[c],[e],this.post_multi_locale_approve.bind(this,c,d,a,f,e),null);};intl_translation_dialog.prototype.post_multi_locale_approve=function(b,c,a,e,d){intl_update_translations(b,c,a,e,d);};
function UntrustedLink(a,d,b,c){this.dom=a;this.url=a.href;this.hash=d;this.func_get_params=c||function(){return {};};Event.listen(this.dom,'click',this.onclick.bind(this));Event.listen(this.dom,'mousedown',this.onmousedown.bind(this));Event.listen(this.dom,'mouseup',this.onmouseup.bind(this));Event.listen(this.dom,'mouseout',this.onmouseout.bind(this));this.onmousedown($E(b));}UntrustedLink.bootstrap=function(a,d,b,c){if(a.__untrusted)return;a.__untrusted=true;new UntrustedLink(a,d,b,c);};UntrustedLink.prototype.getRewrittenURI=function(){var a=copy_properties({u:this.url,h:this.hash},this.func_get_params(this.dom));var b=new URI('/l.php');return b.setQueryData(a).setSubdomain('www').setProtocol('http');};UntrustedLink.prototype.onclick=function(){(function(){this.dom.href=this.url;}).bind(this).defer(100);this.dom.href=this.getRewrittenURI();};UntrustedLink.prototype.onmousedown=function(a){if(a.button==2)this.dom.href=this.getRewrittenURI();};UntrustedLink.prototype.onmouseup=function(){this.dom.href=this.getRewrittenURI();};UntrustedLink.prototype.onmouseout=function(){this.dom.href=this.url;};
var LiveTimer={restart:function(a){this.serverTime=a;this.localStartTime=new Date().getTime()/1000;this.updateTimeStamps();},updateTimeStamps:function(){LiveTimer.timestamps=DOM.scry(document.body,'abbr.livetimestamp');LiveTimer.startLoop(20000);},addTimeStamps:function(a){if(!a||!LiveTimer.timestamps)return;if(DOM.isNodeOfType(a,'abbr')&&CSS.hasClass(a,'livetimestamp')){LiveTimer.timestamps.push(a);}else{var c=DOM.scry(a,'abbr.livetimestamp');for(var b=0;b<c.length;++b)LiveTimer.timestamps.push(c[b]);}LiveTimer.startLoop(0);},startLoop:function(a){this.stop();this.timeout=setTimeout(function(){LiveTimer.loop();},a);},stop:function(){clearTimeout(this.timeout);},updateNode:function(a,b){LiveTimer.updateNode=(ua.ie()<7)?function(c,d){c.nextSibling.nodeValue=d;}:function(c,d){c.firstChild.nodeValue=d;};LiveTimer.updateNode(a,b);},loop:function(d){if(d)LiveTimer.updateTimeStamps();var c=Math.floor(new Date().getTime()/1000-LiveTimer.localStartTime);var a=-1;LiveTimer.timestamps&&LiveTimer.timestamps.each(function(g){var f=+new Date(g.getAttribute('data-date'))/1000;var e=LiveTimer.renderRelativeTime(LiveTimer.serverTime+c,f);if(e.text)LiveTimer.updateNode(g,e.text);if(e.next!=-1&&(e.next<a||a==-1))a=e.next;});if(a!=-1){var b=Math.max(20000,a*1000);LiveTimer.timeout=setTimeout(function(){LiveTimer.loop();},b);}},renderRelativeTime:function(c,d){var e={text:"",next:-1};if(c-d>(12*3600)||(new Date(c*1000).getDay()!=new Date(d*1000).getDay()))return e;var f=c-d,b=Math.floor(f/60),a=Math.floor(b/60);if(b<1){e.text=_tx("A few seconds ago");e.next=60-f%60;return e;}if(a<1){if(b==1){e.text=_tx("about a minute ago");}else e.text=_tx("{number} minutes ago",{number:b});e.next=60-f%60;return e;}if(a!=11)e.next=3600-f%3600;if(a==1){e.text=_tx("about an hour ago");return e;}e.text=_tx("{number} hours ago",{number:a});return e;}};
WidgetArbiter={_findSiblings:function(){if(WidgetArbiter._siblings)return;WidgetArbiter._siblings=[];for(var b=parent.frames.length-1;b>=0;b--)try{if(parent.frames[b]&&parent.frames[b].Arbiter&&parent.frames[b].Arbiter.inform)WidgetArbiter._siblings.push(parent.frames[b].Arbiter);}catch(a){}},inform:function(){WidgetArbiter._findSiblings();var a=$A(arguments);WidgetArbiter._siblings.each(function(b){b.inform.apply(b,a);});}};
WindowComm={_callbacks:{},makeHandler:function(a,c){c=c||'opener';var b='f'+(Math.random()*(1<<30)).toString(16).replace('.','');WindowComm._callbacks[b]=a;return new URI('/connect/window_comm.php').setQueryData({_id:b,_relation:c}).getQualifiedURI().toString();},_recv:function(b){var a=new URI(b).getQueryData();WindowComm._callbacks[a._id](a);}};
var PopupResizer={_opts:{allowShrink:true,timeout:100},init:function(a){copy_properties(PopupResizer._opts,a);setInterval(PopupResizer._resizeCheck,PopupResizer._opts.timeout);},_resizeCheck:function(){var e=Vector2.getViewportDimensions(),a=PopupResizer._getDocumentSize(),c=a.y-e.y,d=a.x-e.x;if(d<0)d=0;if(!PopupResizer._opts.allowShrink&&c<0)c=0;if(c||d)try{window.resizeBy(d,c);if(d)window.moveBy(d/-2,0);}catch(b){}},_getDocumentSize:function(){var a={x:ua.firefox()?document.documentElement.scrollWidth:document.body.scrollWidth,y:document.body.scrollHeight};if(a.x<=0||a.x>document.documentElement.scrollWidth)a.x=document.documentElement.scrollWidth;if(a.y<=0||a.y>document.documentElement.scrollHeight)a.y=document.documentElement.scrollHeight;if(window.Dialog&&Dialog.max_bottom&&Dialog.max_bottom>a.y)a.y=Dialog.max_bottom;return a;},open:function(i,b,j){var f=typeof window.screenX!='undefined'?window.screenX:window.screenLeft,g=typeof window.screenY!='undefined'?window.screenY:window.screenTop,e=typeof window.outerWidth!='undefined'?window.outerWidth:document.body.clientWidth,d=typeof window.outerHeight!='undefined'?window.outerHeight:(document.body.clientHeight-22),c=parseInt(f+((e-j)/2),10),h=parseInt(g+((d-b)/2.5),10),a=('width='+j+',height='+b+',left='+c+',top='+h);return window.open(i,'_blank',a);}};
var PlatformOptInPopup=function(){};copy_properties(PlatformOptInPopup,{DIALOG_URL:'/connect/uiserver.php',DIALOG_WIDTH:420,DIALOG_HEIGHT:450,APP_ID:127760087237610,open:function(d,c,a){if(!d)d='generic';if(!c)c='opt.in';var b=new URI(PlatformOptInPopup.DIALOG_URL);b.addQueryData({social_plugin:d,method:c,display:'popup',secure:URI.getRequestURI().isSecure(),app_id:PlatformOptInPopup.APP_ID});if(a)b.addQueryData(a);return PopupResizer.open(b.toString(),PlatformOptInPopup.DIALOG_WIDTH,PlatformOptInPopup.DIALOG_HEIGHT);}});
function ConnectSocialWidget(a,b){ConnectSocialWidget.setInstance(b,this);ConnectSocialWidget.delayUntilDisplayed(function(){this.initializeObject.call(this,a,b);}.bind(this));}copy_properties(ConnectSocialWidget,{OPT_IN_FACEBOOK_APP_ID:'127760087237610',TYPE_ACTIVITY:'A',TYPE_RECOMMENDATIONS:'R',TYPE_LIKEBOX:'L',instances:{},setInstance:function(b,a){ConnectSocialWidget.instances[b]=a;},getInstance:function(a){return ConnectSocialWidget.instances[a];},popups:{},login:function(a,b){ConnectSocialWidget.popups[b]={popup:PlatformOptInPopup.open('login','opt.in')};},aDelayedFunctions:[],delayUntilDisplayed:function(a){ConnectSocialWidget.aDelayedFunctions.push(a);if(ConnectSocialWidget.aDelayedFunctions.length===1){if(!ConnectSocialWidget.ndTestDim){var b=document.createElement('div'),c={position:'absolute',width:'1px',height:'1px',overflow:'hidden',top:'0px'};for(var d in c)if(typeof c[d]==='string')CSS.setStyle(b,d,c[d]);document.body.appendChild(b);ConnectSocialWidget.ndTestDim=b;}ConnectSocialWidget.testForDisplay();}},testForDisplay:function(){var a=Vector2.getElementDimensions(ConnectSocialWidget.ndTestDim).y;if(a!==0){ConnectSocialWidget.aDelayedFunctions.forEach(function(b){b();});ConnectSocialWidget.aDelayedFunctions=[];}else ConnectSocialWidget.testForDisplay.defer(100);},listenForLogin:function(){if(!ConnectSocialWidget.listenerAttached){Arbiter.subscribe('platform/socialplugins/login',function(a){if(a.user!==Env.user)document.location.reload();});ConnectSocialWidget.listenerAttached=true;}}});copy_properties(ConnectSocialWidget.prototype,{initializeObject:function(e,g){var d=DOM.scry(document.body,e.sOverflowContainerSelector)[0],c=DOM.scry(d,'.fbConnectWidgetFooter')[0],a=c?Vector2.getElementDimensions(c).y:0,f=e.sOverflowItemsSelector,b=DOM.scry(document.body,e.sStreamContainerSelector)[0];this.fRemoveOverflowElements=this.removeOverflowElements.bind(this,d,b,f,-a);copy_properties(this,{bInitialized:true,sWidgetId:g,iFooterHeight:a,ndTop:d,ndFooter:c,ndContentContainer:b,oQueryParams:new URI(window.location.href).getQueryData(),bComboMode:e.bComboMode,sOverflowItemsSelector:f});copy_properties(this.oQueryParams,{post_form_id:Env.post_form_id,user:Env.user});this.fRemoveOverflowElements();CSS.setStyle(b,'visibility','visible');animation(b).from('opacity',0).to('opacity',1).duration(200).go();ConnectSocialWidget.listenForLogin();new ClickThroughMonitor({ndTop:this.ndContentContainer,fValidateLink:this.getElementTop.bind(this),fGetMonitorData:function(h){var i={site:this.oQueryParams.site,type:this.getLinkType(),plugin:this.getPluginType(),social:(DOM.scry(h,'^div.fbSocial').length>0),pos:this.getItemPosition(this.getElementTop(h)),signature:this.getItemSignature(this.getElementTop(h))};if(this.oQueryParams.api_key)i.api_key=this.oQueryParams.api_key;return i;}.bind(this)});},getElementTop:function(b){var a=DOM.scry(b,'^'+this.sOverflowItemsSelector);return a[0];},getItemPosition:function(d){var a=DOM.scry(this.ndContentContainer,this.sOverflowItemsSelector),c=a.length,b=a.indexOf(d)+1;return b+'/'+c;},getItemSignature:function(c){var a=c.className.split(' ');for(var b=0;b<a.length;b++)if(a[b].startsWith("RES_"))return a[b].substring(4);return '';},removeOverflowElements:function(h,g,i,d,e){var f,a=i?DOM.scry(g,i):$A(g.childNodes);if(!e){var d=d||0,b=Vector2.getElementDimensions(h).y+d,c=Vector2.getElementPosition(h).y;e=b+c;}while(a.length>0&&(f=$(a.pop()))&&(Vector2.getElementDimensions(f).y+Vector2.getElementPosition(f).y)>e)DOM.remove(f);},login:function(){ConnectSocialWidget.login(this.appID,this.sWidgetId);},toggleLogin:function(){DOM.scry(this.ndTop,'.fbToggleLogin').forEach(function(a){CSS.toggle(a);});this.fRemoveOverflowElements();}});function ActivityWidget(a,b){this.parent.construct(this,a,b);}Class.extend(ActivityWidget,'ConnectSocialWidget');ActivityWidget.REQUEST_INTERVAL=15*1000;ActivityWidget.ACTIVITY_HEIGHT=45;ActivityWidget.MAX_INTERVAL=30;ActivityWidget.MAX_ITEMS=24;copy_properties(ActivityWidget.prototype,{initializeObject:function(a,b){this.parent.initializeObject.call(this,a,b);this.oQueryParams.nb_activities=Math.min(ActivityWidget.MAX_ITEMS,Math.round((this.oQueryParams.height||300)/ActivityWidget.ACTIVITY_HEIGHT));this.oQueryParams.newest=a.iNewestStoryTime||0;},getLinkType:function(){return ConnectSocialWidget.TYPE_ACTIVITY;},getPluginType:function(){return ConnectSocialWidget.TYPE_ACTIVITY;},removeOverflowElements:function(){if(this.bComboMode&&!this.bFirstRound){this.bFirstRound=true;var d=Vector2.getElementPosition(this.ndTop).y,b=Vector2.getElementDimensions(document.body).y-(d+this.iFooterHeight),c=Math.round(b/2),a=$A(arguments);a[a.length]=c;ConnectSocialWidget.prototype.removeOverflowElements.apply(this,a);}else ConnectSocialWidget.prototype.removeOverflowElements.apply(this,arguments);},hasFriendsActivity:function(){return DOM.scry(this.ndContentContainer,'div.fbFriendsActivity')[0].childNodes.length>0;},hasContent:function(){return DOM.scry(this.ndTop,this.sOverflowItemsSelector).length>0;},getEmptyMessage:function(){return DOM.find(this.ndContentContainer,'div.fbEmptyWidget');},showEmptyMessage:function(){var a=this.getEmptyMessage();if(a)CSS.show(a);}});function RecommendationsWidget(a,b){this.parent.construct(this,a,b);}Class.extend(RecommendationsWidget,'ConnectSocialWidget');copy_properties(RecommendationsWidget.prototype,{getLinkType:function(){return ConnectSocialWidget.TYPE_RECOMMENDATIONS;},getPluginType:function(){return this.sActivityParent?ConnectSocialWidget.TYPE_ACTIVITY:ConnectSocialWidget.TYPE_RECOMMENDATIONS;},initializeObject:function(a,b){this.parent.initializeObject.call(this,a,b);this.sActivityParent=a.sActivityParent;this.cropImages(DOM.scry(this.ndContentContainer,".fbImageContainer img"),RecommendationsWidget.IMAGE_HEIGHT,true);this.cropImages(DOM.scry(this.ndContentContainer,"img.fbGalleryImage"),RecommendationsWidget.GALLERY_IMAGE_HEIGHT,false);},cropImages:function(a,d,b){if(a.length>0){var c=function(event){RecommendationsWidget.image_resize({image:event.getTarget(),dimension:d,centerimage:b});};a.forEach(function(e){if(e.complete){RecommendationsWidget.image_resize({image:e,dimension:d,centerimage:b});}else Event.listen(e,'load',c);});}},hasContent:function(){return this.ndContentContainer.childNodes.length>0;},getParent:function(){if(this.sActivityParent)return ConnectSocialWidget.getInstance(this.sActivityParent);},showRecommendationsSeparator:function(){var b=this.getParent();if(b&&b.hasContent()){var a=DOM.scry(this.ndTop,'div.fbRecommendationsSeparator')[0];CSS.show(a);CSS.setStyle(a,'visibility','visible');}return this;},removeOverflowElements:function(){ConnectSocialWidget.prototype.removeOverflowElements.apply(this,arguments);if(this.sActivityParent&&!this.hasContent()){var a=DOM.scry(this.ndTop,'div.fbRecommendationsSeparator')[0];CSS.hide(a);}}});RecommendationsWidget.IMAGE_HEIGHT=35;RecommendationsWidget.GALLERY_IMAGE_HEIGHT=105;function LikeBoxWidget(a,b){this.parent.construct(this,a,b);}Class.extend(LikeBoxWidget,'ConnectSocialWidget');copy_properties(LikeBoxWidget.prototype,{getLinkType:function(){return ConnectSocialWdiget.TYPE_LIKEBOX;},getPluginType:function(){return ConnectSocialWidget.TYPE_LIKEBOX;}});RecommendationsWidget.image_resize=function(l){var j=l.image,k=Vector2.getElementDimensions(j),c=k.y,i=k.x,g=l.dimension,m=g+'px',a=l.centerimage;if(c<=5||i<=5)return;var f=c/i;if(f<.5||f>2)return;if(c===i){CSS.setStyle(j,'width',m);}else if(c<i){var e=g/c,d=-Math.round((i-c)*e/2);CSS.setStyle(j,'height',m);a&&CSS.setStyle(j,'marginLeft',d+'px');}else{var e=g/i,h=-Math.round((c-i)*e/2);CSS.setStyle(j,'width',m);a&&CSS.setStyle(j,'marginTop',h+'px');}CSS.setStyle(j,'visibility','visible');CSS.setStyle(j.parentNode,'background','transparent');var b=Parent.byClass(j,'fbRecommendation');if(b)CSS.removeClass(b,'invisible_elem');};ClickThroughMonitor=function(a){copy_properties(this,{ndTop:a.ndTop||document.body,fValidateLink:a.fValidateLink||function(){return true;},fGetMonitorData:a.fGetMonitorData||function(){return {};}});Event.listen(this.ndTop,'mousedown',this.onMouseDown.bind(this));};ClickThroughMonitor.CALL_BACK_SOCIAL_PLUGINS=2;copy_properties(ClickThroughMonitor.prototype,{getMonitoredLink:function(event){var a=event.getTarget(),b=Parent.byTag(a,'a');if(b&&CSS.hasClass(b,'fbMonitor')&&this.fValidateLink(b)){return b;}else return null;},getMonitorData:function(a){var b=this.fGetMonitorData(a);if(document.referrer!=='')b.referrer=document.referrer;b.cb=ClickThroughMonitor.CALL_BACK_SOCIAL_PLUGINS;return b;},onMouseDown:function(event){var a=this.getMonitoredLink(event);if(a)UntrustedLink.bootstrap(a,Env.lhsh,event,this.getMonitorData.bind(this));}});
InitialJSLoader={INITIAL_JS_READY:'BOOTLOAD/JSREADY',load:function(a){InitialJSLoader.callback=Bootloader.loadResources(a,InitialJSLoader.callback);},callback:Arbiter.registerCallback(function(){Arbiter.inform(InitialJSLoader.INITIAL_JS_READY,true,Arbiter.BEHAVIOR_STATE);},[OnloadEvent.ONLOAD_DOMCONTENT_CALLBACK])};
window.onloadRegister=function(a){window.loaded?_runHook(a):_addHook('onloadhooks',a);};function onafterloadRegister(a){window.afterloaded?setTimeout(function(){_runHook(a);},0):_addHook('onafterloadhooks',a);}function _onloadHook(){!window.loaded&&window.CavalryLogger&&CavalryLogger.getInstance().setTimeStamp('t_prehooks');_runHooks('onloadhooks');!window.loaded&&window.CavalryLogger&&CavalryLogger.getInstance().setTimeStamp('t_hooks');window.loaded=true;Arbiter.inform('uipage_onload',true,Arbiter.BEHAVIOR_STATE);}function _onafterloadHook(){_runHooks('onafterloadhooks');window.afterloaded=true;}function _runHook(b){try{return b();}catch(a){}}function _runHooks(b){var d=b=='onbeforeleavehooks'||b=='onbeforeunloadhooks';var e=null;do{var a=window[b];if(!d)window[b]=null;if(!a)break;for(var c=0;c<a.length;c++)if(d){e=e||_runHook(a[c]);}else _runHook(a[c]);if(d)break;}while(window[b]);if(d&&e)return e;}function keep_window_set_as_loaded(){if(window.loaded==false){window.loaded=true;_runHooks('onloadhooks');}if(window.afterloaded==false){window.afterloaded=true;_runHooks('onafterloadhooks');}}Arbiter.registerCallback(_onloadHook,[OnloadEvent.ONLOAD_DOMCONTENT_CALLBACK,InitialJSLoader.INITIAL_JS_READY]);Arbiter.registerCallback(_onafterloadHook,[OnloadEvent.ONLOAD_DOMCONTENT_CALLBACK,OnloadEvent.ONLOAD_CALLBACK,InitialJSLoader.INITIAL_JS_READY]);Arbiter.subscribe(OnloadEvent.ONBEFOREUNLOAD,function(b,a){a.warn=_runHooks('onbeforeleavehooks')||_runHooks('onbeforeunloadhooks');if(!a.warn){window.loaded=false;window.afterloaded=false;}},Arbiter.SUBSCRIBE_NEW);Arbiter.subscribe(OnloadEvent.ONUNLOAD,function(b,a){_runHooks('onunloadhooks');},Arbiter.SUBSCRIBE_NEW);
void(0);